{"version":3,"sources":["../src/index.tsx","../src/components/Button.tsx","../src/components/Card.tsx","../src/components/Input.tsx","../src/components/Badge.tsx","../src/wallet-sdk/utils/SignerFactory.ts","../src/wallet-sdk/core/WalletManager.ts","../src/wallet-sdk/wagmi.ts","../../../node_modules/@tanstack/query-core/src/subscribable.ts","../../../node_modules/@tanstack/query-core/src/timeoutManager.ts","../../../node_modules/@tanstack/query-core/src/utils.ts","../../../node_modules/@tanstack/query-core/src/focusManager.ts","../../../node_modules/@tanstack/query-core/src/thenable.ts","../../../node_modules/@tanstack/query-core/src/notifyManager.ts","../../../node_modules/@tanstack/query-core/src/onlineManager.ts","../../../node_modules/@tanstack/query-core/src/retryer.ts","../../../node_modules/@tanstack/query-core/src/removable.ts","../../../node_modules/@tanstack/query-core/src/query.ts","../../../node_modules/@tanstack/query-core/src/infiniteQueryBehavior.ts","../../../node_modules/@tanstack/query-core/src/mutation.ts","../../../node_modules/@tanstack/query-core/src/mutationCache.ts","../../../node_modules/@tanstack/query-core/src/queryCache.ts","../../../node_modules/@tanstack/query-core/src/queryClient.ts","../src/wallet-sdk/core/WalletSDK.ts","../src/wallet-sdk/components/WalletProvider.tsx","../src/wallet-sdk/utils/WalletDeduplicator.ts","../src/wallet-sdk/components/WalletModal.tsx","../src/wallet-sdk/components/ConnectButton.tsx","../src/wallet-sdk/components/AccountDropdown.tsx","../src/wallet-sdk/components/EnhancedConnectButton.tsx","../src/wallet-sdk/index.ts"],"sourcesContent":["// 导出所有组件\nexport * from './components/Button';\nexport * from './components/Card';\nexport * from './components/Input';\nexport * from './components/Badge';\n\n// 导出钱包 SDK\nexport * from './wallet-sdk';","import React from 'react';\n\nexport interface ButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {\n  /**\n   * 按钮变体\n   */\n  variant?: 'primary' | 'secondary' | 'outline' | 'ghost';\n  /**\n   * 按钮大小\n   */\n  size?: 'sm' | 'md' | 'lg';\n  /**\n   * 是否为全宽按钮\n   */\n  fullWidth?: boolean;\n  /**\n   * 是否禁用\n   */\n  disabled?: boolean;\n  /**\n   * 加载状态\n   */\n  loading?: boolean;\n}\n\nexport const Button: React.FC<ButtonProps> = ({\n  children,\n  className = '',\n  variant = 'primary',\n  size = 'md',\n  fullWidth = false,\n  disabled = false,\n  loading = false,\n  ...props\n}) => {\n  // Tailwind 类名映射\n  const variantClasses = {\n    primary: 'bg-primary-600 text-white hover:bg-primary-700 focus:ring-primary-500',\n    secondary: 'bg-secondary-200 text-secondary-900 hover:bg-secondary-300 focus:ring-secondary-300',\n    outline: 'bg-transparent border border-primary-600 text-primary-600 hover:bg-primary-50 focus:ring-primary-500',\n    ghost: 'bg-transparent text-primary-600 hover:bg-primary-50 focus:ring-primary-500',\n  };\n\n  const sizeClasses = {\n    sm: 'py-1 px-3 text-sm',\n    md: 'py-2 px-4 text-base',\n    lg: 'py-3 px-6 text-lg',\n  };\n\n  const baseClasses = 'font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors';\n  const widthClass = fullWidth ? 'w-full' : '';\n  const disabledClass = disabled ? 'opacity-50 cursor-not-allowed' : '';\n  \n  return (\n    <button\n      className={`${baseClasses} ${variantClasses[variant]} ${sizeClasses[size]} ${widthClass} ${disabledClass} ${className}`}\n      disabled={disabled || loading}\n      {...props}\n    >\n      {loading ? (\n        <div className=\"flex items-center justify-center\">\n          <svg className=\"animate-spin -ml-1 mr-2 h-4 w-4 text-current\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n            <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n            <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n          </svg>\n          {children}\n        </div>\n      ) : (\n        children\n      )}\n    </button>\n  );\n};","import React from 'react';\n\nexport interface CardProps {\n  /**\n   * 卡片标题\n   */\n  title?: string;\n  /**\n   * 卡片内容\n   */\n  children: React.ReactNode;\n  /**\n   * 卡片底部内容\n   */\n  footer?: React.ReactNode;\n  /**\n   * 是否有阴影\n   */\n  shadow?: 'none' | 'sm' | 'md' | 'lg';\n  /**\n   * 自定义类名\n   */\n  className?: string;\n}\n\nexport const Card: React.FC<CardProps> = ({\n  title,\n  children,\n  footer,\n  shadow = 'md',\n  className = '',\n}) => {\n  const shadowClasses = {\n    none: '',\n    sm: 'shadow-sm',\n    md: 'shadow',\n    lg: 'shadow-lg',\n  };\n\n  return (\n    <div className={`bg-white rounded-lg border border-secondary-200 overflow-hidden ${shadowClasses[shadow]} ${className}`}>\n      {title && (\n        <div className=\"px-6 py-4 border-b border-secondary-200\">\n          <h3 className=\"text-lg font-medium text-secondary-900\">{title}</h3>\n        </div>\n      )}\n      <div className=\"px-6 py-4\">{children}</div>\n      {footer && (\n        <div className=\"px-6 py-4 bg-secondary-50 border-t border-secondary-200\">\n          {footer}\n        </div>\n      )}\n    </div>\n  );\n};","import React from \"react\";\n\nexport interface InputProps\n  extends Omit<\n    React.InputHTMLAttributes<HTMLInputElement>,\n    \"size\" | \"prefix\" | \"suffix\"\n  > {\n  /**\n   * 输入框标签\n   */\n  label?: string;\n  /**\n   * 帮助文本\n   */\n  helpText?: string;\n  /**\n   * 错误信息\n   */\n  error?: string;\n  /**\n   * 输入框大小\n   */\n  size?: \"sm\" | \"md\" | \"lg\";\n  /**\n   * 前缀图标或元素\n   */\n  prefix?: React.ReactNode;\n  /**\n   * 后缀图标或元素\n   */\n  suffix?: React.ReactNode;\n  /**\n   * 是否为全宽\n   */\n  fullWidth?: boolean;\n}\n\nexport const Input: React.FC<InputProps> = ({\n  label,\n  helpText,\n  error,\n  size = \"md\",\n  prefix,\n  suffix,\n  fullWidth = false,\n  className = \"\",\n  id,\n  ...props\n}) => {\n  // 生成唯一ID\n  const inputId = id || `input-${Math.random().toString(36).substr(2, 9)}`;\n\n  const sizeClasses = {\n    sm: \"py-1 px-3 text-sm\",\n    md: \"py-2 px-4 text-base\",\n    lg: \"py-3 px-5 text-lg\",\n  };\n\n  const baseClasses =\n    \"block border rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors\";\n  const widthClass = fullWidth ? \"w-full\" : \"\";\n  const stateClasses = error\n    ? \"border-red-500 text-red-900 placeholder-red-300 focus:ring-red-500 focus:border-red-500\"\n    : \"border-secondary-300 text-secondary-900 placeholder-secondary-400\";\n\n  return (\n    <div className={`${widthClass}`}>\n      {label && (\n        <label\n          htmlFor={inputId}\n          className=\"block text-sm font-medium text-secondary-700 mb-1\"\n        >\n          {label}\n        </label>\n      )}\n      <div className=\"relative\">\n        {prefix && (\n          <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n            {prefix}\n          </div>\n        )}\n        <input\n          id={inputId}\n          className={`\n            ${baseClasses}\n            ${sizeClasses[size]}\n            ${stateClasses}\n            ${prefix ? \"pl-10\" : \"\"}\n            ${suffix ? \"pr-10\" : \"\"}\n            ${widthClass}\n            ${className}\n          `}\n          {...props}\n        />\n        {suffix && (\n          <div className=\"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none\">\n            {suffix}\n          </div>\n        )}\n      </div>\n      {helpText && !error && (\n        <p className=\"mt-1 text-sm text-secondary-500\">{helpText}</p>\n      )}\n      {error && <p className=\"mt-1 text-sm text-red-600\">{error}</p>}\n    </div>\n  );\n};\n","import React from 'react';\n\nexport interface BadgeProps {\n  /**\n   * 徽章内容\n   */\n  children: React.ReactNode;\n  /**\n   * 徽章变体\n   */\n  variant?: 'primary' | 'secondary' | 'success' | 'danger' | 'warning' | 'info';\n  /**\n   * 徽章大小\n   */\n  size?: 'sm' | 'md' | 'lg';\n  /**\n   * 是否为圆形徽章\n   */\n  rounded?: boolean;\n  /**\n   * 自定义类名\n   */\n  className?: string;\n}\n\nexport const Badge: React.FC<BadgeProps> = ({\n  children,\n  variant = 'primary',\n  size = 'md',\n  rounded = false,\n  className = '',\n}) => {\n  // Tailwind 类名映射\n  const variantClasses = {\n    primary: 'bg-primary-100 text-primary-800',\n    secondary: 'bg-secondary-100 text-secondary-800',\n    success: 'bg-green-100 text-green-800',\n    danger: 'bg-red-100 text-red-800',\n    warning: 'bg-yellow-100 text-yellow-800',\n    info: 'bg-blue-100 text-blue-800',\n  };\n\n  const sizeClasses = {\n    sm: 'text-xs px-2 py-0.5',\n    md: 'text-sm px-2.5 py-0.5',\n    lg: 'text-base px-3 py-1',\n  };\n\n  const roundedClass = rounded ? 'rounded-full' : 'rounded';\n\n  return (\n    <span\n      className={`inline-flex items-center font-medium ${variantClasses[variant]} ${sizeClasses[size]} ${roundedClass} ${className}`}\n    >\n      {children}\n    </span>\n  );\n};","import { EthereumProvider, WalletSigner } from '../types';\n\nexport class SignerFactory {\n  /**\n   * 从 Provider 创建 Signer\n   * @param provider 以太坊提供者\n   * @param address 钱包地址\n   * @returns WalletSigner 实例\n   */\n  static createFromProvider(provider: EthereumProvider, address: string): WalletSigner {\n    return {\n      provider,\n      getAddress: () => address,\n      signMessage: async (message: string) => {\n        try {\n          return await provider.request({\n            method: \"personal_sign\",\n            params: [message, address],\n          }) as Promise<string>;\n        } catch (error) {\n          console.error(\"签名消息失败:\", error);\n          throw new Error(\"签名消息失败\");\n        }\n      },\n      signTransaction: async (transaction: unknown) => {\n        try {\n          return await provider.request({\n            method: \"eth_signTransaction\",\n            params: [transaction],\n          }) as Promise<string>;\n        } catch (error) {\n          console.error(\"签名交易失败:\", error);\n          throw new Error(\"签名交易失败\");\n        }\n      },\n      sendTransaction: async (transaction: unknown) => {\n        try {\n          return await provider.request({\n            method: \"eth_sendTransaction\",\n            params: [transaction],\n          });\n        } catch (error) {\n          console.error(\"发送交易失败:\", error);\n          throw new Error(\"发送交易失败\");\n        }\n      },\n      getNonce: async (blockTag?: string) => {\n        try {\n          const result = await provider.request({\n            method: \"eth_getTransactionCount\",\n            params: [address, blockTag || \"latest\"],\n          }) as string;\n          return parseInt(result, 16);\n        } catch (error) {\n          console.error(\"获取 nonce 失败:\", error);\n          throw new Error(\"获取 nonce 失败\");\n        }\n      },\n      connect: (newProvider: EthereumProvider) => {\n        return SignerFactory.createFromProvider(newProvider, address);\n      },\n    };\n  }\n\n  /**\n   * 安全转换 Signer\n   * @param signer 未知类型的 signer\n   * @returns 安全的 WalletSigner 或 undefined\n   */\n  static ensureSafe(signer: unknown): WalletSigner | undefined {\n    if (!signer || typeof signer !== \"object\") {\n      return undefined;\n    }\n\n    const signerObj = signer as Record<string, unknown>;\n\n    if (\n      typeof signerObj.getAddress === \"function\" &&\n      typeof signerObj.signMessage === \"function\"\n    ) {\n      return {\n        provider: signerObj.provider as EthereumProvider,\n        getAddress: signerObj.getAddress(),\n        signMessage: signerObj.signMessage as (message: string) => Promise<string>,\n        connect:\n          typeof signerObj.connect === \"function\"\n            ? (signerObj.connect as (provider: EthereumProvider) => WalletSigner)\n            : undefined,\n        getNonce:\n          typeof signerObj.getNonce === \"function\"\n            ? (signerObj.getNonce as (blockTag?: string) => Promise<number>)\n            : undefined,\n        signTransaction:\n          typeof signerObj.signTransaction === \"function\"\n            ? (signerObj.signTransaction as (transaction: unknown) => Promise<string>)\n            : undefined,\n        sendTransaction:\n          typeof signerObj.sendTransaction === \"function\"\n            ? (signerObj.sendTransaction as (transaction: unknown) => Promise<unknown>)\n            : undefined,\n      };\n    }\n\n    return undefined;\n  }\n}","import { DetectedWallet, EthereumProvider, ExtendedWalletInfo, WalletConnectionResult, WalletConnector, WalletConnectResult } from '../types';\nimport { SignerFactory } from '../utils/SignerFactory';\nimport { Address } from 'viem';\n\ninterface EIP6963ProviderInfo {\n  uuid: string;\n  name: string;\n  icon: string;\n  rdns: string;\n}\n\ninterface EIP6963ProviderDetail {\n  info: EIP6963ProviderInfo;\n  provider: EthereumProvider;\n}\n\ninterface EIP6963AnnounceEvent extends Event {\n  detail: EIP6963ProviderDetail;\n}\n\ninterface WalletProvider extends EthereumProvider {\n  isMetaMask?: boolean;\n  isOkxWallet?: boolean;\n  isCoinbaseWallet?: boolean;\n  isRabby?: boolean;\n  isTrust?: boolean;\n}\n\ninterface DisconnectableProvider extends EthereumProvider {\n  disconnect?: () => Promise<void>;\n}\n\ndeclare global {\n  interface Window {\n    okxwallet?: EthereumProvider;\n    rabby?: EthereumProvider;\n    trustWallet?: EthereumProvider;\n  }\n}\n\ninterface WindowEthereum {\n  ethereum?: unknown;\n  okxwallet?: EthereumProvider;\n  rabby?: EthereumProvider;\n  trustWallet?: EthereumProvider;\n  coinbaseWalletExtension?: unknown;\n}\n\nexport class WalletManager {\n  private wallets = new Map<string, DetectedWallet>();\n  private initialized = false;\n\n  constructor() {\n    // 不在构造函数中自动初始化，等待手动调用\n  }\n\n  public initialize(): DetectedWallet[] {\n    if (this.initialized) {\n      return this.getWallets();\n    }\n\n    this.detectWallets();\n    this.initialized = true;\n    return this.getWallets();\n  }\n\n  public isInitialized(): boolean {\n    return this.initialized;\n  }\n\n  public async connectWallet(walletId: string): Promise<WalletConnectionResult> {\n    const wallet = this.getWalletById(walletId);\n    if (!wallet) {\n      throw new Error(`钱包 ${walletId} 未找到或未安装`);\n    }\n\n    if (!wallet.createConnector) {\n      throw new Error(`钱包 ${wallet.name} 缺少连接器`);\n    }\n\n    try {\n      const connector = wallet.createConnector();\n      const result = await connector.connect();\n\n      if (!result.accounts || result.accounts.length === 0) {\n        throw new Error(\"连接器未返回账户信息\");\n      }\n\n      const address = result.accounts[0];\n      const provider: EthereumProvider = connector.provider || wallet.provider;\n      const chainId = result.chainId || await this.getChainIdSafe(provider);\n\n      const connectionResult = {\n        success: true,\n        address: address as Address,\n        chainId,\n        wallet: {\n          id: wallet.id,\n          name: wallet.name,\n          installed: wallet.installed,\n        },\n        provider,\n        signer: SignerFactory.createFromProvider(provider, address),\n      };\n\n      \n      // 触发连接事件\n      this.emit('connect', {\n        address,\n        chainId,\n        walletId: wallet.id,\n        wallet: {\n          id: wallet.id,\n          name: wallet.name,\n          installed: wallet.installed,\n        },\n        provider,\n      });\n\n      return connectionResult;\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : '未知错误';\n      console.error(`❌ 连接钱包 ${wallet.name} 失败:`, error);\n      throw new Error(`连接钱包失败: ${errorMessage}`);\n    }\n  }\n\n  public async disconnectWallet(walletId: string): Promise<void> {\n    if (!walletId) {\n      return;\n    }\n\n    const wallet = this.getWalletById(walletId);\n    if (!wallet) {\n      return;\n    }\n\n    if (!wallet.createConnector) {\n      return;\n    }\n\n    try {\n      const connector = wallet.createConnector();\n      if (connector.disconnect) {\n        await connector.disconnect();\n      }\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : '未知错误';\n      console.error(`❌ 断开钱包 ${wallet.name} 失败:`, error);\n    }\n  }\n\n  public async disconnectAll(): Promise<void> {\n    const wallets = this.getWallets();\n    const disconnectPromises = wallets.map(wallet =>\n      this.disconnectWallet(wallet.id).catch(error => {\n        console.warn(`断开钱包 ${wallet.name} 时出错:`, error);\n      })\n    );\n\n    await Promise.allSettled(disconnectPromises);\n  }\n\n  private async getChainIdSafe(provider: EthereumProvider): Promise<number | undefined> {\n    try {\n      const chainIdHex = await provider.request({ method: \"eth_chainId\" });\n      if (typeof chainIdHex === 'string' && /^0x[0-9a-fA-F]+$/.test(chainIdHex)) {\n        return parseInt(chainIdHex, 16);\n      }\n    } catch (error) {\n      console.warn(\"获取链 ID 失败:\", error);\n    }\n    return undefined;\n  }\n\n  private detectWallets(): void {\n    if (typeof window === 'undefined') {\n      return;\n    }\n\n    this.detectEIP6963Wallets();\n    this.detectLegacyWallets();\n  }\n\n  private detectEIP6963Wallets(): void {\n    const announceEvent = 'eip6963:announceProvider';\n    const requestEvent = 'eip6963:requestProvider';\n\n    const handleAnnounce = (event: Event): void => {\n      const announceEvent = event as EIP6963AnnounceEvent;\n      const detail: EIP6963ProviderDetail = announceEvent.detail;\n      this.addWallet(detail);\n    };\n\n    window.addEventListener(announceEvent, handleAnnounce);\n    window.dispatchEvent(new Event(requestEvent));\n  }\n\n  private detectLegacyWallets(): void {\n    const windowEth = window as unknown as WindowEthereum;\n    const ethereum = this.getEthereumProvider(windowEth);\n\n    if (!ethereum) {\n      return;\n    }\n\n    const provider = ethereum as WalletProvider;\n\n    // MetaMask\n    if (provider.isMetaMask) {\n      this.addLegacyWallet('metamask', 'MetaMask', provider);\n    }\n\n    // OKX\n    if (provider.isOkxWallet || windowEth.okxwallet) {\n      const okxProvider = windowEth.okxwallet || provider;\n      this.addLegacyWallet('okx', 'OKX Wallet', okxProvider);\n    }\n\n    // Coinbase\n    if (provider.isCoinbaseWallet) {\n      this.addLegacyWallet('coinbase', 'Coinbase Wallet', provider);\n    } else {\n      const coinbaseProvider = this.getCoinbaseWalletExtension(windowEth);\n      if (coinbaseProvider) {\n        this.addLegacyWallet('coinbase', 'Coinbase Wallet', coinbaseProvider);\n      }\n    }\n\n    // Rabby\n    if (provider.isRabby || windowEth.rabby) {\n      const rabbyProvider = windowEth.rabby || provider;\n      this.addLegacyWallet('rabby', 'Rabby Wallet', rabbyProvider);\n    }\n\n    // Trust Wallet\n    if (provider.isTrust || windowEth.trustWallet) {\n      const trustProvider = windowEth.trustWallet || provider;\n      this.addLegacyWallet('trust', 'Trust Wallet', trustProvider);\n    }\n  }\n\n  private getEthereumProvider(windowEth: WindowEthereum): EthereumProvider | null {\n    try {\n      const ethereum = windowEth.ethereum;\n\n      if (\n        ethereum &&\n        typeof ethereum === 'object' &&\n        'request' in ethereum &&\n        typeof (ethereum as { request: unknown }).request === 'function'\n      ) {\n        return ethereum as EthereumProvider;\n      }\n    } catch (error) {\n      console.warn(\"获取 ethereum provider 失败:\", error);\n    }\n    return null;\n  }\n\n  private getCoinbaseWalletExtension(windowEth: WindowEthereum): EthereumProvider | null {\n    try {\n      const coinbaseExtension = windowEth.coinbaseWalletExtension;\n\n      if (\n        coinbaseExtension &&\n        typeof coinbaseExtension === 'object' &&\n        'request' in coinbaseExtension &&\n        typeof (coinbaseExtension as { request: unknown }).request === 'function'\n      ) {\n        return coinbaseExtension as EthereumProvider;\n      }\n    } catch (error) {\n      console.warn(\"获取 Coinbase Wallet Extension 失败:\", error);\n    }\n    return null;\n  }\n\n  private addWallet(detail: EIP6963ProviderDetail): void {\n    const wallet: DetectedWallet = {\n      id: this.normalizeWalletId(detail.info.rdns),\n      name: detail.info.name,\n      icon: detail.info.icon,\n      rdns: detail.info.rdns,\n      provider: detail.provider,\n      installed: true,\n      type: 'eip6963',\n      createConnector: () => this.createStandardConnector(detail.provider, detail.info.name)\n    };\n\n        this.wallets.set(wallet.id, wallet);\n  }\n\n  private addLegacyWallet(id: string, name: string, provider: EthereumProvider): void {\n    if (this.wallets.has(id)) {\n      return;\n    }\n\n    const wallet: DetectedWallet = {\n      id,\n      name,\n      icon: this.getDefaultIcon(id),\n      rdns: `legacy.${id}`,\n      provider,\n      installed: true,\n      type: 'legacy',\n      createConnector: () => this.createStandardConnector(provider, name)\n    };\n\n        this.wallets.set(wallet.id, wallet);\n  }\n\n  private createStandardConnector(provider: EthereumProvider, walletName: string): WalletConnector {\n    const connector: WalletConnector = {\n      id: '',\n      name: walletName,\n      provider,\n\n      connect: async (): Promise<WalletConnectResult> => {\n        try {\n          const accounts = await provider.request({\n            method: 'eth_requestAccounts'\n          });\n\n          const accountsArray = Array.isArray(accounts)\n            ? accounts.filter((acc): acc is string => typeof acc === 'string')\n            : typeof accounts === 'string'\n              ? [accounts]\n              : [];\n\n          if (accountsArray.length === 0) {\n            throw new Error('未获取到有效的账户地址');\n          }\n\n          const chainId = await this.getChainIdAsNumber(provider);\n\n          const result: WalletConnectResult = {\n            accounts: accountsArray,\n            chainId,\n            provider\n          };\n\n          return result;\n\n        } catch (error) {\n          const errorMessage = error instanceof Error ? error.message : '连接失败';\n          console.error(`❌ ${walletName} 连接失败:`, error);\n          throw new Error(`${walletName} 连接失败: ${errorMessage}`);\n        }\n      },\n\n      disconnect: async (): Promise<void> => {\n        try {\n          const disconnectableProvider = provider as DisconnectableProvider;\n          if (disconnectableProvider.disconnect && typeof disconnectableProvider.disconnect === 'function') {\n            await disconnectableProvider.disconnect();\n          }\n        } catch (error) {\n          console.warn(`⚠️ ${walletName} 断开连接时出错:`, error);\n        }\n      }\n    };\n\n    return connector;\n  }\n\n  private async getChainIdAsNumber(provider: EthereumProvider): Promise<number | undefined> {\n    try {\n      const chainIdHex = await provider.request({ method: \"eth_chainId\" });\n      if (typeof chainIdHex === 'string' && /^0x[0-9a-fA-F]+$/.test(chainIdHex)) {\n        return parseInt(chainIdHex, 16);\n      }\n      if (typeof chainIdHex === 'number') {\n        return chainIdHex;\n      }\n    } catch (error) {\n      console.warn(\"获取链 ID 失败:\", error);\n    }\n    return undefined;\n  }\n\n  private normalizeWalletId(rdns: string): string {\n    const idMap: Record<string, string> = {\n      'io.metamask': 'metamask',\n      'com.okex.wallet': 'okx',\n      'com.coinbase.wallet': 'coinbase',\n      'io.rabby': 'rabby',\n      'com.trustwallet.app': 'trust'\n    };\n\n    return idMap[rdns] || rdns.split('.').pop() || rdns;\n  }\n\n  private getDefaultIcon(id: string): string {\n    const iconMap: Record<string, string> = {\n      'metamask': 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSI+PC9zdmc+',\n      'okx': 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSI+PC9zdmc+',\n      'coinbase': 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSI+PC9zdmc+',\n      'rabby': 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSI+PC9zdmc+',\n      'trust': 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSI+PC9zdmc+'\n    };\n\n    return iconMap[id] || 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMiAzMiIgZmlsbD0ibm9uZSI+PC9zdmc+';\n  }\n\n  // 公共方法\n  public getWallets(): DetectedWallet[] {\n    if (!this.initialized) {\n      console.warn(\"⚠️ WalletManager 未初始化，返回空数组\");\n      return [];\n    }\n    return Array.from(this.wallets.values());\n  }\n\n  public getWalletById(id: string): DetectedWallet | null {\n    if (!this.initialized) {\n      console.warn(\"⚠️ WalletManager 未初始化\");\n      return null;\n    }\n    return this.wallets.get(id) || null;\n  }\n\n  public isWalletInstalled(id: string): boolean {\n    if (!this.initialized) {\n      console.warn(\"⚠️ WalletManager 未初始化\");\n      return false;\n    }\n    return this.wallets.has(id);\n  }\n\n  public getAvailableWallets(): ExtendedWalletInfo[] {\n    return this.getWallets().map(wallet => ({\n      id: wallet.id,\n      name: wallet.name,\n      installed: wallet.installed,\n      provider: wallet.provider,\n      iconUrl: wallet.icon || this.getDefaultIcon(wallet.id),\n      icon: wallet.icon,\n      rdns: wallet.rdns,\n      type: wallet.type,\n    }));\n  }\n\n  public getExtendedWalletById(id: string): ExtendedWalletInfo | null {\n    const wallet = this.getWalletById(id);\n    if (!wallet) return null;\n\n    return {\n      id: wallet.id,\n      name: wallet.name,\n      installed: wallet.installed,\n      provider: wallet.provider,\n      iconUrl: wallet.icon || this.getDefaultIcon(id),\n      icon: wallet.icon,\n      rdns: wallet.rdns,\n      type: wallet.type,\n    };\n  }\n\n  // 事件系统\n  private eventHandlers = new Map<string, ((data?: any) => void)[]>();\n\n  public on(event: string, handler: (data?: any) => void): void {\n    if (!this.eventHandlers.has(event)) {\n      this.eventHandlers.set(event, []);\n    }\n    this.eventHandlers.get(event)!.push(handler);\n  }\n\n  public off(event: string, handler: (data?: any) => void): void {\n    const handlers = this.eventHandlers.get(event);\n    if (handlers) {\n      const index = handlers.indexOf(handler);\n      if (index > -1) {\n        handlers.splice(index, 1);\n      }\n    }\n  }\n\n  private emit(event: string, data?: any): void {\n    const handlers = this.eventHandlers.get(event);\n    if (handlers) {\n      handlers.forEach(handler => {\n        try {\n          handler(data);\n        } catch (error) {\n          console.error(`事件处理器错误 [${event}]:`, error);\n        }\n      });\n    }\n  }\n}","import { connectorsForWallets } from '@rainbow-me/rainbowkit';\nimport {\n  metaMaskWallet,\n  trustWallet,\n  coinbaseWallet,\n  walletConnectWallet,\n  injectedWallet,\n  okxWallet,\n  safeWallet,\n  imTokenWallet\n} from '@rainbow-me/rainbowkit/wallets';\n\nimport { http, createConfig, createStorage } from 'wagmi';\nimport { QueryClient } from '@tanstack/react-query';\n\n// 默认支持的链 - 可以根据需要扩展\nexport const chains = [\n  { id: 1, name: 'Ethereum', rpcUrl: 'https://eth.public-rpc.com' },\n  { id: 11155111, name: 'Sepolia', rpcUrl: 'https://sepolia.infura.io/v3/9aa3d95b3bc440fa88ea12eaa4456161' },\n  { id: 137, name: 'Polygon', rpcUrl: 'https://polygon-rpc.com' },\n  { id: 10, name: 'Optimism', rpcUrl: 'https://mainnet.optimism.io' },\n  { id: 42161, name: 'Arbitrum', rpcUrl: 'https://arb1.arbitrum.io/rpc' },\n  { id: 8453, name: 'Base', rpcUrl: 'https://mainnet.base.org' }\n] as const;\n\n// 使用临时的项目ID，避免配置问题\nexport const projectId = '2e789d28c2f0380f39fc2a7bd198dee7';\n\n// 钱包列表配置 - 简化配置避免依赖问题\nexport const walletList = [\n  {\n    groupName: '推荐',\n    wallets: [\n      metaMaskWallet,\n      injectedWallet,\n    ],\n  },\n];\n\n// 钱包配置\nexport const walletConfig = {\n  appName: 'YC Directory UI',\n  projectId: projectId,\n};\n\n// 创建 RainbowKit 连接器\nexport const connectors = connectorsForWallets(\n  walletList,\n  walletConfig\n);\n\n// 创建 Wagmi 配置\nexport const config = createConfig({\n  chains,\n  transports: Object.fromEntries(\n    chains.map(chain => [chain.id, http()])\n  ),\n  connectors,\n  ssr: true,\n  // 持久化存储配置\n  storage: createStorage({\n    storage: typeof window !== 'undefined' ? window.localStorage : undefined,\n    key: 'ycdirectory-wagmi-store',\n  }),\n});\n\nexport const queryClient = new QueryClient();\n\nexport default config;","export class Subscribable<TListener extends Function> {\n  protected listeners = new Set<TListener>()\n\n  constructor() {\n    this.subscribe = this.subscribe.bind(this)\n  }\n\n  subscribe(listener: TListener): () => void {\n    this.listeners.add(listener)\n\n    this.onSubscribe()\n\n    return () => {\n      this.listeners.delete(listener)\n      this.onUnsubscribe()\n    }\n  }\n\n  hasListeners(): boolean {\n    return this.listeners.size > 0\n  }\n\n  protected onSubscribe(): void {\n    // Do nothing\n  }\n\n  protected onUnsubscribe(): void {\n    // Do nothing\n  }\n}\n","/**\n * {@link TimeoutManager} does not support passing arguments to the callback.\n *\n * `(_: void)` is the argument type inferred by TypeScript's default typings for\n * `setTimeout(cb, number)`.\n * If we don't accept a single void argument, then\n * `new Promise(resolve => timeoutManager.setTimeout(resolve, N))` is a type error.\n */\nexport type TimeoutCallback = (_: void) => void\n\n/**\n * Wrapping `setTimeout` is awkward from a typing perspective because platform\n * typings may extend the return type of `setTimeout`. For example, NodeJS\n * typings add `NodeJS.Timeout`; but a non-default `timeoutManager` may not be\n * able to return such a type.\n */\nexport type ManagedTimerId = number | { [Symbol.toPrimitive]: () => number }\n\n/**\n * Backend for timer functions.\n */\nexport type TimeoutProvider<TTimerId extends ManagedTimerId = ManagedTimerId> =\n  {\n    readonly setTimeout: (callback: TimeoutCallback, delay: number) => TTimerId\n    readonly clearTimeout: (timeoutId: TTimerId | undefined) => void\n\n    readonly setInterval: (callback: TimeoutCallback, delay: number) => TTimerId\n    readonly clearInterval: (intervalId: TTimerId | undefined) => void\n  }\n\nexport const defaultTimeoutProvider: TimeoutProvider<\n  ReturnType<typeof setTimeout>\n> = {\n  // We need the wrapper function syntax below instead of direct references to\n  // global setTimeout etc.\n  //\n  // BAD: `setTimeout: setTimeout`\n  // GOOD: `setTimeout: (cb, delay) => setTimeout(cb, delay)`\n  //\n  // If we use direct references here, then anything that wants to spy on or\n  // replace the global setTimeout (like tests) won't work since we'll already\n  // have a hard reference to the original implementation at the time when this\n  // file was imported.\n  setTimeout: (callback, delay) => setTimeout(callback, delay),\n  clearTimeout: (timeoutId) => clearTimeout(timeoutId),\n\n  setInterval: (callback, delay) => setInterval(callback, delay),\n  clearInterval: (intervalId) => clearInterval(intervalId),\n}\n\n/**\n * Allows customization of how timeouts are created.\n *\n * @tanstack/query-core makes liberal use of timeouts to implement `staleTime`\n * and `gcTime`. The default TimeoutManager provider uses the platform's global\n * `setTimeout` implementation, which is known to have scalability issues with\n * thousands of timeouts on the event loop.\n *\n * If you hit this limitation, consider providing a custom TimeoutProvider that\n * coalesces timeouts.\n */\nexport class TimeoutManager implements Omit<TimeoutProvider, 'name'> {\n  // We cannot have TimeoutManager<T> as we must instantiate it with a concrete\n  // type at app boot; and if we leave that type, then any new timer provider\n  // would need to support ReturnType<typeof setTimeout>, which is infeasible.\n  //\n  // We settle for type safety for the TimeoutProvider type, and accept that\n  // this class is unsafe internally to allow for extension.\n  #provider: TimeoutProvider<any> = defaultTimeoutProvider\n  #providerCalled = false\n\n  setTimeoutProvider<TTimerId extends ManagedTimerId>(\n    provider: TimeoutProvider<TTimerId>,\n  ): void {\n    if (process.env.NODE_ENV !== 'production') {\n      if (this.#providerCalled && provider !== this.#provider) {\n        // After changing providers, `clearTimeout` will not work as expected for\n        // timeouts from the previous provider.\n        //\n        // Since they may allocate the same timeout ID, clearTimeout may cancel an\n        // arbitrary different timeout, or unexpected no-op.\n        //\n        // We could protect against this by mixing the timeout ID bits\n        // deterministically with some per-provider bits.\n        //\n        // We could internally queue `setTimeout` calls to `TimeoutManager` until\n        // some API call to set the initial provider.\n        console.error(\n          `[timeoutManager]: Switching provider after calls to previous provider might result in unexpected behavior.`,\n          { previous: this.#provider, provider },\n        )\n      }\n    }\n\n    this.#provider = provider\n    if (process.env.NODE_ENV !== 'production') {\n      this.#providerCalled = false\n    }\n  }\n\n  setTimeout(callback: TimeoutCallback, delay: number): ManagedTimerId {\n    if (process.env.NODE_ENV !== 'production') {\n      this.#providerCalled = true\n    }\n    return this.#provider.setTimeout(callback, delay)\n  }\n\n  clearTimeout(timeoutId: ManagedTimerId | undefined): void {\n    this.#provider.clearTimeout(timeoutId)\n  }\n\n  setInterval(callback: TimeoutCallback, delay: number): ManagedTimerId {\n    if (process.env.NODE_ENV !== 'production') {\n      this.#providerCalled = true\n    }\n    return this.#provider.setInterval(callback, delay)\n  }\n\n  clearInterval(intervalId: ManagedTimerId | undefined): void {\n    this.#provider.clearInterval(intervalId)\n  }\n}\n\nexport const timeoutManager = new TimeoutManager()\n\n/**\n * In many cases code wants to delay to the next event loop tick; this is not\n * mediated by {@link timeoutManager}.\n *\n * This function is provided to make auditing the `tanstack/query-core` for\n * incorrect use of system `setTimeout` easier.\n */\nexport function systemSetTimeoutZero(callback: TimeoutCallback): void {\n  setTimeout(callback, 0)\n}\n","import { timeoutManager } from './timeoutManager'\nimport type {\n  DefaultError,\n  Enabled,\n  FetchStatus,\n  MutationKey,\n  MutationStatus,\n  QueryFunction,\n  QueryKey,\n  QueryOptions,\n  StaleTime,\n  StaleTimeFunction,\n} from './types'\nimport type { Mutation } from './mutation'\nimport type { FetchOptions, Query } from './query'\n\n// TYPES\n\nexport interface QueryFilters<TQueryKey extends QueryKey = QueryKey> {\n  /**\n   * Filter to active queries, inactive queries or all queries\n   */\n  type?: QueryTypeFilter\n  /**\n   * Match query key exactly\n   */\n  exact?: boolean\n  /**\n   * Include queries matching this predicate function\n   */\n  predicate?: (query: Query) => boolean\n  /**\n   * Include queries matching this query key\n   */\n  queryKey?: TQueryKey\n  /**\n   * Include or exclude stale queries\n   */\n  stale?: boolean\n  /**\n   * Include queries matching their fetchStatus\n   */\n  fetchStatus?: FetchStatus\n}\n\nexport interface MutationFilters<\n  TData = unknown,\n  TError = DefaultError,\n  TVariables = unknown,\n  TOnMutateResult = unknown,\n> {\n  /**\n   * Match mutation key exactly\n   */\n  exact?: boolean\n  /**\n   * Include mutations matching this predicate function\n   */\n  predicate?: (\n    mutation: Mutation<TData, TError, TVariables, TOnMutateResult>,\n  ) => boolean\n  /**\n   * Include mutations matching this mutation key\n   */\n  mutationKey?: MutationKey\n  /**\n   * Filter by mutation status\n   */\n  status?: MutationStatus\n}\n\nexport type Updater<TInput, TOutput> = TOutput | ((input: TInput) => TOutput)\n\nexport type QueryTypeFilter = 'all' | 'active' | 'inactive'\n\n// UTILS\n\nexport const isServer = typeof window === 'undefined' || 'Deno' in globalThis\n\nexport function noop(): void\nexport function noop(): undefined\nexport function noop() {}\n\nexport function functionalUpdate<TInput, TOutput>(\n  updater: Updater<TInput, TOutput>,\n  input: TInput,\n): TOutput {\n  return typeof updater === 'function'\n    ? (updater as (_: TInput) => TOutput)(input)\n    : updater\n}\n\nexport function isValidTimeout(value: unknown): value is number {\n  return typeof value === 'number' && value >= 0 && value !== Infinity\n}\n\nexport function timeUntilStale(updatedAt: number, staleTime?: number): number {\n  return Math.max(updatedAt + (staleTime || 0) - Date.now(), 0)\n}\n\nexport function resolveStaleTime<\n  TQueryFnData = unknown,\n  TError = DefaultError,\n  TData = TQueryFnData,\n  TQueryKey extends QueryKey = QueryKey,\n>(\n  staleTime:\n    | undefined\n    | StaleTimeFunction<TQueryFnData, TError, TData, TQueryKey>,\n  query: Query<TQueryFnData, TError, TData, TQueryKey>,\n): StaleTime | undefined {\n  return typeof staleTime === 'function' ? staleTime(query) : staleTime\n}\n\nexport function resolveEnabled<\n  TQueryFnData = unknown,\n  TError = DefaultError,\n  TData = TQueryFnData,\n  TQueryKey extends QueryKey = QueryKey,\n>(\n  enabled: undefined | Enabled<TQueryFnData, TError, TData, TQueryKey>,\n  query: Query<TQueryFnData, TError, TData, TQueryKey>,\n): boolean | undefined {\n  return typeof enabled === 'function' ? enabled(query) : enabled\n}\n\nexport function matchQuery(\n  filters: QueryFilters,\n  query: Query<any, any, any, any>,\n): boolean {\n  const {\n    type = 'all',\n    exact,\n    fetchStatus,\n    predicate,\n    queryKey,\n    stale,\n  } = filters\n\n  if (queryKey) {\n    if (exact) {\n      if (query.queryHash !== hashQueryKeyByOptions(queryKey, query.options)) {\n        return false\n      }\n    } else if (!partialMatchKey(query.queryKey, queryKey)) {\n      return false\n    }\n  }\n\n  if (type !== 'all') {\n    const isActive = query.isActive()\n    if (type === 'active' && !isActive) {\n      return false\n    }\n    if (type === 'inactive' && isActive) {\n      return false\n    }\n  }\n\n  if (typeof stale === 'boolean' && query.isStale() !== stale) {\n    return false\n  }\n\n  if (fetchStatus && fetchStatus !== query.state.fetchStatus) {\n    return false\n  }\n\n  if (predicate && !predicate(query)) {\n    return false\n  }\n\n  return true\n}\n\nexport function matchMutation(\n  filters: MutationFilters,\n  mutation: Mutation<any, any>,\n): boolean {\n  const { exact, status, predicate, mutationKey } = filters\n  if (mutationKey) {\n    if (!mutation.options.mutationKey) {\n      return false\n    }\n    if (exact) {\n      if (hashKey(mutation.options.mutationKey) !== hashKey(mutationKey)) {\n        return false\n      }\n    } else if (!partialMatchKey(mutation.options.mutationKey, mutationKey)) {\n      return false\n    }\n  }\n\n  if (status && mutation.state.status !== status) {\n    return false\n  }\n\n  if (predicate && !predicate(mutation)) {\n    return false\n  }\n\n  return true\n}\n\nexport function hashQueryKeyByOptions<TQueryKey extends QueryKey = QueryKey>(\n  queryKey: TQueryKey,\n  options?: Pick<QueryOptions<any, any, any, any>, 'queryKeyHashFn'>,\n): string {\n  const hashFn = options?.queryKeyHashFn || hashKey\n  return hashFn(queryKey)\n}\n\n/**\n * Default query & mutation keys hash function.\n * Hashes the value into a stable hash.\n */\nexport function hashKey(queryKey: QueryKey | MutationKey): string {\n  return JSON.stringify(queryKey, (_, val) =>\n    isPlainObject(val)\n      ? Object.keys(val)\n          .sort()\n          .reduce((result, key) => {\n            result[key] = val[key]\n            return result\n          }, {} as any)\n      : val,\n  )\n}\n\n/**\n * Checks if key `b` partially matches with key `a`.\n */\nexport function partialMatchKey(a: QueryKey, b: QueryKey): boolean\nexport function partialMatchKey(a: any, b: any): boolean {\n  if (a === b) {\n    return true\n  }\n\n  if (typeof a !== typeof b) {\n    return false\n  }\n\n  if (a && b && typeof a === 'object' && typeof b === 'object') {\n    return Object.keys(b).every((key) => partialMatchKey(a[key], b[key]))\n  }\n\n  return false\n}\n\nconst hasOwn = Object.prototype.hasOwnProperty\n\n/**\n * This function returns `a` if `b` is deeply equal.\n * If not, it will replace any deeply equal children of `b` with those of `a`.\n * This can be used for structural sharing between JSON values for example.\n */\nexport function replaceEqualDeep<T>(a: unknown, b: T): T\nexport function replaceEqualDeep(a: any, b: any): any {\n  if (a === b) {\n    return a\n  }\n\n  const array = isPlainArray(a) && isPlainArray(b)\n\n  if (!array && !(isPlainObject(a) && isPlainObject(b))) return b\n\n  const aItems = array ? a : Object.keys(a)\n  const aSize = aItems.length\n  const bItems = array ? b : Object.keys(b)\n  const bSize = bItems.length\n  const copy: any = array ? new Array(bSize) : {}\n\n  let equalItems = 0\n\n  for (let i = 0; i < bSize; i++) {\n    const key: any = array ? i : bItems[i]\n    const aItem = a[key]\n    const bItem = b[key]\n\n    if (aItem === bItem) {\n      copy[key] = aItem\n      if (array ? i < aSize : hasOwn.call(a, key)) equalItems++\n      continue\n    }\n\n    if (\n      aItem === null ||\n      bItem === null ||\n      typeof aItem !== 'object' ||\n      typeof bItem !== 'object'\n    ) {\n      copy[key] = bItem\n      continue\n    }\n\n    const v = replaceEqualDeep(aItem, bItem)\n    copy[key] = v\n    if (v === aItem) equalItems++\n  }\n\n  return aSize === bSize && equalItems === aSize ? a : copy\n}\n\n/**\n * Shallow compare objects.\n */\nexport function shallowEqualObjects<T extends Record<string, any>>(\n  a: T,\n  b: T | undefined,\n): boolean {\n  if (!b || Object.keys(a).length !== Object.keys(b).length) {\n    return false\n  }\n\n  for (const key in a) {\n    if (a[key] !== b[key]) {\n      return false\n    }\n  }\n\n  return true\n}\n\nexport function isPlainArray(value: unknown): value is Array<unknown> {\n  return Array.isArray(value) && value.length === Object.keys(value).length\n}\n\n// Copied from: https://github.com/jonschlinkert/is-plain-object\nexport function isPlainObject(o: any): o is Record<PropertyKey, unknown> {\n  if (!hasObjectPrototype(o)) {\n    return false\n  }\n\n  // If has no constructor\n  const ctor = o.constructor\n  if (ctor === undefined) {\n    return true\n  }\n\n  // If has modified prototype\n  const prot = ctor.prototype\n  if (!hasObjectPrototype(prot)) {\n    return false\n  }\n\n  // If constructor does not have an Object-specific method\n  if (!prot.hasOwnProperty('isPrototypeOf')) {\n    return false\n  }\n\n  // Handles Objects created by Object.create(<arbitrary prototype>)\n  if (Object.getPrototypeOf(o) !== Object.prototype) {\n    return false\n  }\n\n  // Most likely a plain Object\n  return true\n}\n\nfunction hasObjectPrototype(o: any): boolean {\n  return Object.prototype.toString.call(o) === '[object Object]'\n}\n\nexport function sleep(timeout: number): Promise<void> {\n  return new Promise((resolve) => {\n    timeoutManager.setTimeout(resolve, timeout)\n  })\n}\n\nexport function replaceData<\n  TData,\n  TOptions extends QueryOptions<any, any, any, any>,\n>(prevData: TData | undefined, data: TData, options: TOptions): TData {\n  if (typeof options.structuralSharing === 'function') {\n    return options.structuralSharing(prevData, data) as TData\n  } else if (options.structuralSharing !== false) {\n    if (process.env.NODE_ENV !== 'production') {\n      try {\n        return replaceEqualDeep(prevData, data)\n      } catch (error) {\n        console.error(\n          `Structural sharing requires data to be JSON serializable. To fix this, turn off structuralSharing or return JSON-serializable data from your queryFn. [${options.queryHash}]: ${error}`,\n        )\n\n        // Prevent the replaceEqualDeep from being called again down below.\n        throw error\n      }\n    }\n    // Structurally share data between prev and new data if needed\n    return replaceEqualDeep(prevData, data)\n  }\n  return data\n}\n\nexport function keepPreviousData<T>(\n  previousData: T | undefined,\n): T | undefined {\n  return previousData\n}\n\nexport function addToEnd<T>(items: Array<T>, item: T, max = 0): Array<T> {\n  const newItems = [...items, item]\n  return max && newItems.length > max ? newItems.slice(1) : newItems\n}\n\nexport function addToStart<T>(items: Array<T>, item: T, max = 0): Array<T> {\n  const newItems = [item, ...items]\n  return max && newItems.length > max ? newItems.slice(0, -1) : newItems\n}\n\nexport const skipToken = Symbol()\nexport type SkipToken = typeof skipToken\n\nexport function ensureQueryFn<\n  TQueryFnData = unknown,\n  TQueryKey extends QueryKey = QueryKey,\n>(\n  options: {\n    queryFn?: QueryFunction<TQueryFnData, TQueryKey> | SkipToken\n    queryHash?: string\n  },\n  fetchOptions?: FetchOptions<TQueryFnData>,\n): QueryFunction<TQueryFnData, TQueryKey> {\n  if (process.env.NODE_ENV !== 'production') {\n    if (options.queryFn === skipToken) {\n      console.error(\n        `Attempted to invoke queryFn when set to skipToken. This is likely a configuration error. Query hash: '${options.queryHash}'`,\n      )\n    }\n  }\n\n  // if we attempt to retry a fetch that was triggered from an initialPromise\n  // when we don't have a queryFn yet, we can't retry, so we just return the already rejected initialPromise\n  // if an observer has already mounted, we will be able to retry with that queryFn\n  if (!options.queryFn && fetchOptions?.initialPromise) {\n    return () => fetchOptions.initialPromise!\n  }\n\n  if (!options.queryFn || options.queryFn === skipToken) {\n    return () =>\n      Promise.reject(new Error(`Missing queryFn: '${options.queryHash}'`))\n  }\n\n  return options.queryFn\n}\n\nexport function shouldThrowError<T extends (...args: Array<any>) => boolean>(\n  throwOnError: boolean | T | undefined,\n  params: Parameters<T>,\n): boolean {\n  // Allow throwOnError function to override throwing behavior on a per-error basis\n  if (typeof throwOnError === 'function') {\n    return throwOnError(...params)\n  }\n\n  return !!throwOnError\n}\n","import { Subscribable } from './subscribable'\nimport { isServer } from './utils'\n\ntype Listener = (focused: boolean) => void\n\ntype SetupFn = (\n  setFocused: (focused?: boolean) => void,\n) => (() => void) | undefined\n\nexport class FocusManager extends Subscribable<Listener> {\n  #focused?: boolean\n  #cleanup?: () => void\n\n  #setup: SetupFn\n\n  constructor() {\n    super()\n    this.#setup = (onFocus) => {\n      // addEventListener does not exist in React Native, but window does\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!isServer && window.addEventListener) {\n        const listener = () => onFocus()\n        // Listen to visibilitychange\n        window.addEventListener('visibilitychange', listener, false)\n\n        return () => {\n          // Be sure to unsubscribe if a new handler is set\n          window.removeEventListener('visibilitychange', listener)\n        }\n      }\n      return\n    }\n  }\n\n  protected onSubscribe(): void {\n    if (!this.#cleanup) {\n      this.setEventListener(this.#setup)\n    }\n  }\n\n  protected onUnsubscribe() {\n    if (!this.hasListeners()) {\n      this.#cleanup?.()\n      this.#cleanup = undefined\n    }\n  }\n\n  setEventListener(setup: SetupFn): void {\n    this.#setup = setup\n    this.#cleanup?.()\n    this.#cleanup = setup((focused) => {\n      if (typeof focused === 'boolean') {\n        this.setFocused(focused)\n      } else {\n        this.onFocus()\n      }\n    })\n  }\n\n  setFocused(focused?: boolean): void {\n    const changed = this.#focused !== focused\n    if (changed) {\n      this.#focused = focused\n      this.onFocus()\n    }\n  }\n\n  onFocus(): void {\n    const isFocused = this.isFocused()\n    this.listeners.forEach((listener) => {\n      listener(isFocused)\n    })\n  }\n\n  isFocused(): boolean {\n    if (typeof this.#focused === 'boolean') {\n      return this.#focused\n    }\n\n    // document global can be unavailable in react native\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n    return globalThis.document?.visibilityState !== 'hidden'\n  }\n}\n\nexport const focusManager = new FocusManager()\n","/**\n * Thenable types which matches React's types for promises\n *\n * React seemingly uses `.status`, `.value` and `.reason` properties on a promises to optimistically unwrap data from promises\n *\n * @see https://github.com/facebook/react/blob/main/packages/shared/ReactTypes.js#L112-L138\n * @see https://github.com/facebook/react/blob/4f604941569d2e8947ce1460a0b2997e835f37b9/packages/react-debug-tools/src/ReactDebugHooks.js#L224-L227\n */\n\nimport { noop } from './utils'\n\ninterface Fulfilled<T> {\n  status: 'fulfilled'\n  value: T\n}\ninterface Rejected {\n  status: 'rejected'\n  reason: unknown\n}\ninterface Pending<T> {\n  status: 'pending'\n\n  /**\n   * Resolve the promise with a value.\n   * Will remove the `resolve` and `reject` properties from the promise.\n   */\n  resolve: (value: T) => void\n  /**\n   * Reject the promise with a reason.\n   * Will remove the `resolve` and `reject` properties from the promise.\n   */\n  reject: (reason: unknown) => void\n}\n\nexport type FulfilledThenable<T> = Promise<T> & Fulfilled<T>\nexport type RejectedThenable<T> = Promise<T> & Rejected\nexport type PendingThenable<T> = Promise<T> & Pending<T>\n\nexport type Thenable<T> =\n  | FulfilledThenable<T>\n  | RejectedThenable<T>\n  | PendingThenable<T>\n\nexport function pendingThenable<T>(): PendingThenable<T> {\n  let resolve: Pending<T>['resolve']\n  let reject: Pending<T>['reject']\n  // this could use `Promise.withResolvers()` in the future\n  const thenable = new Promise((_resolve, _reject) => {\n    resolve = _resolve\n    reject = _reject\n  }) as PendingThenable<T>\n\n  thenable.status = 'pending'\n  thenable.catch(() => {\n    // prevent unhandled rejection errors\n  })\n\n  function finalize(data: Fulfilled<T> | Rejected) {\n    Object.assign(thenable, data)\n\n    // clear pending props props to avoid calling them twice\n    delete (thenable as Partial<PendingThenable<T>>).resolve\n    delete (thenable as Partial<PendingThenable<T>>).reject\n  }\n\n  thenable.resolve = (value) => {\n    finalize({\n      status: 'fulfilled',\n      value,\n    })\n\n    resolve(value)\n  }\n  thenable.reject = (reason) => {\n    finalize({\n      status: 'rejected',\n      reason,\n    })\n\n    reject(reason)\n  }\n\n  return thenable\n}\n\n/**\n * This function takes a Promise-like input and detects whether the data\n * is synchronously available or not.\n *\n * It does not inspect .status, .value or .reason properties of the promise,\n * as those are not always available, and the .status of React's promises\n * should not be considered part of the public API.\n */\nexport function tryResolveSync(promise: Promise<unknown> | Thenable<unknown>) {\n  let data: unknown\n\n  promise\n    .then((result) => {\n      data = result\n      return result\n    }, noop)\n    // .catch can be unavailable on certain kinds of thenable's\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n    ?.catch(noop)\n\n  if (data !== undefined) {\n    return { data }\n  }\n\n  return undefined\n}\n","// TYPES\n\nimport { systemSetTimeoutZero } from './timeoutManager'\n\ntype NotifyCallback = () => void\n\ntype NotifyFunction = (callback: () => void) => void\n\ntype BatchNotifyFunction = (callback: () => void) => void\n\ntype BatchCallsCallback<T extends Array<unknown>> = (...args: T) => void\n\ntype ScheduleFunction = (callback: () => void) => void\n\nexport const defaultScheduler: ScheduleFunction = systemSetTimeoutZero\n\nexport function createNotifyManager() {\n  let queue: Array<NotifyCallback> = []\n  let transactions = 0\n  let notifyFn: NotifyFunction = (callback) => {\n    callback()\n  }\n  let batchNotifyFn: BatchNotifyFunction = (callback: () => void) => {\n    callback()\n  }\n  let scheduleFn = defaultScheduler\n\n  const schedule = (callback: NotifyCallback): void => {\n    if (transactions) {\n      queue.push(callback)\n    } else {\n      scheduleFn(() => {\n        notifyFn(callback)\n      })\n    }\n  }\n  const flush = (): void => {\n    const originalQueue = queue\n    queue = []\n    if (originalQueue.length) {\n      scheduleFn(() => {\n        batchNotifyFn(() => {\n          originalQueue.forEach((callback) => {\n            notifyFn(callback)\n          })\n        })\n      })\n    }\n  }\n\n  return {\n    batch: <T>(callback: () => T): T => {\n      let result\n      transactions++\n      try {\n        result = callback()\n      } finally {\n        transactions--\n        if (!transactions) {\n          flush()\n        }\n      }\n      return result\n    },\n    /**\n     * All calls to the wrapped function will be batched.\n     */\n    batchCalls: <T extends Array<unknown>>(\n      callback: BatchCallsCallback<T>,\n    ): BatchCallsCallback<T> => {\n      return (...args) => {\n        schedule(() => {\n          callback(...args)\n        })\n      }\n    },\n    schedule,\n    /**\n     * Use this method to set a custom notify function.\n     * This can be used to for example wrap notifications with `React.act` while running tests.\n     */\n    setNotifyFunction: (fn: NotifyFunction) => {\n      notifyFn = fn\n    },\n    /**\n     * Use this method to set a custom function to batch notifications together into a single tick.\n     * By default React Query will use the batch function provided by ReactDOM or React Native.\n     */\n    setBatchNotifyFunction: (fn: BatchNotifyFunction) => {\n      batchNotifyFn = fn\n    },\n    setScheduler: (fn: ScheduleFunction) => {\n      scheduleFn = fn\n    },\n  } as const\n}\n\n// SINGLETON\nexport const notifyManager = createNotifyManager()\n","import { Subscribable } from './subscribable'\nimport { isServer } from './utils'\n\ntype Listener = (online: boolean) => void\ntype SetupFn = (setOnline: Listener) => (() => void) | undefined\n\nexport class OnlineManager extends Subscribable<Listener> {\n  #online = true\n  #cleanup?: () => void\n\n  #setup: SetupFn\n\n  constructor() {\n    super()\n    this.#setup = (onOnline) => {\n      // addEventListener does not exist in React Native, but window does\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (!isServer && window.addEventListener) {\n        const onlineListener = () => onOnline(true)\n        const offlineListener = () => onOnline(false)\n        // Listen to online\n        window.addEventListener('online', onlineListener, false)\n        window.addEventListener('offline', offlineListener, false)\n\n        return () => {\n          // Be sure to unsubscribe if a new handler is set\n          window.removeEventListener('online', onlineListener)\n          window.removeEventListener('offline', offlineListener)\n        }\n      }\n\n      return\n    }\n  }\n\n  protected onSubscribe(): void {\n    if (!this.#cleanup) {\n      this.setEventListener(this.#setup)\n    }\n  }\n\n  protected onUnsubscribe() {\n    if (!this.hasListeners()) {\n      this.#cleanup?.()\n      this.#cleanup = undefined\n    }\n  }\n\n  setEventListener(setup: SetupFn): void {\n    this.#setup = setup\n    this.#cleanup?.()\n    this.#cleanup = setup(this.setOnline.bind(this))\n  }\n\n  setOnline(online: boolean): void {\n    const changed = this.#online !== online\n\n    if (changed) {\n      this.#online = online\n      this.listeners.forEach((listener) => {\n        listener(online)\n      })\n    }\n  }\n\n  isOnline(): boolean {\n    return this.#online\n  }\n}\n\nexport const onlineManager = new OnlineManager()\n","import { focusManager } from './focusManager'\nimport { onlineManager } from './onlineManager'\nimport { pendingThenable } from './thenable'\nimport { isServer, sleep } from './utils'\nimport type { Thenable } from './thenable'\nimport type { CancelOptions, DefaultError, NetworkMode } from './types'\n\n// TYPES\n\ninterface RetryerConfig<TData = unknown, TError = DefaultError> {\n  fn: () => TData | Promise<TData>\n  initialPromise?: Promise<TData>\n  onCancel?: (error: TError) => void\n  onFail?: (failureCount: number, error: TError) => void\n  onPause?: () => void\n  onContinue?: () => void\n  retry?: RetryValue<TError>\n  retryDelay?: RetryDelayValue<TError>\n  networkMode: NetworkMode | undefined\n  canRun: () => boolean\n}\n\nexport interface Retryer<TData = unknown> {\n  promise: Promise<TData>\n  cancel: (cancelOptions?: CancelOptions) => void\n  continue: () => Promise<unknown>\n  cancelRetry: () => void\n  continueRetry: () => void\n  canStart: () => boolean\n  start: () => Promise<TData>\n  status: () => 'pending' | 'resolved' | 'rejected'\n}\n\nexport type RetryValue<TError> = boolean | number | ShouldRetryFunction<TError>\n\ntype ShouldRetryFunction<TError = DefaultError> = (\n  failureCount: number,\n  error: TError,\n) => boolean\n\nexport type RetryDelayValue<TError> = number | RetryDelayFunction<TError>\n\ntype RetryDelayFunction<TError = DefaultError> = (\n  failureCount: number,\n  error: TError,\n) => number\n\nfunction defaultRetryDelay(failureCount: number) {\n  return Math.min(1000 * 2 ** failureCount, 30000)\n}\n\nexport function canFetch(networkMode: NetworkMode | undefined): boolean {\n  return (networkMode ?? 'online') === 'online'\n    ? onlineManager.isOnline()\n    : true\n}\n\nexport class CancelledError extends Error {\n  revert?: boolean\n  silent?: boolean\n  constructor(options?: CancelOptions) {\n    super('CancelledError')\n    this.revert = options?.revert\n    this.silent = options?.silent\n  }\n}\n\n/**\n * @deprecated Use instanceof `CancelledError` instead.\n */\nexport function isCancelledError(value: any): value is CancelledError {\n  return value instanceof CancelledError\n}\n\nexport function createRetryer<TData = unknown, TError = DefaultError>(\n  config: RetryerConfig<TData, TError>,\n): Retryer<TData> {\n  let isRetryCancelled = false\n  let failureCount = 0\n  let continueFn: ((value?: unknown) => void) | undefined\n\n  const thenable = pendingThenable<TData>()\n\n  const isResolved = () =>\n    (thenable.status as Thenable<TData>['status']) !== 'pending'\n\n  const cancel = (cancelOptions?: CancelOptions): void => {\n    if (!isResolved()) {\n      const error = new CancelledError(cancelOptions) as TError\n      reject(error)\n\n      config.onCancel?.(error)\n    }\n  }\n  const cancelRetry = () => {\n    isRetryCancelled = true\n  }\n\n  const continueRetry = () => {\n    isRetryCancelled = false\n  }\n\n  const canContinue = () =>\n    focusManager.isFocused() &&\n    (config.networkMode === 'always' || onlineManager.isOnline()) &&\n    config.canRun()\n\n  const canStart = () => canFetch(config.networkMode) && config.canRun()\n\n  const resolve = (value: any) => {\n    if (!isResolved()) {\n      continueFn?.()\n      thenable.resolve(value)\n    }\n  }\n\n  const reject = (value: any) => {\n    if (!isResolved()) {\n      continueFn?.()\n      thenable.reject(value)\n    }\n  }\n\n  const pause = () => {\n    return new Promise((continueResolve) => {\n      continueFn = (value) => {\n        if (isResolved() || canContinue()) {\n          continueResolve(value)\n        }\n      }\n      config.onPause?.()\n    }).then(() => {\n      continueFn = undefined\n      if (!isResolved()) {\n        config.onContinue?.()\n      }\n    })\n  }\n\n  // Create loop function\n  const run = () => {\n    // Do nothing if already resolved\n    if (isResolved()) {\n      return\n    }\n\n    let promiseOrValue: any\n\n    // we can re-use config.initialPromise on the first call of run()\n    const initialPromise =\n      failureCount === 0 ? config.initialPromise : undefined\n\n    // Execute query\n    try {\n      promiseOrValue = initialPromise ?? config.fn()\n    } catch (error) {\n      promiseOrValue = Promise.reject(error)\n    }\n\n    Promise.resolve(promiseOrValue)\n      .then(resolve)\n      .catch((error) => {\n        // Stop if the fetch is already resolved\n        if (isResolved()) {\n          return\n        }\n\n        // Do we need to retry the request?\n        const retry = config.retry ?? (isServer ? 0 : 3)\n        const retryDelay = config.retryDelay ?? defaultRetryDelay\n        const delay =\n          typeof retryDelay === 'function'\n            ? retryDelay(failureCount, error)\n            : retryDelay\n        const shouldRetry =\n          retry === true ||\n          (typeof retry === 'number' && failureCount < retry) ||\n          (typeof retry === 'function' && retry(failureCount, error))\n\n        if (isRetryCancelled || !shouldRetry) {\n          // We are done if the query does not need to be retried\n          reject(error)\n          return\n        }\n\n        failureCount++\n\n        // Notify on fail\n        config.onFail?.(failureCount, error)\n\n        // Delay\n        sleep(delay)\n          // Pause if the document is not visible or when the device is offline\n          .then(() => {\n            return canContinue() ? undefined : pause()\n          })\n          .then(() => {\n            if (isRetryCancelled) {\n              reject(error)\n            } else {\n              run()\n            }\n          })\n      })\n  }\n\n  return {\n    promise: thenable,\n    status: () => thenable.status,\n    cancel,\n    continue: () => {\n      continueFn?.()\n      return thenable\n    },\n    cancelRetry,\n    continueRetry,\n    canStart,\n    start: () => {\n      // Start loop\n      if (canStart()) {\n        run()\n      } else {\n        pause().then(run)\n      }\n      return thenable\n    },\n  }\n}\n","import { timeoutManager } from './timeoutManager'\nimport { isServer, isValidTimeout } from './utils'\nimport type { ManagedTimerId } from './timeoutManager'\n\nexport abstract class Removable {\n  gcTime!: number\n  #gcTimeout?: ManagedTimerId\n\n  destroy(): void {\n    this.clearGcTimeout()\n  }\n\n  protected scheduleGc(): void {\n    this.clearGcTimeout()\n\n    if (isValidTimeout(this.gcTime)) {\n      this.#gcTimeout = timeoutManager.setTimeout(() => {\n        this.optionalRemove()\n      }, this.gcTime)\n    }\n  }\n\n  protected updateGcTime(newGcTime: number | undefined): void {\n    // Default to 5 minutes (Infinity for server-side) if no gcTime is set\n    this.gcTime = Math.max(\n      this.gcTime || 0,\n      newGcTime ?? (isServer ? Infinity : 5 * 60 * 1000),\n    )\n  }\n\n  protected clearGcTimeout() {\n    if (this.#gcTimeout) {\n      timeoutManager.clearTimeout(this.#gcTimeout)\n      this.#gcTimeout = undefined\n    }\n  }\n\n  protected abstract optionalRemove(): void\n}\n","import {\n  ensureQueryFn,\n  noop,\n  replaceData,\n  resolveEnabled,\n  resolveStaleTime,\n  skipToken,\n  timeUntilStale,\n} from './utils'\nimport { notifyManager } from './notifyManager'\nimport { CancelledError, canFetch, createRetryer } from './retryer'\nimport { Removable } from './removable'\nimport type { QueryCache } from './queryCache'\nimport type { QueryClient } from './queryClient'\nimport type {\n  CancelOptions,\n  DefaultError,\n  FetchStatus,\n  InitialDataFunction,\n  OmitKeyof,\n  QueryFunctionContext,\n  QueryKey,\n  QueryMeta,\n  QueryOptions,\n  QueryStatus,\n  SetDataOptions,\n  StaleTime,\n} from './types'\nimport type { QueryObserver } from './queryObserver'\nimport type { Retryer } from './retryer'\n\n// TYPES\n\ninterface QueryConfig<\n  TQueryFnData,\n  TError,\n  TData,\n  TQueryKey extends QueryKey = QueryKey,\n> {\n  client: QueryClient\n  queryKey: TQueryKey\n  queryHash: string\n  options?: QueryOptions<TQueryFnData, TError, TData, TQueryKey>\n  defaultOptions?: QueryOptions<TQueryFnData, TError, TData, TQueryKey>\n  state?: QueryState<TData, TError>\n}\n\nexport interface QueryState<TData = unknown, TError = DefaultError> {\n  data: TData | undefined\n  dataUpdateCount: number\n  dataUpdatedAt: number\n  error: TError | null\n  errorUpdateCount: number\n  errorUpdatedAt: number\n  fetchFailureCount: number\n  fetchFailureReason: TError | null\n  fetchMeta: FetchMeta | null\n  isInvalidated: boolean\n  status: QueryStatus\n  fetchStatus: FetchStatus\n}\n\nexport interface FetchContext<\n  TQueryFnData,\n  TError,\n  TData,\n  TQueryKey extends QueryKey = QueryKey,\n> {\n  fetchFn: () => unknown | Promise<unknown>\n  fetchOptions?: FetchOptions\n  signal: AbortSignal\n  options: QueryOptions<TQueryFnData, TError, TData, any>\n  client: QueryClient\n  queryKey: TQueryKey\n  state: QueryState<TData, TError>\n}\n\nexport interface QueryBehavior<\n  TQueryFnData = unknown,\n  TError = DefaultError,\n  TData = TQueryFnData,\n  TQueryKey extends QueryKey = QueryKey,\n> {\n  onFetch: (\n    context: FetchContext<TQueryFnData, TError, TData, TQueryKey>,\n    query: Query,\n  ) => void\n}\n\nexport type FetchDirection = 'forward' | 'backward'\n\nexport interface FetchMeta {\n  fetchMore?: { direction: FetchDirection }\n}\n\nexport interface FetchOptions<TData = unknown> {\n  cancelRefetch?: boolean\n  meta?: FetchMeta\n  initialPromise?: Promise<TData>\n}\n\ninterface FailedAction<TError> {\n  type: 'failed'\n  failureCount: number\n  error: TError\n}\n\ninterface FetchAction {\n  type: 'fetch'\n  meta?: FetchMeta\n}\n\ninterface SuccessAction<TData> {\n  data: TData | undefined\n  type: 'success'\n  dataUpdatedAt?: number\n  manual?: boolean\n}\n\ninterface ErrorAction<TError> {\n  type: 'error'\n  error: TError\n}\n\ninterface InvalidateAction {\n  type: 'invalidate'\n}\n\ninterface PauseAction {\n  type: 'pause'\n}\n\ninterface ContinueAction {\n  type: 'continue'\n}\n\ninterface SetStateAction<TData, TError> {\n  type: 'setState'\n  state: Partial<QueryState<TData, TError>>\n  setStateOptions?: SetStateOptions\n}\n\nexport type Action<TData, TError> =\n  | ContinueAction\n  | ErrorAction<TError>\n  | FailedAction<TError>\n  | FetchAction\n  | InvalidateAction\n  | PauseAction\n  | SetStateAction<TData, TError>\n  | SuccessAction<TData>\n\nexport interface SetStateOptions {\n  meta?: any\n}\n\n// CLASS\n\nexport class Query<\n  TQueryFnData = unknown,\n  TError = DefaultError,\n  TData = TQueryFnData,\n  TQueryKey extends QueryKey = QueryKey,\n> extends Removable {\n  queryKey: TQueryKey\n  queryHash: string\n  options!: QueryOptions<TQueryFnData, TError, TData, TQueryKey>\n  state: QueryState<TData, TError>\n\n  #initialState: QueryState<TData, TError>\n  #revertState?: QueryState<TData, TError>\n  #cache: QueryCache\n  #client: QueryClient\n  #retryer?: Retryer<TData>\n  observers: Array<QueryObserver<any, any, any, any, any>>\n  #defaultOptions?: QueryOptions<TQueryFnData, TError, TData, TQueryKey>\n  #abortSignalConsumed: boolean\n\n  constructor(config: QueryConfig<TQueryFnData, TError, TData, TQueryKey>) {\n    super()\n\n    this.#abortSignalConsumed = false\n    this.#defaultOptions = config.defaultOptions\n    this.setOptions(config.options)\n    this.observers = []\n    this.#client = config.client\n    this.#cache = this.#client.getQueryCache()\n    this.queryKey = config.queryKey\n    this.queryHash = config.queryHash\n    this.#initialState = getDefaultState(this.options)\n    this.state = config.state ?? this.#initialState\n    this.scheduleGc()\n  }\n  get meta(): QueryMeta | undefined {\n    return this.options.meta\n  }\n\n  get promise(): Promise<TData> | undefined {\n    return this.#retryer?.promise\n  }\n\n  setOptions(\n    options?: QueryOptions<TQueryFnData, TError, TData, TQueryKey>,\n  ): void {\n    this.options = { ...this.#defaultOptions, ...options }\n\n    this.updateGcTime(this.options.gcTime)\n\n    // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n    if (this.state && this.state.data === undefined) {\n      const defaultState = getDefaultState(this.options)\n      if (defaultState.data !== undefined) {\n        this.setData(defaultState.data, {\n          updatedAt: defaultState.dataUpdatedAt,\n          manual: true,\n        })\n        this.#initialState = defaultState\n      }\n    }\n  }\n\n  protected optionalRemove() {\n    if (!this.observers.length && this.state.fetchStatus === 'idle') {\n      this.#cache.remove(this)\n    }\n  }\n\n  setData(\n    newData: TData,\n    options?: SetDataOptions & { manual: boolean },\n  ): TData {\n    const data = replaceData(this.state.data, newData, this.options)\n\n    // Set data and mark it as cached\n    this.#dispatch({\n      data,\n      type: 'success',\n      dataUpdatedAt: options?.updatedAt,\n      manual: options?.manual,\n    })\n\n    return data\n  }\n\n  setState(\n    state: Partial<QueryState<TData, TError>>,\n    setStateOptions?: SetStateOptions,\n  ): void {\n    this.#dispatch({ type: 'setState', state, setStateOptions })\n  }\n\n  cancel(options?: CancelOptions): Promise<void> {\n    const promise = this.#retryer?.promise\n    this.#retryer?.cancel(options)\n    return promise ? promise.then(noop).catch(noop) : Promise.resolve()\n  }\n\n  destroy(): void {\n    super.destroy()\n\n    this.cancel({ silent: true })\n  }\n\n  reset(): void {\n    this.destroy()\n    this.setState(this.#initialState)\n  }\n\n  isActive(): boolean {\n    return this.observers.some(\n      (observer) => resolveEnabled(observer.options.enabled, this) !== false,\n    )\n  }\n\n  isDisabled(): boolean {\n    if (this.getObserversCount() > 0) {\n      return !this.isActive()\n    }\n    // if a query has no observers, it should still be considered disabled if it never attempted a fetch\n    return (\n      this.options.queryFn === skipToken ||\n      this.state.dataUpdateCount + this.state.errorUpdateCount === 0\n    )\n  }\n\n  isStatic(): boolean {\n    if (this.getObserversCount() > 0) {\n      return this.observers.some(\n        (observer) =>\n          resolveStaleTime(observer.options.staleTime, this) === 'static',\n      )\n    }\n\n    return false\n  }\n\n  isStale(): boolean {\n    // check observers first, their `isStale` has the source of truth\n    // calculated with `isStaleByTime` and it takes `enabled` into account\n    if (this.getObserversCount() > 0) {\n      return this.observers.some(\n        (observer) => observer.getCurrentResult().isStale,\n      )\n    }\n\n    return this.state.data === undefined || this.state.isInvalidated\n  }\n\n  isStaleByTime(staleTime: StaleTime = 0): boolean {\n    // no data is always stale\n    if (this.state.data === undefined) {\n      return true\n    }\n    // static is never stale\n    if (staleTime === 'static') {\n      return false\n    }\n    // if the query is invalidated, it is stale\n    if (this.state.isInvalidated) {\n      return true\n    }\n\n    return !timeUntilStale(this.state.dataUpdatedAt, staleTime)\n  }\n\n  onFocus(): void {\n    const observer = this.observers.find((x) => x.shouldFetchOnWindowFocus())\n\n    observer?.refetch({ cancelRefetch: false })\n\n    // Continue fetch if currently paused\n    this.#retryer?.continue()\n  }\n\n  onOnline(): void {\n    const observer = this.observers.find((x) => x.shouldFetchOnReconnect())\n\n    observer?.refetch({ cancelRefetch: false })\n\n    // Continue fetch if currently paused\n    this.#retryer?.continue()\n  }\n\n  addObserver(observer: QueryObserver<any, any, any, any, any>): void {\n    if (!this.observers.includes(observer)) {\n      this.observers.push(observer)\n\n      // Stop the query from being garbage collected\n      this.clearGcTimeout()\n\n      this.#cache.notify({ type: 'observerAdded', query: this, observer })\n    }\n  }\n\n  removeObserver(observer: QueryObserver<any, any, any, any, any>): void {\n    if (this.observers.includes(observer)) {\n      this.observers = this.observers.filter((x) => x !== observer)\n\n      if (!this.observers.length) {\n        // If the transport layer does not support cancellation\n        // we'll let the query continue so the result can be cached\n        if (this.#retryer) {\n          if (this.#abortSignalConsumed) {\n            this.#retryer.cancel({ revert: true })\n          } else {\n            this.#retryer.cancelRetry()\n          }\n        }\n\n        this.scheduleGc()\n      }\n\n      this.#cache.notify({ type: 'observerRemoved', query: this, observer })\n    }\n  }\n\n  getObserversCount(): number {\n    return this.observers.length\n  }\n\n  invalidate(): void {\n    if (!this.state.isInvalidated) {\n      this.#dispatch({ type: 'invalidate' })\n    }\n  }\n\n  async fetch(\n    options?: QueryOptions<TQueryFnData, TError, TData, TQueryKey>,\n    fetchOptions?: FetchOptions<TQueryFnData>,\n  ): Promise<TData> {\n    if (\n      this.state.fetchStatus !== 'idle' &&\n      // If the promise in the retyer is already rejected, we have to definitely\n      // re-start the fetch; there is a chance that the query is still in a\n      // pending state when that happens\n      this.#retryer?.status() !== 'rejected'\n    ) {\n      if (this.state.data !== undefined && fetchOptions?.cancelRefetch) {\n        // Silently cancel current fetch if the user wants to cancel refetch\n        this.cancel({ silent: true })\n      } else if (this.#retryer) {\n        // make sure that retries that were potentially cancelled due to unmounts can continue\n        this.#retryer.continueRetry()\n        // Return current promise if we are already fetching\n        return this.#retryer.promise\n      }\n    }\n\n    // Update config if passed, otherwise the config from the last execution is used\n    if (options) {\n      this.setOptions(options)\n    }\n\n    // Use the options from the first observer with a query function if no function is found.\n    // This can happen when the query is hydrated or created with setQueryData.\n    if (!this.options.queryFn) {\n      const observer = this.observers.find((x) => x.options.queryFn)\n      if (observer) {\n        this.setOptions(observer.options)\n      }\n    }\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (!Array.isArray(this.options.queryKey)) {\n        console.error(\n          `As of v4, queryKey needs to be an Array. If you are using a string like 'repoData', please change it to an Array, e.g. ['repoData']`,\n        )\n      }\n    }\n\n    const abortController = new AbortController()\n\n    // Adds an enumerable signal property to the object that\n    // which sets abortSignalConsumed to true when the signal\n    // is read.\n    const addSignalProperty = (object: unknown) => {\n      Object.defineProperty(object, 'signal', {\n        enumerable: true,\n        get: () => {\n          this.#abortSignalConsumed = true\n          return abortController.signal\n        },\n      })\n    }\n\n    // Create fetch function\n    const fetchFn = () => {\n      const queryFn = ensureQueryFn(this.options, fetchOptions)\n\n      // Create query function context\n      const createQueryFnContext = (): QueryFunctionContext<TQueryKey> => {\n        const queryFnContext: OmitKeyof<\n          QueryFunctionContext<TQueryKey>,\n          'signal'\n        > = {\n          client: this.#client,\n          queryKey: this.queryKey,\n          meta: this.meta,\n        }\n        addSignalProperty(queryFnContext)\n        return queryFnContext as QueryFunctionContext<TQueryKey>\n      }\n\n      const queryFnContext = createQueryFnContext()\n\n      this.#abortSignalConsumed = false\n      if (this.options.persister) {\n        return this.options.persister(\n          queryFn,\n          queryFnContext,\n          this as unknown as Query,\n        )\n      }\n\n      return queryFn(queryFnContext)\n    }\n\n    // Trigger behavior hook\n    const createFetchContext = (): FetchContext<\n      TQueryFnData,\n      TError,\n      TData,\n      TQueryKey\n    > => {\n      const context: OmitKeyof<\n        FetchContext<TQueryFnData, TError, TData, TQueryKey>,\n        'signal'\n      > = {\n        fetchOptions,\n        options: this.options,\n        queryKey: this.queryKey,\n        client: this.#client,\n        state: this.state,\n        fetchFn,\n      }\n\n      addSignalProperty(context)\n      return context as FetchContext<TQueryFnData, TError, TData, TQueryKey>\n    }\n\n    const context = createFetchContext()\n\n    this.options.behavior?.onFetch(context, this as unknown as Query)\n\n    // Store state in case the current fetch needs to be reverted\n    this.#revertState = this.state\n\n    // Set to fetching state if not already in it\n    if (\n      this.state.fetchStatus === 'idle' ||\n      this.state.fetchMeta !== context.fetchOptions?.meta\n    ) {\n      this.#dispatch({ type: 'fetch', meta: context.fetchOptions?.meta })\n    }\n\n    // Try to fetch the data\n    this.#retryer = createRetryer({\n      initialPromise: fetchOptions?.initialPromise as\n        | Promise<TData>\n        | undefined,\n      fn: context.fetchFn as () => Promise<TData>,\n      onCancel: (error) => {\n        if (error instanceof CancelledError && error.revert) {\n          this.setState({\n            ...this.#revertState,\n            fetchStatus: 'idle' as const,\n          })\n        }\n        abortController.abort()\n      },\n      onFail: (failureCount, error) => {\n        this.#dispatch({ type: 'failed', failureCount, error })\n      },\n      onPause: () => {\n        this.#dispatch({ type: 'pause' })\n      },\n      onContinue: () => {\n        this.#dispatch({ type: 'continue' })\n      },\n      retry: context.options.retry,\n      retryDelay: context.options.retryDelay,\n      networkMode: context.options.networkMode,\n      canRun: () => true,\n    })\n\n    try {\n      const data = await this.#retryer.start()\n      // this is more of a runtime guard\n      // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n      if (data === undefined) {\n        if (process.env.NODE_ENV !== 'production') {\n          console.error(\n            `Query data cannot be undefined. Please make sure to return a value other than undefined from your query function. Affected query key: ${this.queryHash}`,\n          )\n        }\n        throw new Error(`${this.queryHash} data is undefined`)\n      }\n\n      this.setData(data)\n\n      // Notify cache callback\n      this.#cache.config.onSuccess?.(data, this as Query<any, any, any, any>)\n      this.#cache.config.onSettled?.(\n        data,\n        this.state.error as any,\n        this as Query<any, any, any, any>,\n      )\n      return data\n    } catch (error) {\n      if (error instanceof CancelledError) {\n        if (error.silent) {\n          // silent cancellation implies a new fetch is going to be started,\n          // so we piggyback onto that promise\n          return this.#retryer.promise\n        } else if (error.revert) {\n          // transform error into reverted state data\n          // if the initial fetch was cancelled, we have no data, so we have\n          // to get reject with a CancelledError\n          if (this.state.data === undefined) {\n            throw error\n          }\n          return this.state.data\n        }\n      }\n      this.#dispatch({\n        type: 'error',\n        error: error as TError,\n      })\n\n      // Notify cache callback\n      this.#cache.config.onError?.(\n        error as any,\n        this as Query<any, any, any, any>,\n      )\n      this.#cache.config.onSettled?.(\n        this.state.data,\n        error as any,\n        this as Query<any, any, any, any>,\n      )\n\n      throw error // rethrow the error for further handling\n    } finally {\n      // Schedule query gc after fetching\n      this.scheduleGc()\n    }\n  }\n\n  #dispatch(action: Action<TData, TError>): void {\n    const reducer = (\n      state: QueryState<TData, TError>,\n    ): QueryState<TData, TError> => {\n      switch (action.type) {\n        case 'failed':\n          return {\n            ...state,\n            fetchFailureCount: action.failureCount,\n            fetchFailureReason: action.error,\n          }\n        case 'pause':\n          return {\n            ...state,\n            fetchStatus: 'paused',\n          }\n        case 'continue':\n          return {\n            ...state,\n            fetchStatus: 'fetching',\n          }\n        case 'fetch':\n          return {\n            ...state,\n            ...fetchState(state.data, this.options),\n            fetchMeta: action.meta ?? null,\n          }\n        case 'success':\n          const newState = {\n            ...state,\n            data: action.data,\n            dataUpdateCount: state.dataUpdateCount + 1,\n            dataUpdatedAt: action.dataUpdatedAt ?? Date.now(),\n            error: null,\n            isInvalidated: false,\n            status: 'success' as const,\n            ...(!action.manual && {\n              fetchStatus: 'idle' as const,\n              fetchFailureCount: 0,\n              fetchFailureReason: null,\n            }),\n          }\n          // If fetching ends successfully, we don't need revertState as a fallback anymore.\n          // For manual updates, capture the state to revert to it in case of a cancellation.\n          this.#revertState = action.manual ? newState : undefined\n\n          return newState\n        case 'error':\n          const error = action.error\n          return {\n            ...state,\n            error,\n            errorUpdateCount: state.errorUpdateCount + 1,\n            errorUpdatedAt: Date.now(),\n            fetchFailureCount: state.fetchFailureCount + 1,\n            fetchFailureReason: error,\n            fetchStatus: 'idle',\n            status: 'error',\n          }\n        case 'invalidate':\n          return {\n            ...state,\n            isInvalidated: true,\n          }\n        case 'setState':\n          return {\n            ...state,\n            ...action.state,\n          }\n      }\n    }\n\n    this.state = reducer(this.state)\n\n    notifyManager.batch(() => {\n      this.observers.forEach((observer) => {\n        observer.onQueryUpdate()\n      })\n\n      this.#cache.notify({ query: this, type: 'updated', action })\n    })\n  }\n}\n\nexport function fetchState<\n  TQueryFnData,\n  TError,\n  TData,\n  TQueryKey extends QueryKey,\n>(\n  data: TData | undefined,\n  options: QueryOptions<TQueryFnData, TError, TData, TQueryKey>,\n) {\n  return {\n    fetchFailureCount: 0,\n    fetchFailureReason: null,\n    fetchStatus: canFetch(options.networkMode) ? 'fetching' : 'paused',\n    ...(data === undefined &&\n      ({\n        error: null,\n        status: 'pending',\n      } as const)),\n  } as const\n}\n\nfunction getDefaultState<\n  TQueryFnData,\n  TError,\n  TData,\n  TQueryKey extends QueryKey,\n>(\n  options: QueryOptions<TQueryFnData, TError, TData, TQueryKey>,\n): QueryState<TData, TError> {\n  const data =\n    typeof options.initialData === 'function'\n      ? (options.initialData as InitialDataFunction<TData>)()\n      : options.initialData\n\n  const hasData = data !== undefined\n\n  const initialDataUpdatedAt = hasData\n    ? typeof options.initialDataUpdatedAt === 'function'\n      ? (options.initialDataUpdatedAt as () => number | undefined)()\n      : options.initialDataUpdatedAt\n    : 0\n\n  return {\n    data,\n    dataUpdateCount: 0,\n    dataUpdatedAt: hasData ? (initialDataUpdatedAt ?? Date.now()) : 0,\n    error: null,\n    errorUpdateCount: 0,\n    errorUpdatedAt: 0,\n    fetchFailureCount: 0,\n    fetchFailureReason: null,\n    fetchMeta: null,\n    isInvalidated: false,\n    status: hasData ? 'success' : 'pending',\n    fetchStatus: 'idle',\n  }\n}\n","import { addToEnd, addToStart, ensureQueryFn } from './utils'\nimport type { QueryBehavior } from './query'\nimport type {\n  InfiniteData,\n  InfiniteQueryPageParamsOptions,\n  OmitKeyof,\n  QueryFunctionContext,\n  QueryKey,\n} from './types'\n\nexport function infiniteQueryBehavior<TQueryFnData, TError, TData, TPageParam>(\n  pages?: number,\n): QueryBehavior<TQueryFnData, TError, InfiniteData<TData, TPageParam>> {\n  return {\n    onFetch: (context, query) => {\n      const options = context.options as InfiniteQueryPageParamsOptions<TData>\n      const direction = context.fetchOptions?.meta?.fetchMore?.direction\n      const oldPages = context.state.data?.pages || []\n      const oldPageParams = context.state.data?.pageParams || []\n      let result: InfiniteData<unknown> = { pages: [], pageParams: [] }\n      let currentPage = 0\n\n      const fetchFn = async () => {\n        let cancelled = false\n        const addSignalProperty = (object: unknown) => {\n          Object.defineProperty(object, 'signal', {\n            enumerable: true,\n            get: () => {\n              if (context.signal.aborted) {\n                cancelled = true\n              } else {\n                context.signal.addEventListener('abort', () => {\n                  cancelled = true\n                })\n              }\n              return context.signal\n            },\n          })\n        }\n\n        const queryFn = ensureQueryFn(context.options, context.fetchOptions)\n\n        // Create function to fetch a page\n        const fetchPage = async (\n          data: InfiniteData<unknown>,\n          param: unknown,\n          previous?: boolean,\n        ): Promise<InfiniteData<unknown>> => {\n          if (cancelled) {\n            return Promise.reject()\n          }\n\n          if (param == null && data.pages.length) {\n            return Promise.resolve(data)\n          }\n\n          const createQueryFnContext = () => {\n            const queryFnContext: OmitKeyof<\n              QueryFunctionContext<QueryKey, unknown>,\n              'signal'\n            > = {\n              client: context.client,\n              queryKey: context.queryKey,\n              pageParam: param,\n              direction: previous ? 'backward' : 'forward',\n              meta: context.options.meta,\n            }\n            addSignalProperty(queryFnContext)\n            return queryFnContext as QueryFunctionContext<QueryKey, unknown>\n          }\n\n          const queryFnContext = createQueryFnContext()\n\n          const page = await queryFn(queryFnContext)\n\n          const { maxPages } = context.options\n          const addTo = previous ? addToStart : addToEnd\n\n          return {\n            pages: addTo(data.pages, page, maxPages),\n            pageParams: addTo(data.pageParams, param, maxPages),\n          }\n        }\n\n        // fetch next / previous page?\n        if (direction && oldPages.length) {\n          const previous = direction === 'backward'\n          const pageParamFn = previous ? getPreviousPageParam : getNextPageParam\n          const oldData = {\n            pages: oldPages,\n            pageParams: oldPageParams,\n          }\n          const param = pageParamFn(options, oldData)\n\n          result = await fetchPage(oldData, param, previous)\n        } else {\n          const remainingPages = pages ?? oldPages.length\n\n          // Fetch all pages\n          do {\n            const param =\n              currentPage === 0\n                ? (oldPageParams[0] ?? options.initialPageParam)\n                : getNextPageParam(options, result)\n            if (currentPage > 0 && param == null) {\n              break\n            }\n            result = await fetchPage(result, param)\n            currentPage++\n          } while (currentPage < remainingPages)\n        }\n\n        return result\n      }\n      if (context.options.persister) {\n        context.fetchFn = () => {\n          return context.options.persister?.(\n            fetchFn as any,\n            {\n              client: context.client,\n              queryKey: context.queryKey,\n              meta: context.options.meta,\n              signal: context.signal,\n            },\n            query,\n          )\n        }\n      } else {\n        context.fetchFn = fetchFn\n      }\n    },\n  }\n}\n\nfunction getNextPageParam(\n  options: InfiniteQueryPageParamsOptions<any>,\n  { pages, pageParams }: InfiniteData<unknown>,\n): unknown | undefined {\n  const lastIndex = pages.length - 1\n  return pages.length > 0\n    ? options.getNextPageParam(\n        pages[lastIndex],\n        pages,\n        pageParams[lastIndex],\n        pageParams,\n      )\n    : undefined\n}\n\nfunction getPreviousPageParam(\n  options: InfiniteQueryPageParamsOptions<any>,\n  { pages, pageParams }: InfiniteData<unknown>,\n): unknown | undefined {\n  return pages.length > 0\n    ? options.getPreviousPageParam?.(pages[0], pages, pageParams[0], pageParams)\n    : undefined\n}\n\n/**\n * Checks if there is a next page.\n */\nexport function hasNextPage(\n  options: InfiniteQueryPageParamsOptions<any, any>,\n  data?: InfiniteData<unknown>,\n): boolean {\n  if (!data) return false\n  return getNextPageParam(options, data) != null\n}\n\n/**\n * Checks if there is a previous page.\n */\nexport function hasPreviousPage(\n  options: InfiniteQueryPageParamsOptions<any, any>,\n  data?: InfiniteData<unknown>,\n): boolean {\n  if (!data || !options.getPreviousPageParam) return false\n  return getPreviousPageParam(options, data) != null\n}\n","import { notifyManager } from './notifyManager'\nimport { Removable } from './removable'\nimport { createRetryer } from './retryer'\nimport type {\n  DefaultError,\n  MutationFunctionContext,\n  MutationMeta,\n  MutationOptions,\n  MutationStatus,\n} from './types'\nimport type { MutationCache } from './mutationCache'\nimport type { MutationObserver } from './mutationObserver'\nimport type { Retryer } from './retryer'\nimport type { QueryClient } from './queryClient'\n\n// TYPES\n\ninterface MutationConfig<TData, TError, TVariables, TOnMutateResult> {\n  client: QueryClient\n  mutationId: number\n  mutationCache: MutationCache\n  options: MutationOptions<TData, TError, TVariables, TOnMutateResult>\n  state?: MutationState<TData, TError, TVariables, TOnMutateResult>\n}\n\nexport interface MutationState<\n  TData = unknown,\n  TError = DefaultError,\n  TVariables = unknown,\n  TOnMutateResult = unknown,\n> {\n  context: TOnMutateResult | undefined\n  data: TData | undefined\n  error: TError | null\n  failureCount: number\n  failureReason: TError | null\n  isPaused: boolean\n  status: MutationStatus\n  variables: TVariables | undefined\n  submittedAt: number\n}\n\ninterface FailedAction<TError> {\n  type: 'failed'\n  failureCount: number\n  error: TError | null\n}\n\ninterface PendingAction<TVariables, TOnMutateResult> {\n  type: 'pending'\n  isPaused: boolean\n  variables?: TVariables\n  context?: TOnMutateResult\n}\n\ninterface SuccessAction<TData> {\n  type: 'success'\n  data: TData\n}\n\ninterface ErrorAction<TError> {\n  type: 'error'\n  error: TError\n}\n\ninterface PauseAction {\n  type: 'pause'\n}\n\ninterface ContinueAction {\n  type: 'continue'\n}\n\nexport type Action<TData, TError, TVariables, TOnMutateResult> =\n  | ContinueAction\n  | ErrorAction<TError>\n  | FailedAction<TError>\n  | PendingAction<TVariables, TOnMutateResult>\n  | PauseAction\n  | SuccessAction<TData>\n\n// CLASS\n\nexport class Mutation<\n  TData = unknown,\n  TError = DefaultError,\n  TVariables = unknown,\n  TOnMutateResult = unknown,\n> extends Removable {\n  state: MutationState<TData, TError, TVariables, TOnMutateResult>\n  options!: MutationOptions<TData, TError, TVariables, TOnMutateResult>\n  readonly mutationId: number\n\n  #client: QueryClient\n  #observers: Array<\n    MutationObserver<TData, TError, TVariables, TOnMutateResult>\n  >\n  #mutationCache: MutationCache\n  #retryer?: Retryer<TData>\n\n  constructor(\n    config: MutationConfig<TData, TError, TVariables, TOnMutateResult>,\n  ) {\n    super()\n\n    this.#client = config.client\n    this.mutationId = config.mutationId\n    this.#mutationCache = config.mutationCache\n    this.#observers = []\n    this.state = config.state || getDefaultState()\n\n    this.setOptions(config.options)\n    this.scheduleGc()\n  }\n\n  setOptions(\n    options: MutationOptions<TData, TError, TVariables, TOnMutateResult>,\n  ): void {\n    this.options = options\n\n    this.updateGcTime(this.options.gcTime)\n  }\n\n  get meta(): MutationMeta | undefined {\n    return this.options.meta\n  }\n\n  addObserver(observer: MutationObserver<any, any, any, any>): void {\n    if (!this.#observers.includes(observer)) {\n      this.#observers.push(observer)\n\n      // Stop the mutation from being garbage collected\n      this.clearGcTimeout()\n\n      this.#mutationCache.notify({\n        type: 'observerAdded',\n        mutation: this,\n        observer,\n      })\n    }\n  }\n\n  removeObserver(observer: MutationObserver<any, any, any, any>): void {\n    this.#observers = this.#observers.filter((x) => x !== observer)\n\n    this.scheduleGc()\n\n    this.#mutationCache.notify({\n      type: 'observerRemoved',\n      mutation: this,\n      observer,\n    })\n  }\n\n  protected optionalRemove() {\n    if (!this.#observers.length) {\n      if (this.state.status === 'pending') {\n        this.scheduleGc()\n      } else {\n        this.#mutationCache.remove(this)\n      }\n    }\n  }\n\n  continue(): Promise<unknown> {\n    return (\n      this.#retryer?.continue() ??\n      // continuing a mutation assumes that variables are set, mutation must have been dehydrated before\n      this.execute(this.state.variables!)\n    )\n  }\n\n  async execute(variables: TVariables): Promise<TData> {\n    const onContinue = () => {\n      this.#dispatch({ type: 'continue' })\n    }\n\n    const mutationFnContext = {\n      client: this.#client,\n      meta: this.options.meta,\n      mutationKey: this.options.mutationKey,\n    } satisfies MutationFunctionContext\n\n    this.#retryer = createRetryer({\n      fn: () => {\n        if (!this.options.mutationFn) {\n          return Promise.reject(new Error('No mutationFn found'))\n        }\n\n        return this.options.mutationFn(variables, mutationFnContext)\n      },\n      onFail: (failureCount, error) => {\n        this.#dispatch({ type: 'failed', failureCount, error })\n      },\n      onPause: () => {\n        this.#dispatch({ type: 'pause' })\n      },\n      onContinue,\n      retry: this.options.retry ?? 0,\n      retryDelay: this.options.retryDelay,\n      networkMode: this.options.networkMode,\n      canRun: () => this.#mutationCache.canRun(this),\n    })\n\n    const restored = this.state.status === 'pending'\n    const isPaused = !this.#retryer.canStart()\n\n    try {\n      if (restored) {\n        // Dispatch continue action to unpause restored mutation\n        onContinue()\n      } else {\n        this.#dispatch({ type: 'pending', variables, isPaused })\n        // Notify cache callback\n        await this.#mutationCache.config.onMutate?.(\n          variables,\n          this as Mutation<unknown, unknown, unknown, unknown>,\n          mutationFnContext,\n        )\n        const context = await this.options.onMutate?.(\n          variables,\n          mutationFnContext,\n        )\n        if (context !== this.state.context) {\n          this.#dispatch({\n            type: 'pending',\n            context,\n            variables,\n            isPaused,\n          })\n        }\n      }\n      const data = await this.#retryer.start()\n\n      // Notify cache callback\n      await this.#mutationCache.config.onSuccess?.(\n        data,\n        variables,\n        this.state.context,\n        this as Mutation<unknown, unknown, unknown, unknown>,\n        mutationFnContext,\n      )\n\n      await this.options.onSuccess?.(\n        data,\n        variables,\n        this.state.context!,\n        mutationFnContext,\n      )\n\n      // Notify cache callback\n      await this.#mutationCache.config.onSettled?.(\n        data,\n        null,\n        this.state.variables,\n        this.state.context,\n        this as Mutation<unknown, unknown, unknown, unknown>,\n        mutationFnContext,\n      )\n\n      await this.options.onSettled?.(\n        data,\n        null,\n        variables,\n        this.state.context,\n        mutationFnContext,\n      )\n\n      this.#dispatch({ type: 'success', data })\n      return data\n    } catch (error) {\n      try {\n        // Notify cache callback\n        await this.#mutationCache.config.onError?.(\n          error as any,\n          variables,\n          this.state.context,\n          this as Mutation<unknown, unknown, unknown, unknown>,\n          mutationFnContext,\n        )\n\n        await this.options.onError?.(\n          error as TError,\n          variables,\n          this.state.context,\n          mutationFnContext,\n        )\n\n        // Notify cache callback\n        await this.#mutationCache.config.onSettled?.(\n          undefined,\n          error as any,\n          this.state.variables,\n          this.state.context,\n          this as Mutation<unknown, unknown, unknown, unknown>,\n          mutationFnContext,\n        )\n\n        await this.options.onSettled?.(\n          undefined,\n          error as TError,\n          variables,\n          this.state.context,\n          mutationFnContext,\n        )\n        throw error\n      } finally {\n        this.#dispatch({ type: 'error', error: error as TError })\n      }\n    } finally {\n      this.#mutationCache.runNext(this)\n    }\n  }\n\n  #dispatch(action: Action<TData, TError, TVariables, TOnMutateResult>): void {\n    const reducer = (\n      state: MutationState<TData, TError, TVariables, TOnMutateResult>,\n    ): MutationState<TData, TError, TVariables, TOnMutateResult> => {\n      switch (action.type) {\n        case 'failed':\n          return {\n            ...state,\n            failureCount: action.failureCount,\n            failureReason: action.error,\n          }\n        case 'pause':\n          return {\n            ...state,\n            isPaused: true,\n          }\n        case 'continue':\n          return {\n            ...state,\n            isPaused: false,\n          }\n        case 'pending':\n          return {\n            ...state,\n            context: action.context,\n            data: undefined,\n            failureCount: 0,\n            failureReason: null,\n            error: null,\n            isPaused: action.isPaused,\n            status: 'pending',\n            variables: action.variables,\n            submittedAt: Date.now(),\n          }\n        case 'success':\n          return {\n            ...state,\n            data: action.data,\n            failureCount: 0,\n            failureReason: null,\n            error: null,\n            status: 'success',\n            isPaused: false,\n          }\n        case 'error':\n          return {\n            ...state,\n            data: undefined,\n            error: action.error,\n            failureCount: state.failureCount + 1,\n            failureReason: action.error,\n            isPaused: false,\n            status: 'error',\n          }\n      }\n    }\n    this.state = reducer(this.state)\n\n    notifyManager.batch(() => {\n      this.#observers.forEach((observer) => {\n        observer.onMutationUpdate(action)\n      })\n      this.#mutationCache.notify({\n        mutation: this,\n        type: 'updated',\n        action,\n      })\n    })\n  }\n}\n\nexport function getDefaultState<\n  TData,\n  TError,\n  TVariables,\n  TOnMutateResult,\n>(): MutationState<TData, TError, TVariables, TOnMutateResult> {\n  return {\n    context: undefined,\n    data: undefined,\n    error: null,\n    failureCount: 0,\n    failureReason: null,\n    isPaused: false,\n    status: 'idle',\n    variables: undefined,\n    submittedAt: 0,\n  }\n}\n","import { notifyManager } from './notifyManager'\nimport { Mutation } from './mutation'\nimport { matchMutation, noop } from './utils'\nimport { Subscribable } from './subscribable'\nimport type { MutationObserver } from './mutationObserver'\nimport type {\n  DefaultError,\n  MutationFunctionContext,\n  MutationOptions,\n  NotifyEvent,\n} from './types'\nimport type { QueryClient } from './queryClient'\nimport type { Action, MutationState } from './mutation'\nimport type { MutationFilters } from './utils'\n\n// TYPES\n\ninterface MutationCacheConfig {\n  onError?: (\n    error: DefaultError,\n    variables: unknown,\n    onMutateResult: unknown,\n    mutation: Mutation<unknown, unknown, unknown>,\n    context: MutationFunctionContext,\n  ) => Promise<unknown> | unknown\n  onSuccess?: (\n    data: unknown,\n    variables: unknown,\n    onMutateResult: unknown,\n    mutation: Mutation<unknown, unknown, unknown>,\n    context: MutationFunctionContext,\n  ) => Promise<unknown> | unknown\n  onMutate?: (\n    variables: unknown,\n    mutation: Mutation<unknown, unknown, unknown>,\n    context: MutationFunctionContext,\n  ) => Promise<unknown> | unknown\n  onSettled?: (\n    data: unknown | undefined,\n    error: DefaultError | null,\n    variables: unknown,\n    onMutateResult: unknown,\n    mutation: Mutation<unknown, unknown, unknown>,\n    context: MutationFunctionContext,\n  ) => Promise<unknown> | unknown\n}\n\ninterface NotifyEventMutationAdded extends NotifyEvent {\n  type: 'added'\n  mutation: Mutation<any, any, any, any>\n}\ninterface NotifyEventMutationRemoved extends NotifyEvent {\n  type: 'removed'\n  mutation: Mutation<any, any, any, any>\n}\n\ninterface NotifyEventMutationObserverAdded extends NotifyEvent {\n  type: 'observerAdded'\n  mutation: Mutation<any, any, any, any>\n  observer: MutationObserver<any, any, any>\n}\n\ninterface NotifyEventMutationObserverRemoved extends NotifyEvent {\n  type: 'observerRemoved'\n  mutation: Mutation<any, any, any, any>\n  observer: MutationObserver<any, any, any>\n}\n\ninterface NotifyEventMutationObserverOptionsUpdated extends NotifyEvent {\n  type: 'observerOptionsUpdated'\n  mutation?: Mutation<any, any, any, any>\n  observer: MutationObserver<any, any, any, any>\n}\n\ninterface NotifyEventMutationUpdated extends NotifyEvent {\n  type: 'updated'\n  mutation: Mutation<any, any, any, any>\n  action: Action<any, any, any, any>\n}\n\nexport type MutationCacheNotifyEvent =\n  | NotifyEventMutationAdded\n  | NotifyEventMutationRemoved\n  | NotifyEventMutationObserverAdded\n  | NotifyEventMutationObserverRemoved\n  | NotifyEventMutationObserverOptionsUpdated\n  | NotifyEventMutationUpdated\n\ntype MutationCacheListener = (event: MutationCacheNotifyEvent) => void\n\n// CLASS\n\nexport class MutationCache extends Subscribable<MutationCacheListener> {\n  #mutations: Set<Mutation<any, any, any, any>>\n  #scopes: Map<string, Array<Mutation<any, any, any, any>>>\n  #mutationId: number\n\n  constructor(public config: MutationCacheConfig = {}) {\n    super()\n    this.#mutations = new Set()\n    this.#scopes = new Map()\n    this.#mutationId = 0\n  }\n\n  build<TData, TError, TVariables, TOnMutateResult>(\n    client: QueryClient,\n    options: MutationOptions<TData, TError, TVariables, TOnMutateResult>,\n    state?: MutationState<TData, TError, TVariables, TOnMutateResult>,\n  ): Mutation<TData, TError, TVariables, TOnMutateResult> {\n    const mutation = new Mutation({\n      client,\n      mutationCache: this,\n      mutationId: ++this.#mutationId,\n      options: client.defaultMutationOptions(options),\n      state,\n    })\n\n    this.add(mutation)\n\n    return mutation\n  }\n\n  add(mutation: Mutation<any, any, any, any>): void {\n    this.#mutations.add(mutation)\n    const scope = scopeFor(mutation)\n    if (typeof scope === 'string') {\n      const scopedMutations = this.#scopes.get(scope)\n      if (scopedMutations) {\n        scopedMutations.push(mutation)\n      } else {\n        this.#scopes.set(scope, [mutation])\n      }\n    }\n    this.notify({ type: 'added', mutation })\n  }\n\n  remove(mutation: Mutation<any, any, any, any>): void {\n    if (this.#mutations.delete(mutation)) {\n      const scope = scopeFor(mutation)\n      if (typeof scope === 'string') {\n        const scopedMutations = this.#scopes.get(scope)\n        if (scopedMutations) {\n          if (scopedMutations.length > 1) {\n            const index = scopedMutations.indexOf(mutation)\n            if (index !== -1) {\n              scopedMutations.splice(index, 1)\n            }\n          } else if (scopedMutations[0] === mutation) {\n            this.#scopes.delete(scope)\n          }\n        }\n      }\n    }\n\n    // Currently we notify the removal even if the mutation was already removed.\n    // Consider making this an error or not notifying of the removal depending on the desired semantics.\n    this.notify({ type: 'removed', mutation })\n  }\n\n  canRun(mutation: Mutation<any, any, any, any>): boolean {\n    const scope = scopeFor(mutation)\n    if (typeof scope === 'string') {\n      const mutationsWithSameScope = this.#scopes.get(scope)\n      const firstPendingMutation = mutationsWithSameScope?.find(\n        (m) => m.state.status === 'pending',\n      )\n      // we can run if there is no current pending mutation (start use-case)\n      // or if WE are the first pending mutation (continue use-case)\n      return !firstPendingMutation || firstPendingMutation === mutation\n    } else {\n      // For unscoped mutations there are never any pending mutations in front of the\n      // current mutation\n      return true\n    }\n  }\n\n  runNext(mutation: Mutation<any, any, any, any>): Promise<unknown> {\n    const scope = scopeFor(mutation)\n    if (typeof scope === 'string') {\n      const foundMutation = this.#scopes\n        .get(scope)\n        ?.find((m) => m !== mutation && m.state.isPaused)\n\n      return foundMutation?.continue() ?? Promise.resolve()\n    } else {\n      return Promise.resolve()\n    }\n  }\n\n  clear(): void {\n    notifyManager.batch(() => {\n      this.#mutations.forEach((mutation) => {\n        this.notify({ type: 'removed', mutation })\n      })\n      this.#mutations.clear()\n      this.#scopes.clear()\n    })\n  }\n\n  getAll(): Array<Mutation> {\n    return Array.from(this.#mutations)\n  }\n\n  find<\n    TData = unknown,\n    TError = DefaultError,\n    TVariables = any,\n    TOnMutateResult = unknown,\n  >(\n    filters: MutationFilters,\n  ): Mutation<TData, TError, TVariables, TOnMutateResult> | undefined {\n    const defaultedFilters = { exact: true, ...filters }\n\n    return this.getAll().find((mutation) =>\n      matchMutation(defaultedFilters, mutation),\n    ) as Mutation<TData, TError, TVariables, TOnMutateResult> | undefined\n  }\n\n  findAll(filters: MutationFilters = {}): Array<Mutation> {\n    return this.getAll().filter((mutation) => matchMutation(filters, mutation))\n  }\n\n  notify(event: MutationCacheNotifyEvent) {\n    notifyManager.batch(() => {\n      this.listeners.forEach((listener) => {\n        listener(event)\n      })\n    })\n  }\n\n  resumePausedMutations(): Promise<unknown> {\n    const pausedMutations = this.getAll().filter((x) => x.state.isPaused)\n\n    return notifyManager.batch(() =>\n      Promise.all(\n        pausedMutations.map((mutation) => mutation.continue().catch(noop)),\n      ),\n    )\n  }\n}\n\nfunction scopeFor(mutation: Mutation<any, any, any, any>) {\n  return mutation.options.scope?.id\n}\n","import { hashQueryKeyByOptions, matchQuery } from './utils'\nimport { Query } from './query'\nimport { notifyManager } from './notifyManager'\nimport { Subscribable } from './subscribable'\nimport type { QueryFilters } from './utils'\nimport type { Action, QueryState } from './query'\nimport type {\n  DefaultError,\n  NotifyEvent,\n  QueryKey,\n  QueryOptions,\n  WithRequired,\n} from './types'\nimport type { QueryClient } from './queryClient'\nimport type { QueryObserver } from './queryObserver'\n\n// TYPES\n\ninterface QueryCacheConfig {\n  onError?: (\n    error: DefaultError,\n    query: Query<unknown, unknown, unknown>,\n  ) => void\n  onSuccess?: (data: unknown, query: Query<unknown, unknown, unknown>) => void\n  onSettled?: (\n    data: unknown | undefined,\n    error: DefaultError | null,\n    query: Query<unknown, unknown, unknown>,\n  ) => void\n}\n\ninterface NotifyEventQueryAdded extends NotifyEvent {\n  type: 'added'\n  query: Query<any, any, any, any>\n}\n\ninterface NotifyEventQueryRemoved extends NotifyEvent {\n  type: 'removed'\n  query: Query<any, any, any, any>\n}\n\ninterface NotifyEventQueryUpdated extends NotifyEvent {\n  type: 'updated'\n  query: Query<any, any, any, any>\n  action: Action<any, any>\n}\n\ninterface NotifyEventQueryObserverAdded extends NotifyEvent {\n  type: 'observerAdded'\n  query: Query<any, any, any, any>\n  observer: QueryObserver<any, any, any, any, any>\n}\n\ninterface NotifyEventQueryObserverRemoved extends NotifyEvent {\n  type: 'observerRemoved'\n  query: Query<any, any, any, any>\n  observer: QueryObserver<any, any, any, any, any>\n}\n\ninterface NotifyEventQueryObserverResultsUpdated extends NotifyEvent {\n  type: 'observerResultsUpdated'\n  query: Query<any, any, any, any>\n}\n\ninterface NotifyEventQueryObserverOptionsUpdated extends NotifyEvent {\n  type: 'observerOptionsUpdated'\n  query: Query<any, any, any, any>\n  observer: QueryObserver<any, any, any, any, any>\n}\n\nexport type QueryCacheNotifyEvent =\n  | NotifyEventQueryAdded\n  | NotifyEventQueryRemoved\n  | NotifyEventQueryUpdated\n  | NotifyEventQueryObserverAdded\n  | NotifyEventQueryObserverRemoved\n  | NotifyEventQueryObserverResultsUpdated\n  | NotifyEventQueryObserverOptionsUpdated\n\ntype QueryCacheListener = (event: QueryCacheNotifyEvent) => void\n\nexport interface QueryStore {\n  has: (queryHash: string) => boolean\n  set: (queryHash: string, query: Query) => void\n  get: (queryHash: string) => Query | undefined\n  delete: (queryHash: string) => void\n  values: () => IterableIterator<Query>\n}\n\n// CLASS\n\nexport class QueryCache extends Subscribable<QueryCacheListener> {\n  #queries: QueryStore\n\n  constructor(public config: QueryCacheConfig = {}) {\n    super()\n    this.#queries = new Map<string, Query>()\n  }\n\n  build<\n    TQueryFnData = unknown,\n    TError = DefaultError,\n    TData = TQueryFnData,\n    TQueryKey extends QueryKey = QueryKey,\n  >(\n    client: QueryClient,\n    options: WithRequired<\n      QueryOptions<TQueryFnData, TError, TData, TQueryKey>,\n      'queryKey'\n    >,\n    state?: QueryState<TData, TError>,\n  ): Query<TQueryFnData, TError, TData, TQueryKey> {\n    const queryKey = options.queryKey\n    const queryHash =\n      options.queryHash ?? hashQueryKeyByOptions(queryKey, options)\n    let query = this.get<TQueryFnData, TError, TData, TQueryKey>(queryHash)\n\n    if (!query) {\n      query = new Query({\n        client,\n        queryKey,\n        queryHash,\n        options: client.defaultQueryOptions(options),\n        state,\n        defaultOptions: client.getQueryDefaults(queryKey),\n      })\n      this.add(query)\n    }\n\n    return query\n  }\n\n  add(query: Query<any, any, any, any>): void {\n    if (!this.#queries.has(query.queryHash)) {\n      this.#queries.set(query.queryHash, query)\n\n      this.notify({\n        type: 'added',\n        query,\n      })\n    }\n  }\n\n  remove(query: Query<any, any, any, any>): void {\n    const queryInMap = this.#queries.get(query.queryHash)\n\n    if (queryInMap) {\n      query.destroy()\n\n      if (queryInMap === query) {\n        this.#queries.delete(query.queryHash)\n      }\n\n      this.notify({ type: 'removed', query })\n    }\n  }\n\n  clear(): void {\n    notifyManager.batch(() => {\n      this.getAll().forEach((query) => {\n        this.remove(query)\n      })\n    })\n  }\n\n  get<\n    TQueryFnData = unknown,\n    TError = DefaultError,\n    TData = TQueryFnData,\n    TQueryKey extends QueryKey = QueryKey,\n  >(\n    queryHash: string,\n  ): Query<TQueryFnData, TError, TData, TQueryKey> | undefined {\n    return this.#queries.get(queryHash) as\n      | Query<TQueryFnData, TError, TData, TQueryKey>\n      | undefined\n  }\n\n  getAll(): Array<Query> {\n    return [...this.#queries.values()]\n  }\n\n  find<TQueryFnData = unknown, TError = DefaultError, TData = TQueryFnData>(\n    filters: WithRequired<QueryFilters, 'queryKey'>,\n  ): Query<TQueryFnData, TError, TData> | undefined {\n    const defaultedFilters = { exact: true, ...filters }\n\n    return this.getAll().find((query) =>\n      matchQuery(defaultedFilters, query),\n    ) as Query<TQueryFnData, TError, TData> | undefined\n  }\n\n  findAll(filters: QueryFilters<any> = {}): Array<Query> {\n    const queries = this.getAll()\n    return Object.keys(filters).length > 0\n      ? queries.filter((query) => matchQuery(filters, query))\n      : queries\n  }\n\n  notify(event: QueryCacheNotifyEvent): void {\n    notifyManager.batch(() => {\n      this.listeners.forEach((listener) => {\n        listener(event)\n      })\n    })\n  }\n\n  onFocus(): void {\n    notifyManager.batch(() => {\n      this.getAll().forEach((query) => {\n        query.onFocus()\n      })\n    })\n  }\n\n  onOnline(): void {\n    notifyManager.batch(() => {\n      this.getAll().forEach((query) => {\n        query.onOnline()\n      })\n    })\n  }\n}\n","import {\n  functionalUpdate,\n  hashKey,\n  hashQueryKeyByOptions,\n  noop,\n  partialMatchKey,\n  resolveStaleTime,\n  skipToken,\n} from './utils'\nimport { QueryCache } from './queryCache'\nimport { MutationCache } from './mutationCache'\nimport { focusManager } from './focusManager'\nimport { onlineManager } from './onlineManager'\nimport { notifyManager } from './notifyManager'\nimport { infiniteQueryBehavior } from './infiniteQueryBehavior'\nimport type {\n  CancelOptions,\n  DefaultError,\n  DefaultOptions,\n  DefaultedQueryObserverOptions,\n  EnsureInfiniteQueryDataOptions,\n  EnsureQueryDataOptions,\n  FetchInfiniteQueryOptions,\n  FetchQueryOptions,\n  InferDataFromTag,\n  InferErrorFromTag,\n  InfiniteData,\n  InvalidateOptions,\n  InvalidateQueryFilters,\n  MutationKey,\n  MutationObserverOptions,\n  MutationOptions,\n  NoInfer,\n  OmitKeyof,\n  QueryClientConfig,\n  QueryKey,\n  QueryObserverOptions,\n  QueryOptions,\n  RefetchOptions,\n  RefetchQueryFilters,\n  ResetOptions,\n  SetDataOptions,\n} from './types'\nimport type { QueryState } from './query'\nimport type { MutationFilters, QueryFilters, Updater } from './utils'\n\n// TYPES\n\ninterface QueryDefaults {\n  queryKey: QueryKey\n  defaultOptions: OmitKeyof<QueryOptions<any, any, any>, 'queryKey'>\n}\n\ninterface MutationDefaults {\n  mutationKey: MutationKey\n  defaultOptions: MutationOptions<any, any, any, any>\n}\n\n// CLASS\n\nexport class QueryClient {\n  #queryCache: QueryCache\n  #mutationCache: MutationCache\n  #defaultOptions: DefaultOptions\n  #queryDefaults: Map<string, QueryDefaults>\n  #mutationDefaults: Map<string, MutationDefaults>\n  #mountCount: number\n  #unsubscribeFocus?: () => void\n  #unsubscribeOnline?: () => void\n\n  constructor(config: QueryClientConfig = {}) {\n    this.#queryCache = config.queryCache || new QueryCache()\n    this.#mutationCache = config.mutationCache || new MutationCache()\n    this.#defaultOptions = config.defaultOptions || {}\n    this.#queryDefaults = new Map()\n    this.#mutationDefaults = new Map()\n    this.#mountCount = 0\n  }\n\n  mount(): void {\n    this.#mountCount++\n    if (this.#mountCount !== 1) return\n\n    this.#unsubscribeFocus = focusManager.subscribe(async (focused) => {\n      if (focused) {\n        await this.resumePausedMutations()\n        this.#queryCache.onFocus()\n      }\n    })\n    this.#unsubscribeOnline = onlineManager.subscribe(async (online) => {\n      if (online) {\n        await this.resumePausedMutations()\n        this.#queryCache.onOnline()\n      }\n    })\n  }\n\n  unmount(): void {\n    this.#mountCount--\n    if (this.#mountCount !== 0) return\n\n    this.#unsubscribeFocus?.()\n    this.#unsubscribeFocus = undefined\n\n    this.#unsubscribeOnline?.()\n    this.#unsubscribeOnline = undefined\n  }\n\n  isFetching<TQueryFilters extends QueryFilters<any> = QueryFilters>(\n    filters?: TQueryFilters,\n  ): number {\n    return this.#queryCache.findAll({ ...filters, fetchStatus: 'fetching' })\n      .length\n  }\n\n  isMutating<\n    TMutationFilters extends MutationFilters<any, any> = MutationFilters,\n  >(filters?: TMutationFilters): number {\n    return this.#mutationCache.findAll({ ...filters, status: 'pending' }).length\n  }\n\n  /**\n   * Imperative (non-reactive) way to retrieve data for a QueryKey.\n   * Should only be used in callbacks or functions where reading the latest data is necessary, e.g. for optimistic updates.\n   *\n   * Hint: Do not use this function inside a component, because it won't receive updates.\n   * Use `useQuery` to create a `QueryObserver` that subscribes to changes.\n   */\n  getQueryData<\n    TQueryFnData = unknown,\n    TTaggedQueryKey extends QueryKey = QueryKey,\n    TInferredQueryFnData = InferDataFromTag<TQueryFnData, TTaggedQueryKey>,\n  >(queryKey: TTaggedQueryKey): TInferredQueryFnData | undefined {\n    const options = this.defaultQueryOptions({ queryKey })\n\n    return this.#queryCache.get<TInferredQueryFnData>(options.queryHash)?.state\n      .data\n  }\n\n  ensureQueryData<\n    TQueryFnData,\n    TError = DefaultError,\n    TData = TQueryFnData,\n    TQueryKey extends QueryKey = QueryKey,\n  >(\n    options: EnsureQueryDataOptions<TQueryFnData, TError, TData, TQueryKey>,\n  ): Promise<TData> {\n    const defaultedOptions = this.defaultQueryOptions(options)\n    const query = this.#queryCache.build(this, defaultedOptions)\n    const cachedData = query.state.data\n\n    if (cachedData === undefined) {\n      return this.fetchQuery(options)\n    }\n\n    if (\n      options.revalidateIfStale &&\n      query.isStaleByTime(resolveStaleTime(defaultedOptions.staleTime, query))\n    ) {\n      void this.prefetchQuery(defaultedOptions)\n    }\n\n    return Promise.resolve(cachedData)\n  }\n\n  getQueriesData<\n    TQueryFnData = unknown,\n    TQueryFilters extends QueryFilters<any> = QueryFilters,\n  >(filters: TQueryFilters): Array<[QueryKey, TQueryFnData | undefined]> {\n    return this.#queryCache.findAll(filters).map(({ queryKey, state }) => {\n      const data = state.data as TQueryFnData | undefined\n      return [queryKey, data]\n    })\n  }\n\n  setQueryData<\n    TQueryFnData = unknown,\n    TTaggedQueryKey extends QueryKey = QueryKey,\n    TInferredQueryFnData = InferDataFromTag<TQueryFnData, TTaggedQueryKey>,\n  >(\n    queryKey: TTaggedQueryKey,\n    updater: Updater<\n      NoInfer<TInferredQueryFnData> | undefined,\n      NoInfer<TInferredQueryFnData> | undefined\n    >,\n    options?: SetDataOptions,\n  ): NoInfer<TInferredQueryFnData> | undefined {\n    const defaultedOptions = this.defaultQueryOptions<\n      any,\n      any,\n      unknown,\n      any,\n      QueryKey\n    >({ queryKey })\n\n    const query = this.#queryCache.get<TInferredQueryFnData>(\n      defaultedOptions.queryHash,\n    )\n    const prevData = query?.state.data\n    const data = functionalUpdate(updater, prevData)\n\n    if (data === undefined) {\n      return undefined\n    }\n\n    return this.#queryCache\n      .build(this, defaultedOptions)\n      .setData(data, { ...options, manual: true })\n  }\n\n  setQueriesData<\n    TQueryFnData,\n    TQueryFilters extends QueryFilters<any> = QueryFilters,\n  >(\n    filters: TQueryFilters,\n    updater: Updater<\n      NoInfer<TQueryFnData> | undefined,\n      NoInfer<TQueryFnData> | undefined\n    >,\n    options?: SetDataOptions,\n  ): Array<[QueryKey, TQueryFnData | undefined]> {\n    return notifyManager.batch(() =>\n      this.#queryCache\n        .findAll(filters)\n        .map(({ queryKey }) => [\n          queryKey,\n          this.setQueryData<TQueryFnData>(queryKey, updater, options),\n        ]),\n    )\n  }\n\n  getQueryState<\n    TQueryFnData = unknown,\n    TError = DefaultError,\n    TTaggedQueryKey extends QueryKey = QueryKey,\n    TInferredQueryFnData = InferDataFromTag<TQueryFnData, TTaggedQueryKey>,\n    TInferredError = InferErrorFromTag<TError, TTaggedQueryKey>,\n  >(\n    queryKey: TTaggedQueryKey,\n  ): QueryState<TInferredQueryFnData, TInferredError> | undefined {\n    const options = this.defaultQueryOptions({ queryKey })\n    return this.#queryCache.get<TInferredQueryFnData, TInferredError>(\n      options.queryHash,\n    )?.state\n  }\n\n  removeQueries<TTaggedQueryKey extends QueryKey = QueryKey>(\n    filters?: QueryFilters<TTaggedQueryKey>,\n  ): void {\n    const queryCache = this.#queryCache\n    notifyManager.batch(() => {\n      queryCache.findAll(filters).forEach((query) => {\n        queryCache.remove(query)\n      })\n    })\n  }\n\n  resetQueries<TTaggedQueryKey extends QueryKey = QueryKey>(\n    filters?: QueryFilters<TTaggedQueryKey>,\n    options?: ResetOptions,\n  ): Promise<void> {\n    const queryCache = this.#queryCache\n\n    return notifyManager.batch(() => {\n      queryCache.findAll(filters).forEach((query) => {\n        query.reset()\n      })\n      return this.refetchQueries(\n        {\n          type: 'active',\n          ...filters,\n        },\n        options,\n      )\n    })\n  }\n\n  cancelQueries<TTaggedQueryKey extends QueryKey = QueryKey>(\n    filters?: QueryFilters<TTaggedQueryKey>,\n    cancelOptions: CancelOptions = {},\n  ): Promise<void> {\n    const defaultedCancelOptions = { revert: true, ...cancelOptions }\n\n    const promises = notifyManager.batch(() =>\n      this.#queryCache\n        .findAll(filters)\n        .map((query) => query.cancel(defaultedCancelOptions)),\n    )\n\n    return Promise.all(promises).then(noop).catch(noop)\n  }\n\n  invalidateQueries<TTaggedQueryKey extends QueryKey = QueryKey>(\n    filters?: InvalidateQueryFilters<TTaggedQueryKey>,\n    options: InvalidateOptions = {},\n  ): Promise<void> {\n    return notifyManager.batch(() => {\n      this.#queryCache.findAll(filters).forEach((query) => {\n        query.invalidate()\n      })\n\n      if (filters?.refetchType === 'none') {\n        return Promise.resolve()\n      }\n      return this.refetchQueries(\n        {\n          ...filters,\n          type: filters?.refetchType ?? filters?.type ?? 'active',\n        },\n        options,\n      )\n    })\n  }\n\n  refetchQueries<TTaggedQueryKey extends QueryKey = QueryKey>(\n    filters?: RefetchQueryFilters<TTaggedQueryKey>,\n    options: RefetchOptions = {},\n  ): Promise<void> {\n    const fetchOptions = {\n      ...options,\n      cancelRefetch: options.cancelRefetch ?? true,\n    }\n    const promises = notifyManager.batch(() =>\n      this.#queryCache\n        .findAll(filters)\n        .filter((query) => !query.isDisabled() && !query.isStatic())\n        .map((query) => {\n          let promise = query.fetch(undefined, fetchOptions)\n          if (!fetchOptions.throwOnError) {\n            promise = promise.catch(noop)\n          }\n          return query.state.fetchStatus === 'paused'\n            ? Promise.resolve()\n            : promise\n        }),\n    )\n\n    return Promise.all(promises).then(noop)\n  }\n\n  fetchQuery<\n    TQueryFnData,\n    TError = DefaultError,\n    TData = TQueryFnData,\n    TQueryKey extends QueryKey = QueryKey,\n    TPageParam = never,\n  >(\n    options: FetchQueryOptions<\n      TQueryFnData,\n      TError,\n      TData,\n      TQueryKey,\n      TPageParam\n    >,\n  ): Promise<TData> {\n    const defaultedOptions = this.defaultQueryOptions(options)\n\n    // https://github.com/tannerlinsley/react-query/issues/652\n    if (defaultedOptions.retry === undefined) {\n      defaultedOptions.retry = false\n    }\n\n    const query = this.#queryCache.build(this, defaultedOptions)\n\n    return query.isStaleByTime(\n      resolveStaleTime(defaultedOptions.staleTime, query),\n    )\n      ? query.fetch(defaultedOptions)\n      : Promise.resolve(query.state.data as TData)\n  }\n\n  prefetchQuery<\n    TQueryFnData = unknown,\n    TError = DefaultError,\n    TData = TQueryFnData,\n    TQueryKey extends QueryKey = QueryKey,\n  >(\n    options: FetchQueryOptions<TQueryFnData, TError, TData, TQueryKey>,\n  ): Promise<void> {\n    return this.fetchQuery(options).then(noop).catch(noop)\n  }\n\n  fetchInfiniteQuery<\n    TQueryFnData,\n    TError = DefaultError,\n    TData = TQueryFnData,\n    TQueryKey extends QueryKey = QueryKey,\n    TPageParam = unknown,\n  >(\n    options: FetchInfiniteQueryOptions<\n      TQueryFnData,\n      TError,\n      TData,\n      TQueryKey,\n      TPageParam\n    >,\n  ): Promise<InfiniteData<TData, TPageParam>> {\n    options.behavior = infiniteQueryBehavior<\n      TQueryFnData,\n      TError,\n      TData,\n      TPageParam\n    >(options.pages)\n    return this.fetchQuery(options as any)\n  }\n\n  prefetchInfiniteQuery<\n    TQueryFnData,\n    TError = DefaultError,\n    TData = TQueryFnData,\n    TQueryKey extends QueryKey = QueryKey,\n    TPageParam = unknown,\n  >(\n    options: FetchInfiniteQueryOptions<\n      TQueryFnData,\n      TError,\n      TData,\n      TQueryKey,\n      TPageParam\n    >,\n  ): Promise<void> {\n    return this.fetchInfiniteQuery(options).then(noop).catch(noop)\n  }\n\n  ensureInfiniteQueryData<\n    TQueryFnData,\n    TError = DefaultError,\n    TData = TQueryFnData,\n    TQueryKey extends QueryKey = QueryKey,\n    TPageParam = unknown,\n  >(\n    options: EnsureInfiniteQueryDataOptions<\n      TQueryFnData,\n      TError,\n      TData,\n      TQueryKey,\n      TPageParam\n    >,\n  ): Promise<InfiniteData<TData, TPageParam>> {\n    options.behavior = infiniteQueryBehavior<\n      TQueryFnData,\n      TError,\n      TData,\n      TPageParam\n    >(options.pages)\n\n    return this.ensureQueryData(options as any)\n  }\n\n  resumePausedMutations(): Promise<unknown> {\n    if (onlineManager.isOnline()) {\n      return this.#mutationCache.resumePausedMutations()\n    }\n    return Promise.resolve()\n  }\n\n  getQueryCache(): QueryCache {\n    return this.#queryCache\n  }\n\n  getMutationCache(): MutationCache {\n    return this.#mutationCache\n  }\n\n  getDefaultOptions(): DefaultOptions {\n    return this.#defaultOptions\n  }\n\n  setDefaultOptions(options: DefaultOptions): void {\n    this.#defaultOptions = options\n  }\n\n  setQueryDefaults<\n    TQueryFnData = unknown,\n    TError = DefaultError,\n    TData = TQueryFnData,\n    TQueryData = TQueryFnData,\n  >(\n    queryKey: QueryKey,\n    options: Partial<\n      OmitKeyof<\n        QueryObserverOptions<TQueryFnData, TError, TData, TQueryData>,\n        'queryKey'\n      >\n    >,\n  ): void {\n    this.#queryDefaults.set(hashKey(queryKey), {\n      queryKey,\n      defaultOptions: options,\n    })\n  }\n\n  getQueryDefaults(\n    queryKey: QueryKey,\n  ): OmitKeyof<QueryObserverOptions<any, any, any, any, any>, 'queryKey'> {\n    const defaults = [...this.#queryDefaults.values()]\n\n    const result: OmitKeyof<\n      QueryObserverOptions<any, any, any, any, any>,\n      'queryKey'\n    > = {}\n\n    defaults.forEach((queryDefault) => {\n      if (partialMatchKey(queryKey, queryDefault.queryKey)) {\n        Object.assign(result, queryDefault.defaultOptions)\n      }\n    })\n    return result\n  }\n\n  setMutationDefaults<\n    TData = unknown,\n    TError = DefaultError,\n    TVariables = void,\n    TOnMutateResult = unknown,\n  >(\n    mutationKey: MutationKey,\n    options: OmitKeyof<\n      MutationObserverOptions<TData, TError, TVariables, TOnMutateResult>,\n      'mutationKey'\n    >,\n  ): void {\n    this.#mutationDefaults.set(hashKey(mutationKey), {\n      mutationKey,\n      defaultOptions: options,\n    })\n  }\n\n  getMutationDefaults(\n    mutationKey: MutationKey,\n  ): OmitKeyof<MutationObserverOptions<any, any, any, any>, 'mutationKey'> {\n    const defaults = [...this.#mutationDefaults.values()]\n\n    const result: OmitKeyof<\n      MutationObserverOptions<any, any, any, any>,\n      'mutationKey'\n    > = {}\n\n    defaults.forEach((queryDefault) => {\n      if (partialMatchKey(mutationKey, queryDefault.mutationKey)) {\n        Object.assign(result, queryDefault.defaultOptions)\n      }\n    })\n\n    return result\n  }\n\n  defaultQueryOptions<\n    TQueryFnData = unknown,\n    TError = DefaultError,\n    TData = TQueryFnData,\n    TQueryData = TQueryFnData,\n    TQueryKey extends QueryKey = QueryKey,\n    TPageParam = never,\n  >(\n    options:\n      | QueryObserverOptions<\n          TQueryFnData,\n          TError,\n          TData,\n          TQueryData,\n          TQueryKey,\n          TPageParam\n        >\n      | DefaultedQueryObserverOptions<\n          TQueryFnData,\n          TError,\n          TData,\n          TQueryData,\n          TQueryKey\n        >,\n  ): DefaultedQueryObserverOptions<\n    TQueryFnData,\n    TError,\n    TData,\n    TQueryData,\n    TQueryKey\n  > {\n    if (options._defaulted) {\n      return options as DefaultedQueryObserverOptions<\n        TQueryFnData,\n        TError,\n        TData,\n        TQueryData,\n        TQueryKey\n      >\n    }\n\n    const defaultedOptions = {\n      ...this.#defaultOptions.queries,\n      ...this.getQueryDefaults(options.queryKey),\n      ...options,\n      _defaulted: true,\n    }\n\n    if (!defaultedOptions.queryHash) {\n      defaultedOptions.queryHash = hashQueryKeyByOptions(\n        defaultedOptions.queryKey,\n        defaultedOptions,\n      )\n    }\n\n    // dependent default values\n    if (defaultedOptions.refetchOnReconnect === undefined) {\n      defaultedOptions.refetchOnReconnect =\n        defaultedOptions.networkMode !== 'always'\n    }\n    if (defaultedOptions.throwOnError === undefined) {\n      defaultedOptions.throwOnError = !!defaultedOptions.suspense\n    }\n\n    if (!defaultedOptions.networkMode && defaultedOptions.persister) {\n      defaultedOptions.networkMode = 'offlineFirst'\n    }\n\n    if (defaultedOptions.queryFn === skipToken) {\n      defaultedOptions.enabled = false\n    }\n\n    return defaultedOptions as DefaultedQueryObserverOptions<\n      TQueryFnData,\n      TError,\n      TData,\n      TQueryData,\n      TQueryKey\n    >\n  }\n\n  defaultMutationOptions<T extends MutationOptions<any, any, any, any>>(\n    options?: T,\n  ): T {\n    if (options?._defaulted) {\n      return options\n    }\n    return {\n      ...this.#defaultOptions.mutations,\n      ...(options?.mutationKey &&\n        this.getMutationDefaults(options.mutationKey)),\n      ...options,\n      _defaulted: true,\n    } as T\n  }\n\n  clear(): void {\n    this.#queryCache.clear()\n    this.#mutationCache.clear()\n  }\n}\n","import { WalletManager } from './WalletManager';\nimport {\n  WalletSDKConfig,\n  ConnectionResult,\n  TokenBalance,\n  ChainConfig,\n  WalletInfo,\n  ExtendedWalletInfo,\n  EventHandler\n} from '../types';\nimport { config as wagmiConfig, connectors } from '../wagmi';\n\nexport class WalletSDK {\n  private manager: WalletManager;\n  private config: WalletSDKConfig;\n  private initialized = false;\n  private useRainbowKit: boolean;\n\n  constructor(config: WalletSDKConfig = {}, useRainbowKit: boolean = true) {\n    this.config = {\n      storage: typeof window !== 'undefined' ? window.localStorage : undefined,\n      autoConnect: true,\n      ...config\n    };\n    this.useRainbowKit = useRainbowKit;\n    this.manager = new WalletManager();\n  }\n\n  async initialize(): Promise<void> {\n    if (this.initialized) {\n      console.log('🔄 Wallet SDK 已经初始化');\n      return;\n    }\n\n    console.log('🚀 初始化 Wallet SDK...', { useRainbowKit: this.useRainbowKit });\n\n    try {\n      if (this.useRainbowKit) {\n        console.log('🌈 使用 RainbowKit 连接器');\n        this.initializeRainbowKit();\n      } else {\n        console.log('🛠️ 使用自定义钱包管理器');\n        await this.manager.initialize(this.config);\n      }\n\n      this.initialized = true;\n\n      // 设置自动连接\n      if (this.config.autoConnect) {\n        await this.autoConnect();\n      }\n\n      console.log('✅ Wallet SDK 初始化完成');\n    } catch (error) {\n      console.error('❌ Wallet SDK 初始化失败:', error);\n      throw error;\n    }\n  }\n\n  private initializeRainbowKit(): void {\n    console.log('🌈 RainbowKit 连接器已初始化');\n    console.log('📋 可用连接器:', connectors.length);\n  }\n\n  // 连接管理\n  async connect(walletId?: string): Promise<ConnectionResult> {\n    if (!this.initialized) {\n      throw new Error('Wallet SDK 未初始化，请先调用 initialize()');\n    }\n\n    if (this.useRainbowKit) {\n      console.log(`🌈 RainbowKit 连接钱包: ${walletId || '默认'}`);\n      // 这里应该实现 RainbowKit 的连接逻辑\n      // 目前返回模拟结果，实际使用时需要集成 RainbowKit 的连接器\n      return {\n        success: true,\n        address: '0x1234567890123456789012345678901234567890',\n        chainId: 1,\n        wallet: {\n          id: walletId || 'rainbowkit',\n          name: walletId || 'RainbowKit Wallet',\n          installed: true,\n        }\n      };\n    }\n\n    let targetWalletId = walletId;\n\n    // 如果没有指定钱包，尝试使用上次连接的钱包\n    if (!targetWalletId) {\n      const lastWallet = this.config.storage?.getItem('lastConnectedWallet');\n      targetWalletId = lastWallet || undefined;\n    }\n\n    // 如果还是没有，获取第一个可用钱包\n    if (!targetWalletId) {\n      const availableWallets = this.getAvailableWallets();\n      if (availableWallets.length > 0) {\n        targetWalletId = availableWallets[0].id;\n      }\n    }\n\n    if (!targetWalletId) {\n      throw new Error('没有可用的钱包');\n    }\n\n    return await this.manager.connectWallet(targetWalletId);\n  }\n\n  async disconnect(): Promise<void> {\n    if (!this.initialized) return;\n\n    if (this.useRainbowKit) {\n      console.log('🌈 RainbowKit 断开连接');\n      // RainbowKit 断开逻辑\n      return;\n    }\n\n    await this.manager.disconnectWallet();\n  }\n\n  // 状态查询\n  isConnected(): boolean {\n    if (!this.initialized) return false;\n    const state = this.manager.getConnectionState();\n    return !!state.address;\n  }\n\n  getAddress(): string | null {\n    if (!this.initialized) return null;\n    const state = this.manager.getConnectionState();\n    return state.address;\n  }\n\n  getChainId(): number | null {\n    if (!this.initialized) return null;\n    const state = this.manager.getConnectionState();\n    return state.chainId;\n  }\n\n  async getBalance(): Promise<string> {\n    if (!this.initialized || !this.isConnected()) {\n      return '0';\n    }\n\n    const address = this.getAddress();\n    if (!address) return '0';\n\n    try {\n      // 这里应该使用 wagmi 或 viem 来获取余额\n      // 暂时返回占位符\n      return '0.0000';\n    } catch (error) {\n      console.error('获取余额失败:', error);\n      return '0.0000';\n    }\n  }\n\n  async getTokenBalance(tokenAddress: string): Promise<TokenBalance> {\n    if (!this.initialized || !this.isConnected()) {\n      return {\n        balance: '0',\n        decimals: 18,\n        symbol: '',\n        loading: false,\n        error: '钱包未连接'\n      };\n    }\n\n    const address = this.getAddress();\n    if (!address) {\n      return {\n        balance: '0',\n        decimals: 18,\n        symbol: '',\n        loading: false,\n        error: '钱包地址不存在'\n      };\n    }\n\n    try {\n      // 这里应该使用 wagmi 或 viem 来获取代币余额\n      // 暂时返回占位符\n      return {\n        balance: '0',\n        decimals: 18,\n        symbol: 'TOKEN',\n        loading: false,\n        error: null\n      };\n    } catch (error) {\n      console.error('获取代币余额失败:', error);\n      return {\n        balance: '0',\n        decimals: 18,\n        symbol: '',\n        loading: false,\n        error: error instanceof Error ? error.message : '获取代币余额失败'\n      };\n    }\n  }\n\n  // 钱包管理\n  getAvailableWallets(): ExtendedWalletInfo[] {\n    if (!this.initialized) return [];\n\n    if (this.useRainbowKit) {\n      // 返回 RainbowKit 支持的钱包\n      return [\n        { id: 'metamask', name: 'MetaMask', installed: true, iconUrl: '' },\n        { id: 'okx', name: 'OKX Wallet', installed: true, iconUrl: '' },\n        { id: 'coinbase', name: 'Coinbase Wallet', installed: true, iconUrl: '' },\n        { id: 'trust', name: 'Trust Wallet', installed: true, iconUrl: '' },\n        { id: 'walletconnect', name: 'WalletConnect', installed: true, iconUrl: '' },\n        { id: 'imtoken', name: 'imToken', installed: true, iconUrl: '' },\n        { id: 'safe', name: 'Safe', installed: true, iconUrl: '' },\n      ];\n    }\n\n    return this.manager.getAvailableWallets();\n  }\n\n  async switchChain(chainId: number): Promise<void> {\n    if (!this.initialized || !this.isConnected()) {\n      throw new Error('钱包未连接');\n    }\n\n    try {\n      // 这里应该实现链切换逻辑\n      console.log(`切换到链: ${chainId}`);\n    } catch (error) {\n      console.error('切换链失败:', error);\n      throw error;\n    }\n  }\n\n  // 事件管理\n  on(event: string, handler: EventHandler): void {\n    if (this.useRainbowKit) {\n      // RainbowKit 事件管理\n      console.log(`🌈 RainbowKit 事件监听: ${event}`);\n      return;\n    }\n    this.manager.on(event, handler);\n  }\n\n  off(event: string, handler: EventHandler): void {\n    if (this.useRainbowKit) {\n      // RainbowKit 事件管理\n      console.log(`🌈 RainbowKit 移除事件监听: ${event}`);\n      return;\n    }\n    this.manager.off(event, handler);\n  }\n\n  // 私有方法\n  private async autoConnect(): Promise<void> {\n    if (this.useRainbowKit) {\n      console.log('🌈 RainbowKit 自动连接逻辑');\n      return;\n    }\n\n    try {\n      const lastWallet = this.config.storage?.getItem('lastConnectedWallet');\n      const address = this.config.storage?.getItem('walletAddress');\n\n      if (lastWallet && address) {\n        console.log('🔄 尝试自动连接...');\n        await this.connect(lastWallet);\n      }\n    } catch (error) {\n      console.warn('自动连接失败:', error);\n      // 清理可能损坏的存储\n      this.config.storage?.removeItem('lastConnectedWallet');\n      this.config.storage?.removeItem('walletAddress');\n      this.config.storage?.removeItem('walletChainId');\n    }\n  }\n\n  // 获取配置信息\n  getConfig(): WalletSDKConfig {\n    return { ...this.config };\n  }\n\n  // 检查是否初始化\n  isInitialized(): boolean {\n    return this.initialized;\n  }\n\n  // 获取 Wagmi 配置（用于 RainbowKit 集成）\n  getWagmiConfig() {\n    if (!this.useRainbowKit) {\n      throw new Error('RainbowKit 未启用');\n    }\n    return wagmiConfig;\n  }\n\n  // 获取连接器（用于 RainbowKit 集成）\n  getConnectors() {\n    if (!this.useRainbowKit) {\n      throw new Error('RainbowKit 未启用');\n    }\n    return connectors;\n  }\n\n  // 调试方法\n  redetectWallets(): void {\n    if (!this.useRainbowKit) {\n      this.manager.redetectWallets();\n    }\n  }\n\n  getDetectionDetails(): any {\n    if (!this.useRainbowKit) {\n      return this.manager.getDetectionDetails();\n    }\n    return { useRainbowKit: true };\n  }\n}","\"use client\";\n\nimport React, {\n  createContext,\n  useContext,\n  useEffect,\n  useState,\n  useCallback,\n} from 'react';\nimport { WalletManager } from '../core/WalletManager';\nimport { WalletDeduplicator } from '../utils/WalletDeduplicator';\nimport WalletModal from './WalletModal';\nimport {\n  WalletContextValue,\n  WalletState,\n  ConnectionResult,\n  TokenBalance,\n  WalletSDKConfig,\n  ExtendedWalletInfo,\n  DetectedWallet,\n  WalletProviderProps,\n  ChainInfo,\n  WalletGroup,\n  EthereumProvider,\n  WalletCreateConfig,\n  WalletConnectionResult,\n} from '../types';\nimport { Address, formatEther, formatUnits } from 'viem';\n\nconst WalletContext = createContext<WalletContextValue>({\n  address: \"0x\" as Address,\n  chainId: null,\n  chainID: null,\n  isConnecting: false,\n  isConnected: false,\n  isDisconnected: true,\n  isReconnecting: false,\n  ensName: null,\n  error: null,\n  chains: [],\n  provider: undefined,\n  balance: \"0.0000\",\n  wallet: undefined,\n  signer: undefined,\n  connect: async () => ({ success: false, error: '未初始化' }),\n  disconnect: async () => {},\n  switchChain: async () => {},\n  openModal: () => {},\n  closeModal: () => {},\n  walletInstances: {},\n  detectedWallets: [],\n  walletsLoading: true,\n  fetchBalance: async () => {},\n  balanceLoading: false,\n  getTokenBalance: async () => ({\n    balance: '0',\n    decimals: 18,\n    symbol: '',\n    loading: false,\n    error: '钱包未连接',\n  }),\n});\n\nexport const WalletProvider: React.FC<WalletProviderProps> = ({\n  children,\n  config,\n  chains,\n  provider,\n  autoConnect,\n  wallets\n}) => {\n  const [walletManager, setWalletManager] = useState<WalletManager | null>(null);\n  const [state, setState] = useState<WalletState>({\n    address: \"0x\" as Address,\n    chainId: null,\n    chainID: null,\n    isConnecting: false,\n    isConnected: false,\n    isDisconnected: true,\n    isReconnecting: false,\n    ensName: null,\n    error: null,\n    chains: chains || config.chains || [],\n    provider: provider || config.provider,\n    balance: \"0.0000\",\n    wallet: undefined,\n    signer: undefined,\n  });\n\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [detectedWallets, setDetectedWallets] = useState<DetectedWallet[]>([]);\n  const [walletsLoading, setWalletsLoading] = useState(true);\n  const [walletInstances, setWalletInstances] = useState<{\n    [groupName: string]: ExtendedWalletInfo[];\n  }>({});\n  const [currentWalletId, setCurrentWalletId] = useState(\"\");\n  const [autoConnectAttempted, setAutoConnectAttempted] = useState(false);\n  const [balanceLoading, setBalanceLoading] = useState(false);\n\n  // 创建 tokenBalanceCache 来缓存代币余额信息\n  const [tokenBalanceCache, setTokenBalanceCache] = useState<{\n    [tokenAddress: string]: {\n      balance: string;\n      decimals: number;\n      symbol: string;\n      lastUpdated: number;\n    };\n  }>({});\n\n  // 初始化钱包管理器\n  useEffect(() => {\n    const initializeWalletManager = async () => {\n      try {\n                const manager = new WalletManager();\n\n        // 使用传入的配置或默认配置\n        const walletConfig = {\n          projectId: config.projectId,\n          chains: chains || config.chains || [],\n          storage: config.storage || (typeof window !== 'undefined' ? window.localStorage : undefined),\n          ...config\n        };\n\n        manager.initialize();\n        const detectedWallets = manager.getWallets();\n        setWalletManager(manager);\n\n        // 设置事件监听\n        manager.on('connect', (data) => {\n          console.log(\"🔍 WalletProvider - 收到连接事件:\", data);\n          setState(prev => ({\n            ...prev,\n            isConnected: true,\n            isConnecting: false,\n            isDisconnected: false,\n            address: data.address as Address,\n            chainId: data.chainId,\n            chainID: data.chainId?.toString() || null,\n            provider: data.provider,\n            wallet: data.wallet ? {\n              id: data.wallet.id || data.walletId,\n              name: data.wallet.name || 'Unknown',\n              installed: true\n            } : undefined,\n            error: null,\n          }));\n          setCurrentWalletId(data.walletId);\n\n          // 连接成功后可以选择性关闭 modal\n          // setIsModalOpen(false);\n        });\n\n        manager.on('disconnect', () => {\n          setState(prev => ({\n            ...prev,\n            isConnected: false,\n            isDisconnected: true,\n            isConnecting: false,\n            address: \"0x\" as Address,\n            chainId: null,\n            chainID: null,\n            provider: undefined,\n            wallet: undefined,\n            balance: \"0.0000\",\n            signer: undefined,\n            error: null,\n          }));\n          setCurrentWalletId(\"\");\n        });\n\n        manager.on('chainChanged', (data) => {\n          setState(prev => ({\n            ...prev,\n            chainId: data.chainId,\n            chainID: data.chainId?.toString() || null,\n          }));\n        });\n\n        manager.on('accountChanged', (data) => {\n          setState(prev => ({\n            ...prev,\n            address: (data.accounts[0] || \"0x\") as Address,\n          }));\n        });\n\n        manager.on('error', (data) => {\n          console.error(\"❌ 钱包错误事件:\", data);\n          setState(prev => ({\n            ...prev,\n            error: new Error(data.error),\n            isConnecting: false,\n          }));\n        });\n\n              } catch (error) {\n        console.error('初始化 WalletManager 失败:', error);\n        setState(prev => ({\n          ...prev,\n          error: error instanceof Error ? error : new Error('初始化失败'),\n        }));\n      }\n    };\n\n    initializeWalletManager();\n\n    return () => {\n      // 清理事件监听\n      if (walletManager) {\n        walletManager.off('connect', () => {});\n        walletManager.off('disconnect', () => {});\n        walletManager.off('chainChanged', () => {});\n        walletManager.off('accountChanged', () => {});\n        walletManager.off('error', () => {});\n      }\n    };\n  }, [config, chains, provider]);\n\n  // 初始化钱包检测\n  useEffect(() => {\n    const initWallets = async () => {\n      if (!walletManager) return;\n\n      try {\n        setWalletsLoading(true);\n\n        // 检测可用钱包\n        const detectedWallets = walletManager.getWallets();\n\n        // 构建配置的钱包实例\n        const configuredInstances: { [groupName: string]: ExtendedWalletInfo[] } = {};\n        if (wallets && config.projectId) {\n          wallets.forEach((group) => {\n            if (group.groupName && group.wallets) {\n              const groupWallets = group.wallets.map((createWalletFn) => {\n                return createWalletFn({\n                  projectId: config.projectId!,\n                  appName: config.appName,\n                });\n              });\n              if (groupWallets.length > 0) {\n                configuredInstances[group.groupName] = groupWallets;\n              }\n            }\n          });\n        }\n\n        // 使用去重器处理钱包\n        console.log(\"🔍 开始处理钱包:\", {\n          detectedWallets,\n          detectedWalletsLength: detectedWallets?.length || 0,\n          configuredInstances\n        });\n\n        let filteredDetected: DetectedWallet[] = [];\n        let staticFiltered: { [groupName: string]: ExtendedWalletInfo[] } = {};\n\n        try {\n          const result = WalletDeduplicator.deduplicate(\n            detectedWallets,\n            configuredInstances\n          );\n          filteredDetected = result.filtered;\n          staticFiltered = result.staticFiltered;\n          console.log(\"✅ 钱包去重成功:\", { result });\n        } catch (error) {\n          console.error(\"❌ 钱包去重失败:\", error);\n          // 如果去重失败，使用原始数据\n          filteredDetected = Array.isArray(detectedWallets) ? detectedWallets : [];\n          staticFiltered = configuredInstances || {};\n        }\n\n        \n        setDetectedWallets(filteredDetected);\n\n        // 构建最终的钱包实例\n        const finalInstances: { [groupName: string]: ExtendedWalletInfo[] } = {};\n\n        // 添加检测到的钱包\n        if (filteredDetected.length > 0) {\n          const detectedAsExtended: ExtendedWalletInfo[] = filteredDetected.map(wallet => ({\n            id: wallet.id,\n            name: wallet.name,\n            installed: wallet.installed,\n            provider: wallet.provider,\n            iconUrl: wallet.icon,\n            icon: wallet.icon,\n            rdns: wallet.rdns,\n            type: wallet.type,\n          }));\n          finalInstances[\"已安装的钱包\"] = detectedAsExtended;\n        }\n\n        // 添加过滤后的配置钱包组\n        Object.entries(staticFiltered).forEach(([groupName, walletsInGroup]) => {\n          if (walletsInGroup.length > 0) {\n            finalInstances[groupName] = walletsInGroup;\n          }\n        });\n\n        setWalletInstances(finalInstances);\n      } catch (error) {\n        console.error(\"❌ 钱包检测失败:\", error);\n        setState(prev => ({\n          ...prev,\n          error: error instanceof Error ? error : new Error(\"钱包检测失败\"),\n        }));\n      } finally {\n        setWalletsLoading(false);\n      }\n    };\n\n    initWallets();\n  }, [walletManager, wallets, config.projectId, config.appName]);\n\n  // 连接钱包\n  const connect = useCallback(async (walletId: string): Promise<ConnectionResult> => {\n    if (!walletManager) {\n      console.error('❌ WalletProvider - WalletManager 未初始化');\n      return {\n        success: false,\n        error: 'WalletManager 未初始化',\n      };\n    }\n\n    \n    setState(prev => ({\n      ...prev,\n      isConnecting: true,\n      isDisconnected: false,\n      error: null\n    }));\n\n    try {\n      console.log(\"🔍 WalletProvider - 开始连接钱包:\", walletId);\n      const result = await walletManager.connectWallet(walletId);\n\n      console.log(\"🔍 WalletProvider - 钱包连接成功:\", result);\n\n      // 注意：不要在这里关闭 modal，让用户确认或者让 WalletModal 处理\n      // setIsModalOpen(false);\n\n      // 保存连接状态\n      if (typeof window !== 'undefined' && config.storage) {\n        config.storage.setItem('lastConnectedWallet', walletId);\n        config.storage.setItem('walletAddress', result.address || '');\n        config.storage.setItem('lastConnectionTime', Date.now().toString());\n      }\n\n      return {\n        success: true,\n        address: result.address,\n        chainId: result.chainId,\n        chainID: result.chainId?.toString() || null,\n        wallet: result.wallet,\n        provider: result.provider,\n      };\n    } catch (error) {\n      const errorMessage = error instanceof Error ? error.message : '连接失败';\n      console.error(\"❌ WalletProvider - 钱包连接失败:\", error);\n\n      setState(prev => ({\n        ...prev,\n        isConnecting: false,\n        isDisconnected: true,\n        error: new Error(errorMessage),\n      }));\n\n      return {\n        success: false,\n        error: errorMessage,\n      };\n    }\n  }, [walletManager, config.storage]);\n\n  // 断开连接\n  const disconnect = useCallback(async (): Promise<void> => {\n\n    try {\n      // 调用 walletManager 的断开连接方法\n      if (walletManager) {\n        await walletManager.disconnectWallet(currentWalletId);\n      }\n    } catch (error) {\n      console.warn(\"⚠️ 断开钱包连接器时出错:\", error);\n      // 不抛出错误，因为断开连接失败不应该阻止清理流程\n    }\n\n    // 清理本地存储\n    if (typeof window !== 'undefined' && config.storage) {\n      config.storage.removeItem('lastConnectedWallet');\n      config.storage.removeItem('walletAddress');\n      config.storage.removeItem('lastConnectionTime');\n    }\n\n    // 重置状态\n    setState(prev => ({\n      ...prev,\n      isConnected: false,\n      isDisconnected: true,\n      address: \"0x\" as Address,\n      chainId: null,\n      chainID: null,\n      provider: undefined,\n      wallet: undefined,\n      signer: undefined,\n      balance: \"0.0000\",\n      isConnecting: false,\n      error: null,\n    }));\n\n    // 重置当前钱包ID\n    setCurrentWalletId(\"\");\n\n    // 清理代币余额缓存\n    setTokenBalanceCache({});\n\n  }, [walletManager, currentWalletId, config.storage]);\n\n  // 切换链\n  const switchChain = useCallback(async (chainId: number): Promise<void> => {\n    if (!walletManager) throw new Error('WalletManager 未初始化');\n\n    try {\n\n      // 获取当前连接的钱包\n      const currentWallet = walletManager.getWalletById(currentWalletId);\n      if (!currentWallet) {\n        throw new Error('未找到当前连接的钱包');\n      }\n\n      const provider = currentWallet.provider;\n\n      // 将 chainId 转换为十六进制\n      const chainIdHex = `0x${chainId.toString(16)}`;\n\n      try {\n        // 尝试切换到指定链\n        await provider.request({\n          method: 'wallet_switchEthereumChain',\n          params: [{ chainId: chainIdHex }],\n        });\n\n\n        // 更新状态\n        setState(prev => ({\n          ...prev,\n          chainId,\n          chainID: chainId.toString()\n        }));\n\n        // 触发链变化事件\n        if (walletManager) {\n          (walletManager as any).emit?.('chainChanged', { chainId });\n        }\n\n      } catch (switchError: any) {\n        // 如果链不存在，可能需要添加链\n        if (switchError.code === 4902) {\n\n          // 获取链配置\n          const chainConfig = getChainConfig(chainId);\n          if (chainConfig) {\n            await provider.request({\n              method: 'wallet_addEthereumChain',\n              params: [chainConfig],\n            });\n\n            setState(prev => ({\n              ...prev,\n              chainId,\n              chainID: chainId.toString()\n            }));\n          } else {\n            throw new Error(`不支持的链 ID: ${chainId}`);\n          }\n        } else {\n          throw switchError;\n        }\n      }\n\n    } catch (error) {\n      console.error('切换链失败:', error);\n      throw error;\n    }\n  }, [walletManager, currentWalletId]);\n\n  // 获取链配置\n  const getChainConfig = (chainId: number) => {\n    const chainConfigs: Record<number, any> = {\n      1: {\n        chainId: '0x1',\n        chainName: 'Ethereum Mainnet',\n        nativeCurrency: {\n          name: 'Ether',\n          symbol: 'ETH',\n          decimals: 18,\n        },\n        rpcUrls: ['https://mainnet.infura.io/v3/YOUR_INFURA_KEY'],\n        blockExplorerUrls: ['https://etherscan.io'],\n      },\n      11155111: {\n        chainId: '0xaa36a7',\n        chainName: 'Sepolia test network',\n        nativeCurrency: {\n          name: 'Sepolia Ether',\n          symbol: 'SepoliaETH',\n          decimals: 18,\n        },\n        rpcUrls: ['https://sepolia.infura.io/v3/YOUR_INFURA_KEY'],\n        blockExplorerUrls: ['https://sepolia.etherscan.io'],\n      },\n      137: {\n        chainId: '0x89',\n        chainName: 'Polygon Mainnet',\n        nativeCurrency: {\n          name: 'MATIC',\n          symbol: 'MATIC',\n          decimals: 18,\n        },\n        rpcUrls: ['https://polygon-rpc.com'],\n        blockExplorerUrls: ['https://polygonscan.com'],\n      },\n      56: {\n        chainId: '0x38',\n        chainName: 'BNB Smart Chain',\n        nativeCurrency: {\n          name: 'BNB',\n          symbol: 'BNB',\n          decimals: 18,\n        },\n        rpcUrls: ['https://bsc-dataseed.binance.org'],\n        blockExplorerUrls: ['https://bscscan.com'],\n      },\n    };\n\n    return chainConfigs[chainId];\n  };\n\n  // 获取余额\n  const fetchBalance = useCallback(async (): Promise<void> => {\n    if (!state.isConnected || !state.address) {\n      return;\n    }\n\n    try {\n      setBalanceLoading(true);\n\n      // 获取当前连接的钱包\n      const currentWallet = walletManager?.getWalletById(currentWalletId);\n      if (!currentWallet) {\n        console.warn(\"⚠️ 未找到当前连接的钱包\", {\n          currentWalletId,\n          availableWallets: walletManager?.getWallets().map(w => w.id)\n        });\n        return;\n      }\n\n      const provider = currentWallet.provider;\n\n      // 使用 eth_getBalance 获取余额\n      const balanceHex = await provider.request({\n        method: 'eth_getBalance',\n        params: [state.address, 'latest'],\n      });\n\n\n      if (typeof balanceHex === 'string') {\n        // 将十六进制余额转换为 ETH\n        const balanceWei = BigInt(balanceHex);\n        const balanceEth = formatEther(balanceWei);\n        const formattedBalance = parseFloat(balanceEth).toFixed(4);\n\n          \n        setState(prev => ({\n          ...prev,\n          balance: formattedBalance,\n        }));\n\n      } else {\n        console.error(\"❌ 余额响应类型错误:\", typeof balanceHex, balanceHex);\n      }\n    } catch (error) {\n      console.error('❌ 获取余额失败:', error);\n      console.error('🔍 错误详情:', {\n        message: error instanceof Error ? error.message : '未知错误',\n        stack: error instanceof Error ? error.stack : undefined,\n        walletId: currentWalletId,\n        address: state.address,\n        chainId: state.chainId\n      });\n      setState(prev => ({\n        ...prev,\n        balance: \"0.0000\",\n      }));\n    } finally {\n      setBalanceLoading(false);\n    }\n  }, [state.isConnected, state.address, state.chainId, walletManager, currentWalletId]);\n\n  // 自动获取余额\n  useEffect(() => {\n    if (state.isConnected && state.address) {\n      fetchBalance();\n\n      // 设置定时刷新余额 (30秒)\n      const interval = setInterval(fetchBalance, 30000);\n      return () => clearInterval(interval);\n    }\n  }, [state.isConnected, state.address, fetchBalance]);\n\n  // 获取代币余额的方法\n  const getTokenBalance = useCallback(\n    async (tokenAddress: Address): Promise<TokenBalance> => {\n      // 默认返回值\n      const defaultResult = {\n        balance: \"0\",\n        decimals: 18,\n        symbol: \"\",\n        loading: false,\n        error: null as string | null,\n      };\n\n      // 如果钱包未连接或地址为空，返回默认值\n      if (!state.isConnected || !state.address) {\n        return { ...defaultResult, error: \"钱包未连接\" };\n      }\n\n      const currentWallet = walletManager?.getWalletById(currentWalletId);\n      if (!currentWallet) {\n        return { ...defaultResult, error: \"未找到当前连接的钱包\" };\n      }\n\n      try {\n        // 设置加载状态\n        const loadingResult = { ...defaultResult, loading: true };\n\n        // 检查缓存\n        const cacheKey = `${tokenAddress.toLowerCase()}-${state.address.toLowerCase()}`;\n        const cachedData = tokenBalanceCache[cacheKey];\n        const now = Date.now();\n\n        // 如果缓存存在且未过期（30秒内），直接使用缓存\n        if (cachedData && now - cachedData.lastUpdated < 30000) {\n          return {\n            balance: cachedData.balance,\n            decimals: cachedData.decimals,\n            symbol: cachedData.symbol,\n            loading: false,\n            error: null,\n          };\n        }\n\n        const provider = currentWallet.provider;\n\n        // ERC-20 合约的函数选择器\n        const balanceOfSelector = '0x70a08231'; // balanceOf(address)\n        const decimalsSelector = '0x313ce567'; // decimals()\n        const symbolSelector = '0x95d89b41'; // symbol()\n\n        // 编码地址参数 (去掉0x前缀，补齐到64位)\n        const encodedAddress = state.address.slice(2).padStart(64, '0');\n\n        // 并行调用合约方法\n        const [balanceResult, decimalsResult, symbolResult] = await Promise.all([\n          // 获取余额\n          provider.request({\n            method: 'eth_call',\n            params: [\n              {\n                to: tokenAddress,\n                data: balanceOfSelector + encodedAddress,\n              },\n              'latest',\n            ],\n          }),\n          // 获取小数位数\n          provider.request({\n            method: 'eth_call',\n            params: [\n              {\n                to: tokenAddress,\n                data: decimalsSelector,\n              },\n              'latest',\n            ],\n          }),\n          // 获取代币符号\n          provider.request({\n            method: 'eth_call',\n            params: [\n              {\n                to: tokenAddress,\n                data: symbolSelector,\n              },\n              'latest',\n            ],\n          }),\n        ]);\n\n        // 解析结果\n        const decimals = parseInt(decimalsResult as string, 16);\n        const balanceWei = BigInt(balanceResult as string);\n        const balance = formatUnits(balanceWei, decimals);\n\n        // 解析符号 (去掉前面的0x和填充，然后转换为字符串)\n        let symbol = '';\n        if (symbolResult && typeof symbolResult === 'string') {\n          const symbolHex = (symbolResult as string).slice(2);\n          // 转换十六进制到字符串\n          let symbolStr = '';\n          for (let i = 0; i < symbolHex.length; i += 2) {\n            const charCode = parseInt(symbolHex.substr(i, 2), 16);\n            if (charCode !== 0) {\n              symbolStr += String.fromCharCode(charCode);\n            }\n          }\n          symbol = symbolStr.trim();\n        }\n\n        // 更新缓存\n        setTokenBalanceCache((prev) => ({\n          ...prev,\n          [cacheKey]: {\n            balance,\n            decimals,\n            symbol: symbol || 'TOKEN',\n            lastUpdated: now,\n          },\n        }));\n\n        // 返回结果\n        return {\n          balance,\n          decimals,\n          symbol: symbol || 'TOKEN',\n          loading: false,\n          error: null,\n        };\n      } catch (error) {\n        console.error(`获取代币 ${tokenAddress} 余额失败:`, error);\n        return {\n          ...defaultResult,\n          error: error instanceof Error ? error.message : \"获取代币余额失败\",\n        };\n      }\n    },\n    [state.isConnected, state.address, walletManager, currentWalletId, tokenBalanceCache]\n  );\n\n  // 自动连接逻辑\n  useEffect(() => {\n    const attemptAutoConnect = async () => {\n      if (autoConnectAttempted || !autoConnect || !walletManager || walletsLoading) {\n        return;\n      }\n\n      if (state.isConnected) {\n        setAutoConnectAttempted(true);\n        return;\n      }\n\n      const lastConnectedWallet = typeof window !== 'undefined' && config.storage\n        ? config.storage.getItem('lastConnectedWallet')\n        : null;\n\n      if (!lastConnectedWallet) {\n        setAutoConnectAttempted(true);\n        return;\n      }\n\n\n      try {\n        // 检查该钱包是否还存在\n        const availableWallets = walletManager.getAvailableWallets();\n        const walletExists = availableWallets.some(wallet => wallet.id === lastConnectedWallet);\n\n        if (walletExists) {\n          await connect(lastConnectedWallet);\n        } else {\n          if (typeof window !== 'undefined' && config.storage) {\n            config.storage.removeItem('lastConnectedWallet');\n            config.storage.removeItem('walletAddress');\n            config.storage.removeItem('lastConnectionTime');\n          }\n        }\n      } catch (error) {\n        console.warn(\"自动连接失败:\", error);\n        if (typeof window !== 'undefined' && config.storage) {\n          config.storage.removeItem('lastConnectedWallet');\n          config.storage.removeItem('walletAddress');\n          config.storage.removeItem('lastConnectionTime');\n        }\n      } finally {\n        setAutoConnectAttempted(true);\n      }\n    };\n\n    attemptAutoConnect();\n  }, [\n    autoConnect,\n    autoConnectAttempted,\n    walletManager,\n    walletsLoading,\n    state.isConnected,\n    config.storage,\n    connect\n  ]);\n\n  // 模态框控制\n  const openModal = useCallback(() => {\n    console.log(\"🔍 WalletProvider - openModal 被调用，当前状态:\", isModalOpen);\n    setIsModalOpen(true);\n  }, [isModalOpen]);\n\n  const closeModal = useCallback(() => {\n    console.log(\"🔍 WalletProvider - closeModal 被调用，当前状态:\", isModalOpen);\n    setIsModalOpen(false);\n  }, [isModalOpen]);\n\n  const value: WalletContextValue = {\n    ...state,\n    connect,\n    disconnect,\n    switchChain,\n    openModal,\n    closeModal,\n    walletInstances,\n    detectedWallets,\n    walletsLoading,\n    fetchBalance,\n    balanceLoading,\n    getTokenBalance,\n  };\n\n  console.log(\"🔍 WalletProvider - 渲染，modal 状态:\", isModalOpen);\n\n  return (\n    <WalletContext.Provider value={value}>\n      {children}\n      <WalletModal\n        isOpen={isModalOpen}\n        onClose={closeModal}\n        onConnect={connect}\n        title=\"连接钱包\"\n        description=\"请选择要连接的钱包\"\n        walletInstances={walletInstances}\n        detectedWallets={detectedWallets}\n        walletsLoading={walletsLoading}\n      />\n    </WalletContext.Provider>\n  );\n};\n\nexport const useWallet = (): WalletContextValue => {\n  const context = useContext(WalletContext);\n  if (!context) {\n    throw new Error('useWallet must be used within a WalletProvider');\n  }\n  return context;\n};","import { DetectedWallet, ExtendedWalletInfo } from '../types';\n\nexport interface DeduplicationResult {\n  filtered: DetectedWallet[];\n  staticFiltered: { [groupName: string]: ExtendedWalletInfo[] };\n}\n\nexport class WalletDeduplicator {\n  /**\n   * 钱包去重函数\n   * @param detected 检测到的钱包列表\n   * @param configuredWallets 配置的钱包组\n   * @returns 去重后的结果\n   */\n  static deduplicate(\n    detected: DetectedWallet[] | undefined,\n    configuredWallets: { [groupName: string]: ExtendedWalletInfo[] } | undefined\n  ): DeduplicationResult {\n\n    // 确保 detected 和 configuredWallets 是有效的\n    const safeDetected = Array.isArray(detected) ? detected : [];\n    const safeConfigured = configuredWallets || {};\n\n    console.log(\"🔍 WalletDeduplicator 输入:\", {\n      detected: safeDetected,\n      detectedLength: safeDetected.length,\n      configuredGroups: Object.keys(safeConfigured)\n    });\n\n    // 创建排序后的检测钱包列表和映射表\n    const sortedDetected = [...safeDetected].sort((a, b) => a.name.localeCompare(b.name));\n    const nameMap = new Map<string, DetectedWallet>();\n    const rdnsMap = new Map<string, DetectedWallet>();\n\n    console.log(\"🔍 排序后的钱包:\", {\n      sortedDetected,\n      sortedLength: sortedDetected.length\n    });\n\n    // 去重检测到的钱包\n    const filteredDetected = this.deduplicateDetectedWallets(\n      sortedDetected,\n      nameMap,\n      rdnsMap\n    );\n\n    // 过滤配置的钱包\n    const staticFiltered = this.filterConfiguredWallets(\n      safeConfigured,\n      filteredDetected\n    );\n\n    console.log(\"🔍 去重结果:\", {\n      filteredDetected,\n      filteredLength: filteredDetected.length,\n      staticFiltered\n    });\n\n    return {\n      filtered: filteredDetected,\n      staticFiltered,\n    };\n  }\n\n  private static deduplicateDetectedWallets(\n    sortedDetected: DetectedWallet[],\n    nameMap: Map<string, DetectedWallet>,\n    rdnsMap: Map<string, DetectedWallet>\n  ): DetectedWallet[] {\n    const filteredDetected: DetectedWallet[] = [];\n\n    console.log(\"🔍 开始去重检测到的钱包:\", {\n      input: sortedDetected,\n      inputLength: sortedDetected?.length || 0\n    });\n\n    // 确保 sortedDetected 是数组且不为空\n    if (!Array.isArray(sortedDetected)) {\n      console.error(\"❌ sortedDetected 不是数组:\", sortedDetected);\n      return filteredDetected;\n    }\n\n    if (sortedDetected.length === 0) {\n      console.log(\"📝 sortedDetected 为空数组，返回空结果\");\n      return filteredDetected;\n    }\n\n    for (const wallet of sortedDetected) {\n      if (!wallet || typeof wallet !== 'object') {\n        console.warn(\"⚠️ 钱包对象无效:\", wallet);\n        continue;\n      }\n\n      if (!wallet.name) {\n        console.warn(\"⚠️ 钱包名称为空:\", wallet);\n        continue;\n      }\n\n      const normalizedName = wallet.name.toLowerCase().trim();\n      const existingByName = nameMap.get(normalizedName);\n      const existingByRdns = wallet.rdns ? rdnsMap.get(wallet.rdns) : undefined;\n\n      if (!existingByName && !existingByRdns) {\n        // 没有重复，添加到结果中\n        filteredDetected.push(wallet);\n        nameMap.set(normalizedName, wallet);\n        if (wallet.rdns) {\n          rdnsMap.set(wallet.rdns, wallet);\n        }\n        console.log(\"✅ 添加钱包:\", wallet.name);\n      } else {\n        console.log(\"🔄 跳过重复钱包:\", wallet.name, {\n          existingByName: existingByName?.name,\n          existingByRdns: existingByRdns?.name\n        });\n      }\n    }\n\n    console.log(\"🔍 去重完成:\", {\n      result: filteredDetected,\n      resultLength: filteredDetected.length\n    });\n\n    return filteredDetected;\n  }\n\n  private static filterConfiguredWallets(\n    configuredWallets: { [groupName: string]: ExtendedWalletInfo[] },\n    filteredDetected: DetectedWallet[]\n  ): { [groupName: string]: ExtendedWalletInfo[] } {\n    const staticFiltered: { [groupName: string]: ExtendedWalletInfo[] } = {};\n\n    Object.entries(configuredWallets).forEach(([groupName, wallets]) => {\n      const filtered = wallets.filter(wallet => {\n        const existsInDetected = filteredDetected.some(detected =>\n          detected.name.toLowerCase().trim() === wallet.name.toLowerCase().trim() ||\n          detected.rdns === wallet.rdns\n        );\n        return !existsInDetected;\n      });\n\n      if (filtered.length > 0) {\n        staticFiltered[groupName] = filtered;\n      }\n    });\n\n    return staticFiltered;\n  }\n}","\"use client\";\n\nimport React, { useState } from 'react';\nimport { WalletModalProps, ExtendedWalletInfo, DetectedWallet } from '../types';\n\nconst WalletModal: React.FC<WalletModalProps> = ({\n  isOpen,\n  onClose,\n  onConnect,\n  title = '连接钱包',\n  description = '请选择要连接的钱包',\n  theme = 'light',\n  walletInstances = {},\n  detectedWallets = [],\n  walletsLoading = false,\n}) => {\n  const [connectingWallet, setConnectingWallet] = useState<string | null>(null);\n  const [isGridLayout, setIsGridLayout] = useState(true);\n\n  console.log(\"🔍 WalletModal 渲染:\", {\n    isOpen,\n    walletInstances,\n    detectedWallets,\n    walletsLoading\n  });\n\n  // 合并所有可用的钱包（WalletProvider已经处理了去重）\n  const allWallets: ExtendedWalletInfo[] = [];\n\n  // 添加配置的钱包实例（这些已经经过去重处理）\n  Object.entries(walletInstances).forEach(([groupName, walletGroup]) => {\n    allWallets.push(...walletGroup);\n  });\n\n  // 显示所有钱包（包括未安装的）\n  const allWalletsForDisplay = allWallets.length > 0 ? allWallets : [\n    {\n      id: 'metamask',\n      name: 'MetaMask',\n      installed: false,\n      icon: 'https://upload.wikimedia.org/wikipedia/commons/3/36/MetaMask_Fox.svg',\n      iconUrl: 'https://upload.wikimedia.org/wikipedia/commons/3/36/MetaMask_Fox.svg',\n      rdns: 'io.metamask',\n      type: 'injected' as const,\n      provider: undefined\n    }\n  ];\n\n  console.log(\"🔍 WalletModal 钱包统计:\", {\n    allWalletsCount: allWallets.length,\n    displayWalletsCount: allWalletsForDisplay.length\n  });\n\n  const handleWalletSelect = async (walletId: string) => {\n    console.log(\"🔍 WalletModal - 用户选择钱包:\", walletId);\n\n    // 查找选中的钱包信息\n    const selectedWallet = allWalletsForDisplay.find(wallet => wallet.id === walletId);\n\n    if (!selectedWallet) {\n      console.error('❌ 未找到选中的钱包:', walletId);\n      return;\n    }\n\n    // 如果钱包未安装，显示提示\n    if (!selectedWallet.installed) {\n      console.log('💡 钱包未安装，提示用户:', selectedWallet.name);\n      // 这里可以添加安装提示逻辑\n      alert(`请先安装 ${selectedWallet.name} 钱包扩展程序`);\n      return;\n    }\n\n    setConnectingWallet(walletId);\n\n    try {\n      console.log(\"🔍 WalletModal - 开始连接钱包...\");\n      const result = await onConnect(walletId);\n\n      console.log(\"🔍 WalletModal - 连接结果:\", result);\n\n      // 连接成功后关闭弹窗\n      if (result.success) {\n        console.log(\"🔍 WalletModal - 连接成功，关闭弹窗\");\n        onClose();\n      } else {\n        console.log(\"🔍 WalletModal - 连接失败，保持弹窗打开让用户重试\");\n        // 连接失败时不关闭弹窗，让用户可以重试\n      }\n    } catch (error) {\n      console.error('❌ 连接钱包过程中发生错误:', error);\n      // 发生错误时不关闭弹窗，让用户可以重试\n    } finally {\n      setConnectingWallet(null);\n    }\n  };\n\n  if (!isOpen) return null;\n\n  const themeClasses = {\n    light: {\n      background: 'bg-white',\n      border: 'border-gray-200',\n      text: 'text-gray-900',\n      secondaryText: 'text-gray-600',\n      hover: 'hover:bg-gray-50',\n      button: 'bg-blue-600 hover:bg-blue-700 text-white',\n      cancelButton: 'bg-gray-200 hover:bg-gray-300 text-gray-900',\n    },\n    dark: {\n      background: 'bg-gray-800',\n      border: 'border-gray-700',\n      text: 'text-gray-100',\n      secondaryText: 'text-gray-400',\n      hover: 'hover:bg-gray-700',\n      button: 'bg-blue-600 hover:bg-blue-700 text-white',\n      cancelButton: 'bg-gray-700 hover:bg-gray-600 text-gray-100',\n    },\n  };\n\n  const classes = themeClasses[theme];\n\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50\">\n      <div className={`w-full max-w-2xl mx-4 rounded-lg border ${classes.background} ${classes.border}`}>\n        {/* 头部 */}\n        <div className=\"p-6 border-b border-gray-200 dark:border-gray-700\">\n          <div className=\"flex justify-between items-center mb-4\">\n            <h2 className={`text-xl font-semibold ${classes.text}`}>{title}</h2>\n            <div className=\"flex space-x-2\">\n              <button\n                onClick={() => setIsGridLayout(true)}\n                className={`p-2 rounded ${isGridLayout ? 'bg-blue-100 text-blue-600' : 'text-gray-400 hover:text-gray-600'}`}\n                title=\"网格视图\"\n              >\n                <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                  <path d=\"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z\" />\n                </svg>\n              </button>\n              <button\n                onClick={() => setIsGridLayout(false)}\n                className={`p-2 rounded ${!isGridLayout ? 'bg-blue-100 text-blue-600' : 'text-gray-400 hover:text-gray-600'}`}\n                title=\"列表视图\"\n              >\n                <svg className=\"w-5 h-5\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                  <path fillRule=\"evenodd\" d=\"M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z\" clipRule=\"evenodd\" />\n                </svg>\n              </button>\n            </div>\n          </div>\n          <p className={`${classes.secondaryText}`}>{description}</p>\n        </div>\n\n        {/* 钱包列表 */}\n        <div className=\"p-6 max-h-96 overflow-y-auto\">\n          {walletsLoading ? (\n            <div className={`text-center ${classes.secondaryText}`}>\n              <svg className=\"animate-spin h-8 w-8 mx-auto mb-2\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n                <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n              </svg>\n              检测钱包中...\n            </div>\n          ) : allWalletsForDisplay.length === 0 ? (\n            <div className={`text-center ${classes.secondaryText}`}>\n              没有找到已安装的钱包，请安装钱包扩展程序\n            </div>\n          ) : (\n            <div className={isGridLayout ? 'grid grid-cols-2 gap-4' : 'space-y-3'}>\n              {allWalletsForDisplay.map((wallet) => {\n                const iconSrc = typeof wallet.iconUrl === 'string'\n                  ? wallet.iconUrl\n                  : wallet.icon;\n                return (\n                  <button\n                    key={wallet.id}\n                    onClick={() => handleWalletSelect(wallet.id)}\n                    disabled={connectingWallet === wallet.id}\n                    className={`\n                      w-full p-5 rounded-lg border transition-all duration-200\n                      ${classes.border} ${classes.hover}\n                      ${connectingWallet === wallet.id ? 'opacity-50 cursor-not-allowed' : 'cursor-pointer'}\n                      flex flex-col items-center justify-center text-center min-h-[130px]\n                      hover:shadow-md\n                    `}\n                  >\n                    {iconSrc && (\n                      <div className=\"w-16 h-16 mb-3 flex items-center justify-center\">\n                        <img\n                          src={iconSrc}\n                          alt={wallet.name}\n                          className=\"w-full h-full object-contain\"\n                          onError={(e) => {\n                            e.currentTarget.style.display = 'none';\n                          }}\n                        />\n                      </div>\n                    )}\n                    <div className={`font-medium text-base ${classes.text} mb-1`}>{wallet.name}</div>\n                    <div className={`text-sm ${wallet.installed ? 'text-green-600' : classes.secondaryText}`}>\n                      {wallet.installed ? '已安装' : '未安装'}\n                    </div>\n                    {connectingWallet === wallet.id && (\n                      <div className=\"mt-3\">\n                        <svg className=\"animate-spin h-5 w-5 text-blue-600\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n                          <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                          <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                        </svg>\n                      </div>\n                    )}\n                  </button>\n                );\n              })}\n            </div>\n          )}\n        </div>\n\n        {/* 底部 */}\n        <div className=\"p-6 border-t border-gray-200 dark:border-gray-700 flex justify-end\">\n          <button\n            onClick={onClose}\n            className={`px-4 py-2 rounded-lg ${classes.cancelButton}`}\n          >\n            取消\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default WalletModal;","\"use client\";\n\nimport React from 'react';\nimport { useWallet } from './WalletProvider';\nimport { ConnectButtonProps } from '../types';\n\nconst ConnectButton: React.FC<ConnectButtonProps> = ({\n  label,\n  size = 'md',\n  variant = 'primary',\n  className = '',\n  showBalance = false,\n  showChain = false,\n  onConnect,\n  onDisconnect,\n}) => {\n  const {\n    isConnected,\n    isConnecting,\n    address,\n    balance,\n    chainId,\n    wallet,\n    connect,\n    disconnect,\n    openModal,\n    closeModal,\n    walletInstances,\n    detectedWallets,\n  } = useWallet();\n\n  const getButtonClasses = () => {\n    const baseClasses = 'font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors';\n\n    const variantClasses = {\n      primary: 'bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500',\n      secondary: 'bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-300',\n      outline: 'bg-transparent border border-blue-600 text-blue-600 hover:bg-blue-50 focus:ring-blue-500',\n      ghost: 'bg-transparent text-blue-600 hover:bg-blue-50 focus:ring-blue-500',\n    };\n\n    const sizeClasses = {\n      sm: 'py-1 px-3 text-sm',\n      md: 'py-2 px-4 text-base',\n      lg: 'py-3 px-6 text-lg',\n    };\n\n    return `${baseClasses} ${variantClasses[variant]} ${sizeClasses[size]} ${className}`;\n  };\n\n  const handleConnect = async () => {\n    try {\n      console.log(\"🔍 ConnectButton - 开始连接钱包\", {\n        isConnected,\n        isConnecting,\n        walletInstances,\n        detectedWallets\n      });\n\n      // 如果已经连接，直接断开连接\n      if (isConnected) {\n        console.log(\"🔍 ConnectButton - 钱包已连接，执行断开操作\");\n        await handleDisconnect();\n        return;\n      }\n\n      // 强制打开弹窗，让用户选择钱包\n      console.log(\"🔍 ConnectButton - 打开钱包弹窗\");\n      openModal();\n\n      console.log(\"🔍 ConnectButton - 已打开钱包弹窗\");\n    } catch (error) {\n      console.error('❌ 连接钱包失败:', error);\n    }\n  };\n\n  const handleDisconnect = async () => {\n    try {\n      await disconnect();\n\n      if (onDisconnect) {\n        onDisconnect();\n      }\n    } catch (error) {\n      console.error('❌ 断开连接失败:', error);\n    }\n  };\n\n  // 格式化地址显示\n  const formatAddress = (address: string | null) => {\n    if (!address) return '';\n    return `${address.slice(0, 6)}...${address.slice(-4)}`;\n  };\n\n  // 获取链名称\n  const getChainName = (chainId: number | null) => {\n    if (!chainId) return 'Unknown Chain';\n\n    const chainMap: Record<number, string> = {\n      1: 'Ethereum',\n      56: 'BSC',\n      137: 'Polygon',\n      43114: 'Avalanche',\n      42161: 'Arbitrum',\n      8453: 'Base',\n      11155111: 'Sepolia',\n    };\n\n    return chainMap[chainId] || `Chain ${chainId}`;\n  };\n\n  if (isConnecting) {\n    return (\n      <button className={getButtonClasses()} disabled>\n        <div className=\"flex items-center justify-center\">\n          <svg className=\"animate-spin -ml-1 mr-2 h-4 w-4 text-current\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n            <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n            <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n          </svg>\n          连接中...\n        </div>\n      </button>\n    );\n  }\n\n  if (!isConnected) {\n    return (\n      <button onClick={handleConnect} className={getButtonClasses()}>\n        {label || '连接钱包'}\n      </button>\n    );\n  }\n\n  return (\n    <div className=\"flex items-center gap-3\">\n      {showChain && chainId && (\n        <div className=\"text-sm text-gray-600 dark:text-gray-400\">\n          {getChainName(chainId)}\n        </div>\n      )}\n\n      <button onClick={handleDisconnect} className={getButtonClasses()}>\n        <div className=\"flex items-center\">\n          {wallet?.icon && (\n            <img\n              src={wallet.icon}\n              alt={wallet.name}\n              className=\"w-4 h-4 mr-2 rounded\"\n            />\n          )}\n          {formatAddress(address)}\n        </div>\n      </button>\n\n      {showBalance && (\n        <div className=\"text-sm text-gray-600 dark:text-gray-400\">\n          {parseFloat(balance).toFixed(4)} ETH\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default ConnectButton;","\"use client\";\n\nimport React, { useState } from 'react';\nimport { useWallet } from './WalletProvider';\n\ninterface AccountDropdownProps {\n  className?: string;\n  showBalance?: boolean;\n  showChainSwitcher?: boolean;\n  size?: 'sm' | 'md' | 'lg';\n  onDisconnect?: () => void;\n}\n\nconst AccountDropdown: React.FC<AccountDropdownProps> = ({\n  className = '',\n  showBalance = false,\n  showChainSwitcher = true,\n  size = 'md',\n  onDisconnect,\n}) => {\n  const {\n    address,\n    balance,\n    chainId,\n    isConnected,\n    disconnect,\n    switchChain,\n    fetchBalance,\n    balanceLoading,\n  } = useWallet();\n\n  const [isOpen, setIsOpen] = useState(false);\n  const [copied, setCopied] = useState(false);\n  const [switchingChain, setSwitchingChain] = useState<number | null>(null);\n\n  // 如果未连接，不显示组件\n  if (!isConnected || !address) {\n    return null;\n  }\n\n  // 尺寸样式\n  const sizeClasses = {\n    sm: 'h-8 px-3 text-sm',\n    md: 'h-10 px-4 text-base',\n    lg: 'h-12 px-6 text-lg',\n  };\n\n  // 格式化地址\n  const formatAddress = (addr: string) => {\n    return `${addr.slice(0, 6)}...${addr.slice(-4)}`;\n  };\n\n  // 格式化余额\n  const formatBalance = (bal: string) => {\n    const num = parseFloat(bal);\n    return num.toFixed(4);\n  };\n\n  // 获取链名称\n  const getChainName = (id: number | null) => {\n    const chainNames: Record<number, string> = {\n      31337: 'Localhost',\n      1: 'Ethereum',\n      11155111: 'Sepolia',\n      137: 'Polygon',\n      56: 'BSC',\n      42161: 'Arbitrum',\n      10: 'Optimism',\n    };\n    return id ? chainNames[id] || `Chain ${id}` : 'Unknown';\n  };\n\n  // 获取链图标\n  const getChainIcon = (id: number | null) => {\n    const chainColors: Record<number, string> = {\n      31337: 'bg-orange-500',\n      1: 'bg-blue-500',\n      11155111: 'bg-purple-500',\n      137: 'bg-purple-600',\n      56: 'bg-yellow-500',\n      42161: 'bg-blue-600',\n      10: 'bg-red-500',\n    };\n    return id ? chainColors[id] || 'bg-gray-500' : 'bg-gray-500';\n  };\n\n  // 复制地址\n  const copyAddress = async () => {\n    if (address && navigator.clipboard) {\n      try {\n        await navigator.clipboard.writeText(address);\n        setCopied(true);\n        setTimeout(() => setCopied(false), 2000);\n      } catch (error) {\n        console.error('复制地址失败:', error);\n      }\n    }\n  };\n\n  // 处理断开连接\n  const handleDisconnect = async () => {\n    try {\n      await disconnect();\n      setIsOpen(false);\n      if (onDisconnect) {\n        onDisconnect();\n      }\n    } catch (error) {\n      console.error('断开连接失败:', error);\n    }\n  };\n\n  // 处理切换链\n  const handleSwitchChain = async (newChainId: number) => {\n    if (newChainId === chainId) return;\n\n    try {\n      setSwitchingChain(newChainId);\n      await switchChain(newChainId);\n      setIsOpen(false);\n    } catch (error) {\n      console.error('切换链失败:', error);\n    } finally {\n      setSwitchingChain(null);\n    }\n  };\n\n  // 支持的链列表\n  const supportedChains = [\n    { id: 31337, name: 'Localhost (Hardhat)', shortName: 'Local' },\n    { id: 1, name: 'Ethereum', shortName: 'ETH' },\n    { id: 11155111, name: 'Sepolia Testnet', shortName: 'Sepolia' },\n    { id: 137, name: 'Polygon', shortName: 'MATIC' },\n    { id: 56, name: 'BNB Smart Chain', shortName: 'BSC' },\n    { id: 42161, name: 'Arbitrum One', shortName: 'ARB' },\n    { id: 10, name: 'Optimism', shortName: 'OP' },\n  ];\n\n  return (\n    <div className=\"relative\">\n      <button\n        onClick={() => setIsOpen(!isOpen)}\n        className={`\n          inline-flex items-center justify-center rounded-lg border border-gray-300\n          bg-white hover:bg-gray-50 text-gray-900 font-medium\n          transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\n          ${sizeClasses[size]} ${className}\n        `}\n      >\n        <div className=\"flex items-center space-x-2\">\n          {/* 连接状态指示器 */}\n          <div className={`w-2 h-2 rounded-full ${getChainIcon(chainId)}`}></div>\n\n          {/* 地址 */}\n          <span className=\"font-mono\">{formatAddress(address)}</span>\n\n          {/* 余额 */}\n          {showBalance && balance && (\n            <span className=\"text-sm text-gray-900 font-medium\">{formatBalance(balance)} ETH</span>\n          )}\n\n          {/* 下拉箭头 */}\n          <svg\n            className={`w-4 h-4 transition-transform text-gray-400 ${isOpen ? 'rotate-180' : ''}`}\n            fill=\"none\"\n            stroke=\"currentColor\"\n            viewBox=\"0 0 24 24\"\n          >\n            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M19 9l-7 7-7-7\" />\n          </svg>\n        </div>\n      </button>\n\n      {/* 下拉菜单 */}\n      {isOpen && (\n        <div className=\"absolute right-0 mt-2 w-72 bg-white rounded-lg shadow-lg border border-gray-200 z-50\">\n          {/* 账户信息头部 */}\n          <div className=\"p-4 border-b border-gray-100\">\n            <div className=\"flex items-center space-x-3 mb-3\">\n              <div className={`w-3 h-3 rounded-full ${getChainIcon(chainId)}`}></div>\n              <div className=\"flex-1\">\n                <div className=\"font-medium text-gray-900\">已连接</div>\n                <div className=\"text-sm text-gray-600\">{getChainName(chainId)}</div>\n              </div>\n            </div>\n\n            <div className=\"space-y-2\">\n              <div className=\"text-sm text-gray-600 font-mono break-all\">\n                {address}\n              </div>\n\n              {showBalance && balance && (\n                <div className=\"text-sm text-gray-600\">\n                  余额: {formatBalance(balance)} ETH\n                </div>\n              )}\n            </div>\n          </div>\n\n          <div className=\"p-2\">\n            {/* 复制地址 */}\n            <button\n              onClick={copyAddress}\n              className=\"w-full text-left px-3 py-2 text-sm text-gray-900 hover:bg-gray-50 rounded-md flex items-center space-x-3\"\n            >\n              <svg className=\"w-4 h-4 text-gray-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z\" />\n              </svg>\n              <span>{copied ? '已复制!' : '复制地址'}</span>\n              {copied && (\n                <svg className=\"w-4 h-4 text-green-500 ml-auto\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                  <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\n                </svg>\n              )}\n            </button>\n\n            {/* 刷新余额 */}\n            <button\n              onClick={() => {\n                fetchBalance();\n              }}\n              disabled={balanceLoading}\n              className=\"w-full text-left px-3 py-2 text-sm text-gray-900 hover:bg-gray-50 rounded-md flex items-center space-x-3\"\n            >\n              <svg className={`w-4 h-4 text-gray-400 ${balanceLoading ? 'animate-spin' : ''}`} fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\" />\n              </svg>\n              <span>{balanceLoading ? '刷新中...' : '刷新余额'}</span>\n            </button>\n\n            {/* 在浏览器中查看 */}\n            <button\n              onClick={() => {\n                const explorerUrls: Record<number, string> = {\n                  31337: 'http://127.0.0.1:8545',\n                  1: 'https://etherscan.io',\n                  11155111: 'https://sepolia.etherscan.io',\n                  137: 'https://polygonscan.com',\n                  56: 'https://bscscan.com',\n                  42161: 'https://arbiscan.io',\n                  10: 'https://optimistic.etherscan.io',\n                };\n                const explorerUrl = chainId ? explorerUrls[chainId] : null;\n                if (explorerUrl) {\n                  // 对于本地网络，提示用户无法在浏览器中查看\n                  if (chainId === 31337) {\n                    alert('本地网络不支持浏览器查看，请使用开发工具进行调试');\n                  } else {\n                    window.open(`${explorerUrl}/address/${address}`, '_blank');\n                  }\n                }\n              }}\n              className=\"w-full text-left px-3 py-2 text-sm text-gray-900 hover:bg-gray-50 rounded-md flex items-center space-x-3\"\n            >\n              <svg className=\"w-4 h-4 text-gray-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14\" />\n              </svg>\n              <span>在浏览器中查看</span>\n            </button>\n\n            {/* 切换网络 */}\n            {showChainSwitcher && (\n              <>\n                <div className=\"border-t border-gray-100 my-2\"></div>\n                <div className=\"px-3 py-1 text-xs text-gray-500 font-medium\">切换网络</div>\n\n                <div className=\"max-h-48 overflow-y-auto\">\n                  {supportedChains.map((chain) => (\n                    <button\n                      key={chain.id}\n                      onClick={() => handleSwitchChain(chain.id)}\n                      disabled={switchingChain === chain.id}\n                      className={`\n                        w-full text-left px-3 py-2 text-sm hover:bg-gray-50 rounded-md\n                        flex items-center justify-between transition-colors\n                        ${chainId === chain.id ? 'bg-blue-50 text-blue-600' : 'text-gray-900'}\n                        ${switchingChain === chain.id ? 'opacity-50 cursor-not-allowed' : ''}\n                      `}\n                    >\n                      <div className=\"flex items-center space-x-3\">\n                        <div className={`w-3 h-3 rounded-full ${getChainIcon(chain.id)}`}></div>\n                        <div>\n                          <div className=\"font-medium\">{chain.shortName}</div>\n                          <div className=\"text-xs text-gray-500\">{chain.name}</div>\n                        </div>\n                      </div>\n\n                      <div className=\"flex items-center\">\n                        {switchingChain === chain.id && (\n                          <svg className=\"animate-spin w-4 h-4 text-blue-600 mr-2\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n                            <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n                            <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n                          </svg>\n                        )}\n\n                        {chainId === chain.id && switchingChain !== chain.id && (\n                          <svg className=\"w-4 h-4 text-blue-600\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\n                            <path fillRule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clipRule=\"evenodd\" />\n                          </svg>\n                        )}\n                      </div>\n                    </button>\n                  ))}\n                </div>\n              </>\n            )}\n\n            {/* 断开连接 */}\n            <div className=\"border-t border-gray-100 my-2\"></div>\n            <button\n              onClick={handleDisconnect}\n              className=\"w-full text-left px-3 py-2 text-sm text-red-600 hover:bg-red-50 rounded-md flex items-center space-x-3\"\n            >\n              <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1\" />\n              </svg>\n              <span>断开连接</span>\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* 点击外部关闭下拉菜单 */}\n      {isOpen && (\n        <div\n          className=\"fixed inset-0 z-40\"\n          onClick={() => setIsOpen(false)}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default AccountDropdown;","\"use client\";\n\nimport React from 'react';\nimport { useWallet } from './WalletProvider';\nimport AccountDropdown from './AccountDropdown';\n\ninterface EnhancedConnectButtonProps {\n  label?: string;\n  size?: 'sm' | 'md' | 'lg';\n  variant?: 'primary' | 'secondary' | 'outline' | 'ghost';\n  className?: string;\n  showBalance?: boolean;\n  showChainSwitcher?: boolean;\n  onConnect?: (result: { success: boolean; error?: string }) => void;\n  onDisconnect?: () => void;\n}\n\nconst EnhancedConnectButton: React.FC<EnhancedConnectButtonProps> = ({\n  label = '连接钱包',\n  size = 'md',\n  variant = 'primary',\n  className = '',\n  showBalance = false,\n  showChainSwitcher = true,\n  onConnect,\n  onDisconnect,\n}) => {\n  const walletContext = useWallet();\n\n  console.log(\"🔍 EnhancedConnectButton - Wallet Context:\", {\n    isConnected: walletContext.isConnected,\n    isConnecting: walletContext.isConnecting,\n    address: walletContext.address,\n    hasOpenModal: typeof walletContext.openModal === 'function',\n    hasWalletInstances: !!walletContext.walletInstances,\n    error: walletContext.error\n  });\n\n  const {\n    isConnected,\n    isConnecting,\n    address,\n    error,\n    openModal,\n  } = walletContext;\n\n  // 尺寸样式\n  const sizeClasses = {\n    sm: 'px-3 py-1.5 text-sm',\n    md: 'px-4 py-2 text-base',\n    lg: 'px-6 py-3 text-lg',\n  };\n\n  // 变体样式\n  const variantClasses = {\n    primary: 'bg-blue-600 hover:bg-blue-700 text-white border-transparent',\n    secondary: 'bg-gray-600 hover:bg-gray-700 text-white border-transparent',\n    outline: 'bg-transparent hover:bg-gray-50 text-gray-900 border-gray-300',\n    ghost: 'bg-transparent hover:bg-gray-100 text-gray-700 border-transparent',\n  };\n\n  // 基础样式\n  const baseClasses = `\n    inline-flex items-center justify-center rounded-lg border font-medium\n    transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\n    disabled:opacity-50 disabled:cursor-not-allowed\n  `;\n\n  const buttonClasses = `${baseClasses} ${sizeClasses[size]} ${variantClasses[variant]} ${className}`;\n\n  // 处理连接\n  const handleConnect = async () => {\n    console.log(\"🔍 EnhancedConnectButton - handleConnect 被调用\", {\n      isConnected,\n      isConnecting\n    });\n\n    // 如果已经连接，直接断开连接\n    if (isConnected) {\n      console.log(\"🔍 EnhancedConnectButton - 钱包已连接，执行断开操作\");\n      if (onDisconnect) {\n        onDisconnect();\n      }\n      return;\n    }\n\n    if (!openModal) {\n      console.error(\"❌ openModal 函数不存在，可能没有在 WalletProvider 中使用\");\n      if (onConnect) {\n        onConnect({\n          success: false,\n          error: '钱包上下文未正确初始化，请确保组件被 WalletProvider 包裹'\n        });\n      }\n      return;\n    }\n\n    try {\n      console.log(\"🔍 EnhancedConnectButton - 调用 openModal()\");\n      openModal();\n\n      console.log(\"🔍 EnhancedConnectButton - openModal 调用成功\");\n\n      // 不要在这里调用 onConnect，应该在真正连接成功后才调用\n      // if (onConnect) {\n      //   onConnect({ success: true });\n      // }\n    } catch (error) {\n      console.error('❌ 连接失败:', error);\n      if (onConnect) {\n        onConnect({\n          success: false,\n          error: error instanceof Error ? error.message : '连接失败'\n        });\n      }\n    }\n  };\n\n  // 如果已连接，显示账户下拉菜单\n  if (isConnected && address) {\n    return (\n      <AccountDropdown\n        className={className}\n        showBalance={showBalance}\n        showChainSwitcher={showChainSwitcher}\n        size={size}\n        onDisconnect={onDisconnect}\n      />\n    );\n  }\n\n  // 未连接时显示连接按钮\n  return (\n    <div className=\"relative\">\n      <button\n        onClick={handleConnect}\n        disabled={isConnecting}\n        className={buttonClasses}\n      >\n        {isConnecting ? (\n          <>\n            <svg className=\"animate-spin -ml-1 mr-2 h-4 w-4 text-current\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n              <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n              <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n            </svg>\n            连接中...\n          </>\n        ) : (\n          label\n        )}\n      </button>\n\n      {error && (\n        <div className=\"absolute top-full left-0 mt-2 p-2 bg-red-50 text-red-600 text-sm rounded-md border border-red-200 whitespace-nowrap\">\n          {error.message}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default EnhancedConnectButton;","// 核心管理器\nexport { WalletManager } from './core/WalletManager';\nexport { WalletSDK } from './core/WalletSDK';\n\n// React 组件\nexport { WalletProvider, useWallet } from './components/WalletProvider';\nexport { default as ConnectButton } from './components/ConnectButton';\nexport { default as WalletModal } from './components/WalletModal';\nexport { default as AccountDropdown } from './components/AccountDropdown';\nexport { default as EnhancedConnectButton } from './components/EnhancedConnectButton';\n\n// 类型定义\nexport type * from './types';\n\n// 版本信息\nexport const version = '0.1.0';"],"mappings":"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","names":["import_jsx_runtime","import_jsx_runtime","import_jsx_runtime","announceEvent","_a","_a","_cleanup","_setup","config","_a","_a","_a","config","queryFnContext","context","_a","queryFnContext","_b","_a","config","_client","_retryer","getDefaultState","dispatch_fn","_a","config","_a","config","_a","config","_mutationCache","_defaultOptions","config","_a","import_react","import_jsx_runtime","import_jsx_runtime","config","chains","walletConfig","detectedWallets","_a","provider","import_jsx_runtime","address","chainId","import_react","import_jsx_runtime","import_jsx_runtime","error"]}